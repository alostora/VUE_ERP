src\latest\model\branch\routes\branch_routes.js

import BranchTable from "../parts/BranchTable.vue";
import BranchDetails from "../parts/details/BranchDetails.vue";
import BranchShow from "../parts/BranchShow.vue";
import WarehouseTable from "../../warehouse/parts/WarehouseTable.vue";
import EmployeeTable from "../../employee/parts/EmployeeTable.vue";

const branch_routes = [
     {
          path: "/company/:company_id/branches",
          name: "company-branches",
          component: BranchTable,
          props: true,
     },
     {
          path: "/company/:company_id/branches/:branch_id",
          name: "company-branch-show",
          redirect: { name: 'branch-details' },
          component: BranchShow,
          props: true,
          children: [
               {
                    path: "branch-details",
                    name: "branch-details",
                    component: BranchDetails,
                    props: true,
               },
               {
                    path: "warehouses",
                    name: "branch-warehouses",
                    component: WarehouseTable,
                    props: true,
               },
               {
                    path: "employees",
                    name: "branch-employees",
                    component: EmployeeTable,
                    props: true,
               },
          ]
     }
];

export default branch_routes;
__________________________________________________________________________
__________________________________________________________________________
src\latest\model\branch\parts\BranchTable.vue

<template>
  <div class="branch-table-page">
    <div class="mb-4 flex gap-2">
      <Button
        :label="$t('companies.viewCompany')"
        icon="pi pi-building"
        class="p-button-text"
        @click="goBackToCompany"
      />
      <Button
        :label="$t('branches.addBranch')"
        icon="pi pi-plus"
        @click="createBranch"
        class="p-button-primary"
      />
    </div>

    <div class="flex gap-2 mb-4">
      <div class="search-container">
        <InputText
          v-model="query_string"
          :placeholder="$t('branches.search')"
          @input="handleSearchInput"
          class="search-input w-20rem"
        />
        <i class="pi pi-search search-icon" />
      </div>

      <Select
        v-model="per_page"
        :options="perPageOptions"
        optionLabel="label"
        optionValue="value"
        :placeholder="$t('branches.show')"
        @change="getData(propSearchUrl)"
        class="w-10rem"
      />
    </div>

    <!-- Data Table -->
    <DataTable
      :value="tableItems"
      :paginator="true"
      :rows="per_page"
      :totalRecords="meta.total"
      :rowsPerPageOptions="[5, 10, 25, 50, 100]"
      :loading="loading"
      
      :lazy="true"
      resizableColumns
      columnResizeMode="fit"
      showGridlines
      tableStyle="min-width: 50rem"
      class="p-datatable-sm table-scroll-container"
      paginatorTemplate="FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown"
      currentPageReportTemplate="{first} to {last} of {totalRecords}"
      @page="handlePageChange"
    >
      <!-- ID Column -->
      <Column field="id" :header="$t('branches.id')" style="min-width: 80px">
        <template #body="slotProps">
          <span class="font-mono text-sm">{{ slotProps.index + 1 }}</span>
        </template>
      </Column>

      <!-- Name Column -->
      <Column
        field="name"
        :header="$t('branches.name')"
        sortable
        style="min-width: 150px"
      >
        <template #body="slotProps">
          <div>
            <div class="font-medium">{{ slotProps.data.name }}</div>
            <div class="text-sm text-color-secondary">
              {{ slotProps.data.name_ar }}
            </div>
          </div>
        </template>
      </Column>

      <!-- Phone Column -->
      <Column
        field="phone"
        :header="$t('branches.phone')"
        style="min-width: 130px"
      >
        <template #body="slotProps">
          <span>{{ slotProps.data.phone }}</span>
        </template>
      </Column>

      <!-- Address Column -->
      <Column
        field="address"
        :header="$t('branches.address')"
        style="min-width: 200px"
      >
        <template #body="slotProps">
          <div>
            <div class="text-sm mb-1">{{ slotProps.data.address }}</div>
            <div class="text-xs text-color-secondary">
              {{ slotProps.data.address_ar }}
            </div>
          </div>
        </template>
      </Column>

      <!-- Created At Column -->
      <Column
        field="created_at"
        :header="$t('branches.createdAt')"
        sortable
        style="min-width: 150px"
      >
        <template #body="slotProps">
          {{ formatDate(slotProps.data.created_at) }}
        </template>
      </Column>

      <!-- Actions Column -->
      <Column
        :header="$t('branches.actions')"
        :exportable="false"
        style="min-width: 150px"
      >
        <template #body="slotProps">
          <div class="flex gap-1">
            <Button
              icon="pi pi-pencil"
              class="p-button-text p-button-sm p-button-primary"
              @click="editBranchModal(slotProps.data)"
              v-tooltip.top="$t('branches.edit')"
            />
            <Button
              icon="pi pi-eye"
              class="p-button-text p-button-sm"
              @click="goToBranchShow(slotProps.data)"
              v-tooltip.top="$t('branches.show')"
            />
            <Button
              icon="pi pi-trash"
              class="p-button-text p-button-sm p-button-danger"
              @click="deleteRow(slotProps.data)"
              v-tooltip.top="$t('branches.delete')"
            />
          </div>
        </template>
      </Column>
    </DataTable>

    <!-- Empty State -->
    <div
      v-if="!loading && tableItems.length === 0"
      class="empty-state text-center py-6"
    >
      <i class="pi pi-map-marker text-6xl text-color-secondary mb-3"></i>
      <h3 class="text-color-secondary">
        {{ $t("branches.noBranches") }}
      </h3>
      <p class="text-color-secondary">
        {{ $t("branches.createFirstBranch") }}
      </p>
      <Button
        :label="$t('branches.addBranch')"
        icon="pi pi-plus"
        @click="createBranch"
        class="p-button-primary mt-3"
      />
    </div>

    <!-- Create Branch Modal -->
    <BranchCreateModal
      ref="branchCreateModal"
      :company_id="effectiveCompanyId"
      @branch-created="handleBranchCreated"
    />

    <!-- Edit Branch Modal -->
    <BranchEditModal
      ref="branchEditModal"
      :branch="selectedItem"
      :company_id="effectiveCompanyId"
      @branch-updated="handleBranchUpdated"
    />

    <Toast />
    <ConfirmDialog />
  </div>
</template>

<script>
import DataTable from "primevue/datatable";
import Column from "primevue/column";
import InputText from "primevue/inputtext";
import Button from "primevue/button";
import Select from "primevue/select";
import Toast from "primevue/toast";
import ConfirmDialog from "primevue/confirmdialog";
import Tooltip from "primevue/tooltip";

import BranchCreateModal from "./BranchCreateModal.vue";
import BranchEditModal from "./BranchEditModal.vue";

import { useTable } from "../../../views/layouts/constants/composables/useTable";
import { useCrud } from "../../../views/layouts/constants/composables/useCrud";
import general_request from "../../../views/layouts/constants/general_request";

export default {
  name: "BranchTable",

  components: {
    BranchCreateModal,
    BranchEditModal,
    DataTable,
    Column,
    InputText,
    Button,
    Select,
    Toast,
    ConfirmDialog,
  },

  directives: {
    tooltip: Tooltip,
  },

  props: {
    company_id: {
      type: String,
      default: null,
    },
  },

  mixins: [useTable(), useCrud()],

  computed: {
    effectiveCompanyId() {
      const companyId = this.company_id || this.$route?.params?.company_id;
      return companyId;
    },

    propSearchUrl() {
      if (!this.effectiveCompanyId) {
        console.warn("⚠️ Company ID is undefined, cannot build search URL");
        return "";
      }
      const url = `${general_request.BASE_URL}/admin/company/branches/search/${this.effectiveCompanyId}?paginate=true`;
      return url;
    },

    propMainUrl() {
      return `${general_request.BASE_URL}/admin/company/branch`;
    },
  },

  mounted() {
    if (this.effectiveCompanyId) {
      this.getData();
    } else {
      console.warn("⚠️ No company ID found on mount");
    }
  },

  watch: {
    "$route.params.company_id": {
      immediate: true,
      handler(newCompanyId) {
        if (newCompanyId) {
          this.getData();
        }
      },
    },
  },

  methods: {
    /**
     * Open create branch modal
     */
    createBranch() {
      if (!this.effectiveCompanyId) {
        this.showToast("error", "Error", "Company ID is missing");
        return;
      }
      this.$refs.branchCreateModal.openModal();
    },

    /**
     * Handle branch created event
     */
    handleBranchCreated(newBranch) {
      this.handleItemCreated(newBranch);
    },

    /**
     * Open edit branch modal
     */
    editBranchModal(branch) {
      this.selectedItem = { ...branch };
      this.$nextTick(() => {
        this.$refs.branchEditModal.openModal();
      });
    },

    /**
     * Handle branch updated event
     */
    handleBranchUpdated(updatedBranch) {
      this.handleItemUpdated(updatedBranch);
    },

    /**
     * Delete branch
     */
    deleteRow(branch) {
      this.deleteItem(
        branch,
        this.propMainUrl,
        this.$t("branches.branchDeleted"),
        this.$t("branches.deleteError")
      );
    },

    /**
     * Navigate to branch show page
     */
    goToBranchShow(branch) {
      const companyId = this.effectiveCompanyId;
      const branchId = branch?.id;
      if (!companyId || !branchId) {
        this.showToast(
          "error",
          this.$t("common.error") || "Error",
          this.$t("branches.missingIds") || "Missing company or branch ID"
        );
        return;
      }
      this.$router.push(`/company/${companyId}/branches/${branchId}`);
    },

    /**
     * Show toast notification
     */
    showToast(severity, summary, detail) {
      if (this.$toast) {
        this.$toast.add({
          severity: severity,
          summary: summary,
          detail: detail,
          life: 3000,
        });
      }
    },
    goBackToCompany() {
      const companyId = this.effectiveCompanyId;
      if (!companyId) {
        if (this.$toast) {
          this.$toast.add({
            severity: "warn",
            summary: this.$t("common.error") || "Error",
            detail: this.$t("branches.missingIds") || "Missing company ID",
            life: 3000,
          });
        }
        return;
      }
      // Try navigating via named child route to avoid redirects
      try {
        console.debug("Navigating to company-details for company", companyId);
        this.$router.push({
          name: "company-details",
          params: { company_id: companyId },
        });
      } catch (e) {
        console.warn("Named route navigation failed, falling back to path", e);
        this.$router.push(`/company/${companyId}/show`);
      }
    },
  },
};
</script>

<style scoped>
.branch-table-page {
  padding: 1rem;
}

.search-container {
  position: relative;
  display: inline-block;
}

.search-input {
  padding-left: 2.5rem;
  width: 20rem;
}

.search-icon {
  position: absolute;
  left: 0.75rem;
  top: 50%;
  transform: translateY(-50%);
  color: var(--text-color-secondary);
  pointer-events: none;
}

.empty-state {
  border: 2px dashed var(--surface-border);
  border-radius: 12px;
  background: var(--surface-ground);
  margin: 2rem 0;
}

:deep(.p-datatable) {
  width: 100%;
}

:deep(.p-column-title) {
  font-weight: 600;
}
</style>

__________________________________________________________________________
__________________________________________________________________________
src\latest\model\branch\parts\BranchShow.vue

<template>
  <div class="branch-show-wrapper" :class="layoutClasses">
    <div class="branch-layout-container">
      <!-- Branch Header -->
      <BranchHeader
        :branch="branch"
        :current-page="$route.name"
        @toggle-sidebar="toggleSidebar"
        @go-back="goBackToBranches"
        @edit-branch="editBranch"
      />

      <!-- Branch Sidebar -->
      <BranchSidebar
        :branch="branch"
        :collapsed="sidebarCollapsed"
        :position="currentDirection"
        :isMobile="isMobile"
        @toggle="toggleSidebar"
      />

      <!-- Mobile Overlay -->
      <div
        v-if="isMobile && !sidebarCollapsed"
        class="branch-sidebar-overlay"
        @click="toggleSidebar"
      ></div>
      <!-- Main Content -->

      <main
        class="branch-main-content"
        :class="{ 'sidebar-collapsed': sidebarCollapsed }"
      >
        
        <div class="branch-show-page">
          <!-- Nested routes if needed -->
          <RouterView :branch="branch" :branch_id="branch_id" />
        </div>
      </main>
    </div>

    <PosModal ref="posModal" :company-id="companyId" :branch-id="branchId" />
    <Toast />
  </div>
</template>

<script>
import { RouterView } from "vue-router";
import general_request from "../../../views/layouts/constants/general_request";

import BranchHeader from "../layouts/BranchHeader.vue";
import BranchSidebar from "../layouts/BranchSidebar.vue";
import BranchEditModal from "./BranchEditModal.vue";
import PosModal from "./pos/PosModal.vue";

export default {
  name: "BranchShow",
  components: {
    RouterView,
    BranchHeader,
    BranchSidebar,
    BranchEditModal,
    PosModal,
  },
  props: {
    branch_id: {
      type: String,
      required: false, // will fallback to route param
    },
    company_id: {
      type: String,
      required: false,
    },
  },
  data() {
    return {
      branch: {},
      company: {},
      loading: false,
      error: "",
      sidebarCollapsed: false,
      isMobile: false,
      currentLanguage: localStorage.getItem("language") || "en",
      hasPosAccess: true, // Set to true to always show, false to hide
    };
  },
  computed: {
    companyId() {
      return this.$route.params.company_id;
    },
    branchId() {
      return this.$route.params.branch_id;
    },
    currentDirection() {
      return this.currentLanguage === "ar" ? "rtl" : "ltr";
    },
    layoutClasses() {
      return {
        "branch-ltr": this.currentDirection === "ltr",
        "branch-rtl": this.currentDirection === "rtl",
        "mobile-view": this.isMobile,
      };
    },
  },
  mounted() {
    this.fetchBranch();
    this.checkMobile();
    this.setupLanguageListener();
    window.addEventListener("resize", this.checkMobile);
  },
  beforeUnmount() {
    window.removeEventListener("resize", this.checkMobile);
    if (this.languageUnwatch) {
      this.languageUnwatch();
    }
  },
  methods: {
    async fetchBranch() {
      this.loading = true;
      this.error = "";

      try {
        const branchId = this.branch_id || this.$route.params.branch_id;
        if (!branchId) {
          throw new Error("Branch ID is missing");
        }

        const url = `${general_request.BASE_URL}/admin/company/branch/${branchId}`;
        const response = await this.$http.get(url, {
          headers: general_request.headers,
        });

        if (response.data && response.data.data) {
          this.branch = response.data.data;
          this.company = response.data.data.company || {};
        } else {
          throw new Error("Invalid response format");
        }
      } catch (error) {
        console.error("Error fetching branch:", error);
        this.error =
          error.response?.data?.message ||
          error.message ||
          this.$t("errors.failedToLoadBranch") ||
          "Failed to load branch";
      } finally {
        this.loading = false;
      }
    },

    cleanFilePath(path) {
      if (!path) return "";
      try {
        // Some API values include backticks/spaces; strip them
        return String(path)
          .replace(/[`'\"]/g, "")
          .trim();
      } catch (e) {
        return path;
      }
    },

    formatDate(value) {
      if (!value) return "-";
      try {
        const d = new Date(value);
        return d.toLocaleString();
      } catch (e) {
        return value;
      }
    },

    toggleSidebar() {
      this.sidebarCollapsed = !this.sidebarCollapsed;
    },

    goBackToBranches() {
      const companyId = this.company_id || this.$route.params.company_id;
      if (companyId) {
        this.$router.push(`/company/${companyId}/branches`);
      } else {
        this.$router.push(`/company/branches`);
      }
    },

    editBranch() {
      this.$refs.branchEditModal &&
        this.$refs.branchEditModal.openModal &&
        this.$refs.branchEditModal.openModal();
    },

    handleBranchUpdated(updatedBranch) {
      this.branch = { ...this.branch, ...updatedBranch };
      this.showToast(
        "success",
        this.$t("common.success") || "Success",
        this.$t("branches.branchUpdated") || "Branch updated"
      );
      this.fetchBranch();
    },

    checkMobile() {
      this.isMobile = window.innerWidth <= 768;
      if (this.isMobile) {
        this.sidebarCollapsed = true;
      }
    },

    setupLanguageListener() {
      this.languageUnwatch = this.$watch("$i18n.locale", (newLocale) => {
        this.currentLanguage = newLocale;
      });
    },

    showToast(severity, summary, detail) {
      if (this.$toast) {
        this.$toast.add({ severity, summary, detail, life: 3000 });
      }
    },

    openPosModal() {
      if (this.$refs.posModal) {
        this.$refs.posModal.openModal();
      }
    },
  },
};
</script>

<style scoped>
.branch-show-wrapper {
  min-height: 100vh;
  background: var(--surface-ground);
  position: relative;
}

.branch-layout-container {
  position: relative;
  min-height: 100vh;
  width: 100%;
  overflow: hidden;
}

.branch-main-content {
  min-height: calc(100vh - 70px);
  margin-left: 280px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  padding: 0;
  background: var(--surface-ground);
  margin-top: 70px;
  position: relative;
  z-index: 1;
}

.branch-main-content.sidebar-collapsed {
  margin-left: 70px;
}

.branch-rtl .branch-main-content {
  margin-left: 0;
  margin-right: 280px;
}

.branch-rtl .branch-main-content.sidebar-collapsed {
  margin-right: 70px;
}

.branch-show-page {
  width: 100%;
  margin: 0 auto;
  padding: 1rem;
  transition: all 0.3s ease;
}

.branch-sidebar-overlay {
  position: absolute;
  top: 70px;
  left: 0;
  width: 100%;
  height: calc(100vh - 70px);
  background: rgba(0, 0, 0, 0.5);
  z-index: 699;
  backdrop-filter: blur(2px);
}

.error-state {
  text-align: center;
  padding: 2rem;
}

.branch-content {
  animation: fadeIn 0.3s ease;
}

/* Company Hero styles */
.company-hero {
  position: relative;
  height: 180px;
  border-radius: 8px;
  overflow: hidden;
  margin-bottom: 1rem;
}

.company-hero-bg {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  filter: brightness(0.85);
}

.company-hero-overlay {
  position: absolute;
  inset: 0;
  background: linear-gradient(0deg, rgba(0, 0, 0, 0.35), rgba(0, 0, 0, 0.15));
}

.company-hero-content {
  position: relative;
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  z-index: 2;
}

.company-logo {
  width: 64px;
  height: 64px;
  object-fit: cover;
  border-radius: 50%;
  border: 2px solid rgba(255, 255, 255, 0.7);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.company-titles .company-name {
  color: #fff;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.company-info-grid {
  background: var(--surface-card);
  border-radius: 8px;
  padding: 1rem;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@media (max-width: 768px) {
  .branch-layout-container {
    overflow: visible;
  }

  .branch-main-content {
    margin-left: 0 !important;
    margin-right: 0 !important;
    width: 100%;
    margin-top: 70px;
  }

  .branch-sidebar-overlay {
    top: 70px;
    z-index: 899;
  }
}
</style>

____________________________________________________________________________________________________________
____________________________________________________________________________________________________________

src\latest\model\branch\parts\BranchEditModal.vue

<template>
  <Dialog
    :header="$t('branches.editBranch')"
    v-model:visible="visible"
    :modal="true"
    :style="{ width: '60vw' }"
    :breakpoints="{ '960px': '75vw', '641px': '90vw' }"
  >
    <BranchEditForm
      :branch="branch"
      :company_id="effectiveCompanyId"
      @branch-updated="handleBranchUpdated"
      @cancel="closeModal"
    />

    <div v-if="loading" class="loading-overlay">
      <ProgressSpinner />
    </div>
  </Dialog>
</template>

<script>
import Dialog from "primevue/dialog";
import ProgressSpinner from "primevue/progressspinner";
import BranchEditForm from "./BranchEditForm.vue";

export default {
  name: "BranchEditModal",
  components: {
    Dialog,
    ProgressSpinner,
    BranchEditForm,
  },
  props: {
    branch: {
      type: Object,
      default: () => ({}),
    },
    company_id: {
      type: String,
      default: null,
    },
  },
  computed: {
    effectiveCompanyId() {
      return this.company_id || this.$route.params.company_id;
    },
  },
  data() {
    return {
      visible: false,
      loading: false,
    };
  },
  methods: {
    openModal() {
      this.visible = true;
    },
    closeModal() {
      this.visible = false;
      this.loading = false;
      this.$emit("modal-closed");
    },
    handleBranchUpdated(updatedBranch) {
      this.$emit("branch-updated", updatedBranch);
      this.closeModal();
    },
    setLoading(state) {
      this.loading = state;
    },
  },
};
</script>

<style scoped>
.loading-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255, 255, 255, 0.8);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}
</style>

________________________________________________________________________________________
________________________________________________________________________________________
src\latest\model\branch\parts\BranchEditForm.vue

<template>
  <div class="branch-edit-form">
    <Message v-if="error" severity="error" class="mb-3">
      {{ error }}
    </Message>

    <form @submit.prevent="submitForm">
      <!-- Basic Information -->
      <div class="grid">
        <!-- Name -->
        <div class="col-12 md:col-6 field">
          <label for="name" class="font-bold block mb-2">
            {{ $t("branches.name") }} *
          </label>
          <InputText
            id="name"
            v-model="formData.name"
            :class="{ 'p-invalid': errors.name }"
            class="w-full"
            :placeholder="$t('branches.namePlaceholder')"
          />
          <small v-if="errors.name" class="p-error">{{ errors.name }}</small>
        </div>

        <!-- Arabic Name -->
        <div class="col-12 md:col-6 field">
          <label for="name_ar" class="font-bold block mb-2">
            {{ $t("branches.name_ar") }} *
          </label>
          <InputText
            id="name_ar"
            v-model="formData.name_ar"
            :class="{ 'p-invalid': errors.name_ar }"
            class="w-full"
            :placeholder="$t('branches.nameArPlaceholder')"
          />
          <small v-if="errors.name_ar" class="p-error">{{
            errors.name_ar
          }}</small>
        </div>
      </div>

      <!-- Phone -->
      <div class="field mb-3">
        <label for="phone" class="font-bold block mb-2">
          {{ $t("branches.phone") }} *
        </label>
        <InputText
          id="phone"
          v-model="formData.phone"
          :class="{ 'p-invalid': errors.phone }"
          class="w-full"
          :placeholder="$t('branches.phonePlaceholder')"
        />
        <small v-if="errors.phone" class="p-error">{{ errors.phone }}</small>
      </div>

      <!-- Address -->
      <div class="grid">
        <div class="col-12 md:col-6 field">
          <label for="address" class="font-bold block mb-2">
            {{ $t("branches.address") }} *
          </label>
          <Textarea
            id="address"
            v-model="formData.address"
            rows="3"
            :class="{ 'p-invalid': errors.address }"
            class="w-full"
            :placeholder="$t('branches.addressPlaceholder')"
          />
          <small v-if="errors.address" class="p-error">{{
            errors.address
          }}</small>
        </div>

        <div class="col-12 md:col-6 field">
          <label for="address_ar" class="font-bold block mb-2">
            {{ $t("branches.address_ar") }} *
          </label>
          <Textarea
            id="address_ar"
            v-model="formData.address_ar"
            rows="3"
            :class="{ 'p-invalid': errors.address_ar }"
            class="w-full"
            :placeholder="$t('branches.addressArPlaceholder')"
          />
          <small v-if="errors.address_ar" class="p-error">{{
            errors.address_ar
          }}</small>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex justify-content-end gap-2 mt-4">
        <Button
          type="button"
          :label="$t('common.cancel')"
          @click="$emit('cancel')"
          class="p-button-text"
          :disabled="loading"
        />
        <Button
          type="submit"
          :label="$t('common.update')"
          :loading="loading"
          class="p-button-primary"
        />
      </div>
    </form>
  </div>
</template>

<script>
import InputText from "primevue/inputtext";
import Textarea from "primevue/textarea";
import Button from "primevue/button";
import Message from "primevue/message";
import general_request from "../../../views/layouts/constants/general_request";

export default {
  name: "BranchEditForm",
  components: {
    InputText,
    Textarea,
    Button,
    Message,
  },
  props: {
    branch: {
      type: Object,
      default: () => ({}),
    },
    company_id: {
      type: String,
      default: null,
    },
  },
  computed: {
    effectiveCompanyId() {
      return this.company_id || this.$route.params.company_id;
    },
  },
  data() {
    return {
      loading: false,
      error: "",
      formData: {
        id: "",
        name: "",
        name_ar: "",
        phone: "",
        address: "",
        address_ar: "",
      },
      errors: {},
    };
  },
  watch: {
    branch: {
      immediate: true,
      deep: true,
      handler(newBranch) {
        if (newBranch && newBranch.id) {
          this.populateForm(newBranch);
        } else {
          this.resetForm();
        }
      },
    },
  },
  methods: {
    populateForm(branch) {
      this.formData = {
        id: branch.id || "",
        name: branch.name || "",
        name_ar: branch.name_ar || "",
        phone: branch.phone || "",
        address: branch.address || "",
        address_ar: branch.address_ar || "",
      };
    },
    resetForm() {
      this.formData = {
        id: "",
        name: "",
        name_ar: "",
        phone: "",
        address: "",
        address_ar: "",
      };
      this.errors = {};
      this.error = "";
    },
    validateForm() {
      this.errors = {};

      if (!this.formData.name?.trim()) {
        this.errors.name = this.$t("branches.nameRequired");
      }

      if (!this.formData.name_ar?.trim()) {
        this.errors.name_ar = this.$t("branches.nameArRequired");
      }

      if (!this.formData.phone?.trim()) {
        this.errors.phone = this.$t("branches.phoneRequired");
      }

      if (!this.formData.address?.trim()) {
        this.errors.address = this.$t("branches.addressRequired");
      }

      if (!this.formData.address_ar?.trim()) {
        this.errors.address_ar = this.$t("branches.addressRequired");
      }

      return Object.keys(this.errors).length === 0;
    },
    async submitForm() {
      if (!this.validateForm()) {
        return;
      }

      this.loading = true;
      this.error = "";

      try {
        const payload = {
          name: this.formData.name,
          name_ar: this.formData.name_ar,
          phone: this.formData.phone,
          address: this.formData.address,
          address_ar: this.formData.address_ar,
        };

        const url = `${general_request.BASE_URL}/admin/company/branch/${this.formData.id}`;
        const response = await this.$http.patch(url, payload, {
          headers: general_request.headers,
        });

        this.$emit("branch-updated", response.data.data);

        this.showToast(
          "success",
          this.$t("branches.success"),
          this.$t("branches.branchUpdated")
        );
      } catch (error) {
        this.handleSaveError(error);
      } finally {
        this.loading = false;
      }
    },
    handleSaveError(error) {
      this.errors = {};
      this.error = "";

      if (error.response?.data) {
        const responseData = error.response.data;
        if (responseData.status_code === 400) {
          this.handleBadRequestError(responseData);
        } else if (responseData.status_code === 422) {
          this.handleValidationError(responseData);
        } else {
          this.handleGenericError(responseData);
        }
      } else {
        this.handleNetworkError(error);
      }
    },
    handleBadRequestError(responseData) {
      if (responseData.errors) {
        if (Array.isArray(responseData.errors)) {
          this.error = responseData.errors.join(", ");
        } else if (
          responseData.errors.errors &&
          Array.isArray(responseData.errors.errors)
        ) {
          this.error = responseData.errors.errors.join(", ");
          this.mapCommonErrorsToFields(responseData.errors.errors);
        }
      }
      if (!this.error && responseData.message) {
        this.error = responseData.message;
      }
    },
    handleValidationError(responseData) {
      if (responseData.errors && typeof responseData.errors === "object") {
        this.errors = this.formatFieldErrors(responseData.errors);
        const firstError = Object.values(this.errors)[0];
        if (firstError) {
          this.error = firstError;
        }
      } else if (responseData.message) {
        this.error = responseData.message;
      }
    },
    handleGenericError(responseData) {
      this.error = responseData.message || this.$t("branches.updateError");
    },
    handleNetworkError(error) {
      this.error = error.message || this.$t("branches.networkError");
    },
    mapCommonErrorsToFields(errorMessages) {
      errorMessages.forEach((message) => {
        if (message.includes("name")) {
          this.errors.name = message;
        } else if (message.includes("name_ar")) {
          this.errors.name_ar = message;
        } else if (message.includes("phone")) {
          this.errors.phone = message;
        } else if (message.includes("address")) {
          this.errors.address = message;
        }
      });
    },
    formatFieldErrors(errorsObject) {
      const formattedErrors = {};
      Object.keys(errorsObject).forEach((field) => {
        const fieldErrors = errorsObject[field];
        if (Array.isArray(fieldErrors)) {
          formattedErrors[field] = fieldErrors[0];
        } else if (typeof fieldErrors === "string") {
          formattedErrors[field] = fieldErrors;
        }
      });
      return formattedErrors;
    },
    showToast(severity, summary, detail) {
      if (this.$toast) {
        this.$toast.add({
          severity: severity,
          summary: summary,
          detail: detail,
          life: 3000,
        });
      }
    },
  },
};
</script>

<style scoped>
.branch-edit-form {
  max-width: 100%;
}
.field {
  margin-bottom: 1.5rem;
}
</style>

___________________________________________________________________________________________
___________________________________________________________________________________________
src\latest\model\branch\parts\BranchCreateModal.vue

<template>
  <Dialog
    :header="$t('branches.createBranch')"
    v-model:visible="visible"
    :modal="true"
    :style="{ width: '60vw' }"
    :breakpoints="{ '960px': '75vw', '641px': '90vw' }"
    @hide="closeModal"
  >
    <BranchCreateForm
      :company_id="effectiveCompanyId"
      @branch-created="handleBranchCreated"
      @cancel="closeModal"
    />

    <div v-if="loading" class="loading-overlay">
      <ProgressSpinner />
      <p class="mt-2">{{ $t('branches.creatingBranch') }}</p>
    </div>
  </Dialog>
</template>

<script>
import Dialog from "primevue/dialog";
import ProgressSpinner from "primevue/progressspinner";
import BranchCreateForm from "./BranchCreateForm.vue";

export default {
  name: "BranchCreateModal",
  components: {
    Dialog,
    ProgressSpinner,
    BranchCreateForm,
  },
  props: {
    company_id: {
      type: String,
      default: null,
    },
  },
  computed: {
    effectiveCompanyId() {
      return this.company_id || this.$route.params.company_id;
    },
  },
  data() {
    return {
      visible: false,
      loading: false,
    };
  },
  methods: {
    openModal() {
      this.visible = true;
    },
    closeModal() {
      this.visible = false;
      this.loading = false;
    },
    handleBranchCreated(newBranch) {
      this.$emit("branch-created", newBranch);
      this.closeModal();
    },
    setLoading(state) {
      this.loading = state;
    },
  },
};
</script>

<style scoped>
.loading-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255, 255, 255, 0.8);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}
</style>

____________________________________________________________________________________________________________
____________________________________________________________________________________________________________
src\latest\model\branch\parts\BranchCreateForm.vue

<template>
  <div class="branch-create-form">
    <Message v-if="error" severity="error" class="mb-3">
      {{ error }}
    </Message>

    <form @submit.prevent="submitForm">
      <!-- Basic Information -->
      <div class="grid">
        <!-- Name -->
        <div class="col-12 md:col-6 field">
          <label for="name" class="font-bold block mb-2">
            {{ $t("branches.name") }} *
          </label>
          <InputText
            id="name"
            v-model="formData.name"
            :class="{ 'p-invalid': errors.name }"
            class="w-full"
            :placeholder="$t('branches.namePlaceholder')"
          />
          <small v-if="errors.name" class="p-error">{{ errors.name }}</small>
        </div>

        <!-- Arabic Name -->
        <div class="col-12 md:col-6 field">
          <label for="name_ar" class="font-bold block mb-2">
            {{ $t("branches.name_ar") }} *
          </label>
          <InputText
            id="name_ar"
            v-model="formData.name_ar"
            :class="{ 'p-invalid': errors.name_ar }"
            class="w-full"
            :placeholder="$t('branches.nameArPlaceholder')"
          />
          <small v-if="errors.name_ar" class="p-error">{{
            errors.name_ar
          }}</small>
        </div>
      </div>

      <!-- Phone -->
      <div class="field mb-3">
        <label for="phone" class="font-bold block mb-2">
          {{ $t("branches.phone") }} *
        </label>
        <InputText
          id="phone"
          v-model="formData.phone"
          :class="{ 'p-invalid': errors.phone }"
          class="w-full"
          :placeholder="$t('branches.phonePlaceholder')"
        />
        <small v-if="errors.phone" class="p-error">{{ errors.phone }}</small>
      </div>

      <!-- Address -->
      <div class="grid">
        <div class="col-12 md:col-6 field">
          <label for="address" class="font-bold block mb-2">
            {{ $t("branches.address") }} *
          </label>
          <Textarea
            id="address"
            v-model="formData.address"
            rows="3"
            :class="{ 'p-invalid': errors.address }"
            class="w-full"
            :placeholder="$t('branches.addressPlaceholder')"
          />
          <small v-if="errors.address" class="p-error">{{
            errors.address
          }}</small>
        </div>

        <div class="col-12 md:col-6 field">
          <label for="address_ar" class="font-bold block mb-2">
            {{ $t("branches.address_ar") }} *
          </label>
          <Textarea
            id="address_ar"
            v-model="formData.address_ar"
            rows="3"
            :class="{ 'p-invalid': errors.address_ar }"
            class="w-full"
            :placeholder="$t('branches.addressArPlaceholder')"
          />
          <small v-if="errors.address_ar" class="p-error">{{
            errors.address_ar
          }}</small>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="flex justify-content-end gap-2 mt-4">
        <Button
          type="button"
          :label="$t('common.cancel')"
          @click="$emit('cancel')"
          class="p-button-text"
          :disabled="loading"
        />
        <Button
          type="submit"
          :label="$t('common.create')"
          :loading="loading"
          class="p-button-primary"
        />
      </div>
    </form>
  </div>
</template>

<script>
import InputText from "primevue/inputtext";
import Textarea from "primevue/textarea";
import Button from "primevue/button";
import Message from "primevue/message";
import general_request from "../../../views/layouts/constants/general_request";

export default {
  name: "BranchCreateForm",
  components: {
    InputText,
    Textarea,
    Button,
    Message,
  },
  props: {
    company_id: {
      type: String,
      default: null,
    },
  },
  data() {
    return {
      loading: false,
      error: "",
      formData: {
        company_id: "",
        name: "",
        name_ar: "",
        phone: "",
        address: "",
        address_ar: "",
      },
      errors: {},
    };
  },
  computed: {
    effectiveCompanyId() {
      return this.company_id || this.$route.params.company_id;
    },
  },
  methods: {
    resetForm() {
      this.formData = {
        company_id: this.effectiveCompanyId,
        name: "",
        name_ar: "",
        phone: "",
        address: "",
        address_ar: "",
      };
      this.errors = {};
      this.error = "";
    },
    validateForm() {
      this.errors = {};

      if (!this.formData.name?.trim()) {
        this.errors.name = this.$t("branches.nameRequired");
      }

      if (!this.formData.name_ar?.trim()) {
        this.errors.name_ar = this.$t("branches.nameArRequired");
      }

      if (!this.formData.phone?.trim()) {
        this.errors.phone = this.$t("branches.phoneRequired");
      }

      if (!this.formData.address?.trim()) {
        this.errors.address = this.$t("branches.addressRequired");
      }

      if (!this.formData.address_ar?.trim()) {
        this.errors.address_ar = this.$t("branches.addressRequired");
      }

      return Object.keys(this.errors).length === 0;
    },
    async submitForm() {
      if (!this.validateForm()) {
        return;
      }

      this.loading = true;
      this.error = "";

      try {
        const payload = {
          company_id: this.effectiveCompanyId,
          name: this.formData.name,
          name_ar: this.formData.name_ar,
          phone: this.formData.phone,
          address: this.formData.address,
          address_ar: this.formData.address_ar,
        };

        const url = `${general_request.BASE_URL}/admin/company/branch`;
        const response = await this.$http.post(url, payload, {
          headers: general_request.headers,
        });

        this.resetForm();
        this.$emit("branch-created", response.data.data);

        this.showToast(
          "success",
          this.$t("branches.success"),
          this.$t("branches.branchCreated")
        );
      } catch (error) {
        this.handleSaveError(error);
      } finally {
        this.loading = false;
      }
    },
    handleSaveError(error) {
      this.errors = {};
      this.error = "";

      if (error.response?.data) {
        const responseData = error.response.data;
        if (responseData.status_code === 400) {
          this.handleBadRequestError(responseData);
        } else if (responseData.status_code === 422) {
          this.handleValidationError(responseData);
        } else {
          this.handleGenericError(responseData);
        }
      } else {
        this.handleNetworkError(error);
      }
    },
    handleBadRequestError(responseData) {
      if (responseData.errors) {
        if (Array.isArray(responseData.errors)) {
          this.error = responseData.errors.join(", ");
        } else if (
          responseData.errors.errors &&
          Array.isArray(responseData.errors.errors)
        ) {
          this.error = responseData.errors.errors.join(", ");
          this.mapCommonErrorsToFields(responseData.errors.errors);
        }
      }
      if (!this.error && responseData.message) {
        this.error = responseData.message;
      }
    },
    handleValidationError(responseData) {
      if (responseData.errors && typeof responseData.errors === "object") {
        this.errors = this.formatFieldErrors(responseData.errors);
        const firstError = Object.values(this.errors)[0];
        if (firstError) {
          this.error = firstError;
        }
      } else if (responseData.message) {
        this.error = responseData.message;
      }
    },
    handleGenericError(responseData) {
      this.error = responseData.message || this.$t("branches.createError");
    },
    handleNetworkError(error) {
      this.error = error.message || this.$t("branches.networkError");
    },
    mapCommonErrorsToFields(errorMessages) {
      errorMessages.forEach((message) => {
        if (message.includes("name")) {
          this.errors.name = message;
        } else if (message.includes("name_ar")) {
          this.errors.name_ar = message;
        } else if (message.includes("phone")) {
          this.errors.phone = message;
        } else if (message.includes("address")) {
          this.errors.address = message;
        }
      });
    },
    formatFieldErrors(errorsObject) {
      const formattedErrors = {};
      Object.keys(errorsObject).forEach((field) => {
        const fieldErrors = errorsObject[field];
        if (Array.isArray(fieldErrors)) {
          formattedErrors[field] = fieldErrors[0];
        } else if (typeof fieldErrors === "string") {
          formattedErrors[field] = fieldErrors;
        }
      });
      return formattedErrors;
    },
    showToast(severity, summary, detail) {
      if (this.$toast) {
        this.$toast.add({
          severity: severity,
          summary: summary,
          detail: detail,
          life: 3000,
        });
      }
    },
  },
};
</script>

<style scoped>
.branch-create-form {
  max-width: 100%;
}
.field {
  margin-bottom: 1.5rem;
}
</style>

_________________________________________________________________________________________________________________
_________________________________________________________________________________________________________________

src\latest\model\branch\parts\details\BranchDetails.vue


<template>
  <div class="branch-show-wrapper" :class="layoutClasses">
    <div class="branch-layout-container">
      <main
        class="branch-main-content"
        :class="{ 'sidebar-collapsed': sidebarCollapsed }"
      >
        <div class="branch-show-page">
          <Button
            :label="$t('branches.openPos')"
            icon="pi pi-shopping-cart"
            @click="openPosModal"
            class="p-button-success mb-3"
            v-if="hasPosAccess"
          />
          <!-- Loading State -->
          <div
            v-if="loading"
            class="flex justify-content-center align-items-center py-6"
          >
            <ProgressSpinner />
            <p class="ml-3">{{ $t("common.loading") }}</p>
          </div>

          <!-- Error State -->
          <div v-else-if="error" class="error-state">
            <Message severity="error" class="mb-3">
              {{ error }}
            </Message>
            <Button
              :label="$t('common.retry')"
              icon="pi pi-refresh"
              @click="fetchBranch"
            />
          </div>

          <!-- Branch Content -->
          <div v-else-if="branch.id" class="branch-content">
            <!-- Company Hero Banner -->
            <section
              class="company-hero"
              v-if="company && (company.cover || company.logo)"
            >
              <div
                class="company-hero-bg"
                :style="
                  company?.cover?.file_path
                    ? {
                        backgroundImage:
                          'url(' + cleanFilePath(company.cover.file_path) + ')',
                      }
                    : {}
                "
              ></div>
              <div class="company-hero-overlay"></div>
              <div class="company-hero-content">
                <img
                  v-if="company?.logo?.file_path"
                  :src="cleanFilePath(company.logo.file_path)"
                  alt="Company Logo"
                  class="company-logo"
                />
                <div class="company-titles">
                  <h3 class="company-name mb-1">{{ company?.name }}</h3>
                  <div
                    v-if="company?.name_ar"
                    class="text-sm text-color-secondary"
                  >
                    {{ company.name_ar }}
                  </div>
                </div>
              </div>
            </section>

            <!-- Branch Title follows table pattern -->
            <h2 class="mb-1">{{ branch.name }}</h2>
            <div
              v-if="branch.name_ar"
              class="text-sm text-color-secondary mb-3"
            >
              {{ branch.name_ar }}
            </div>

            <Divider />
            <div class="grid">
              <div class="col-12 md:col-6">
                <strong>{{ $t("branches.companyId") || "Company ID" }}:</strong>
                {{ branch.company_id }}
              </div>
              <div class="col-12 md:col-6">
                <strong>{{ $t("branches.phone") || "Phone" }}:</strong>
                {{ branch.phone || "-" }}
              </div>
              <div class="col-12 md:col-6">
                <strong>{{ $t("branches.address") || "Address" }}:</strong>
                {{ branch.address || "-" }}
              </div>
              <div class="col-12 md:col-6">
                <strong
                  >{{ $t("branches.addressAr") || "Address (Arabic)" }}:</strong
                >
                {{ branch.address_ar || "-" }}
              </div>
              <div class="col-12 md:col-6">
                <strong>{{ $t("common.createdAt") || "Created At" }}:</strong>
                {{ formatDate(branch.created_at) }}
              </div>
            </div>

            <!-- Company Info Summary -->
            <Divider />
            <div class="grid company-info-grid">
              <div class="col-12 md:col-6">
                <strong>{{ $t("companies.phone") || "Phone" }}:</strong>
                {{ company?.phone || "-" }}
              </div>
              <div class="col-12 md:col-6">
                <strong>{{ $t("companies.email") || "Email" }}:</strong>
                {{ company?.email || "-" }}
              </div>
              <div class="col-12 md:col-6">
                <strong>{{ $t("companies.address") || "Address" }}:</strong>
                {{ company?.address || "-" }}
              </div>
              <div class="col-12 md:col-6">
                <strong>{{ $t("companies.country") || "Country" }}:</strong>
                {{ company?.country?.name || "-" }}
              </div>
              <div class="col-12 md:col-6">
                <strong
                  >{{ $t("companies.governorate") || "Governorate" }}:</strong
                >
                {{ company?.governorate?.name || "-" }}
              </div>
              <div class="col-12 md:col-6">
                <strong>{{ $t("companies.city") || "City" }}:</strong>
                {{ company?.city?.name || "-" }}
              </div>
              <div class="col-12 md:col-6">
                <strong>{{ $t("companies.currency") || "Currency" }}:</strong>
                {{ company?.currency?.name || "-" }}
              </div>
            </div>
            <div class="mt-3">
              <Button
                :label="$t('common.edit') || 'Edit'"
                icon="pi pi-pencil"
                class="p-button-sm"
                @click="editBranch"
              />
              <Button
                :label="$t('common.back') || 'Back'"
                icon="pi pi-arrow-left"
                class="p-button-text p-button-sm ml-2"
                @click="goBackToBranches"
              />
            </div>
          </div>

          <!-- Nested routes if needed -->
          <RouterView :branch="branch" :branch_id="branch_id" />
        </div>
      </main>
    </div>

    <!-- Edit Branch Modal -->
    <BranchEditModal
      ref="branchEditModal"
      :branch="branch"
      @branch-updated="handleBranchUpdated"
    />

    <PosModal ref="posModal" :company-id="companyId" :branch-id="branchId" />
    <Toast />
  </div>
</template>

<script>
import { RouterView } from "vue-router";
import general_request from "../../../../views/layouts/constants/general_request";

import Button from "primevue/button";
import ProgressSpinner from "primevue/progressspinner";
import Message from "primevue/message";
import Toast from "primevue/toast";
import Divider from "primevue/divider";
import PosModal from "../pos/PosModal.vue";

export default {
  name: "BranchDetails",
  components: {
    RouterView,
    Button,
    ProgressSpinner,
    Message,
    Toast,
    Divider,
    PosModal,
  },
  props: {
    branch_id: {
      type: String,
      required: false, // will fallback to route param
    },
    company_id: {
      type: String,
      required: false,
    },
  },
  data() {
    return {
      branch: {},
      company: {},
      loading: false,
      error: "",
      sidebarCollapsed: false,
      isMobile: false,
      currentLanguage: localStorage.getItem("language") || "en",
      hasPosAccess: true, // Set to true to always show, false to hide
    };
  },
  computed: {
    currentDirection() {
      return this.currentLanguage === "ar" ? "rtl" : "ltr";
    },
    layoutClasses() {
      return {
        "branch-ltr": this.currentDirection === "ltr",
        "branch-rtl": this.currentDirection === "rtl",
        "mobile-view": this.isMobile,
      };
    },
  },
  mounted() {
    this.fetchBranch();
    this.checkMobile();
    this.setupLanguageListener();
    window.addEventListener("resize", this.checkMobile);
  },
  beforeUnmount() {
    window.removeEventListener("resize", this.checkMobile);
    if (this.languageUnwatch) {
      this.languageUnwatch();
    }
  },
  methods: {
    async fetchBranch() {
      this.loading = true;
      this.error = "";

      try {
        const branchId = this.branch_id || this.$route.params.branch_id;
        if (!branchId) {
          throw new Error("Branch ID is missing");
        }

        const url = `${general_request.BASE_URL}/admin/company/branch/${branchId}`;
        const response = await this.$http.get(url, {
          headers: general_request.headers,
        });

        if (response.data && response.data.data) {
          this.branch = response.data.data;
          this.company = response.data.data.company || {};
        } else {
          throw new Error("Invalid response format");
        }
      } catch (error) {
        console.error("Error fetching branch:", error);
        this.error =
          error.response?.data?.message ||
          error.message ||
          this.$t("errors.failedToLoadBranch") ||
          "Failed to load branch";
      } finally {
        this.loading = false;
      }
    },

    cleanFilePath(path) {
      if (!path) return "";
      try {
        // Some API values include backticks/spaces; strip them
        return String(path)
          .replace(/[`'\"]/g, "")
          .trim();
      } catch (e) {
        return path;
      }
    },

    formatDate(value) {
      if (!value) return "-";
      try {
        const d = new Date(value);
        return d.toLocaleString();
      } catch (e) {
        return value;
      }
    },

    toggleSidebar() {
      this.sidebarCollapsed = !this.sidebarCollapsed;
    },

    goBackToBranches() {
      const companyId = this.company_id || this.$route.params.company_id;
      if (companyId) {
        this.$router.push(`/company/${companyId}/branches`);
      } else {
        this.$router.push(`/company/branches`);
      }
    },

    editBranch() {
      this.$refs.branchEditModal &&
        this.$refs.branchEditModal.openModal &&
        this.$refs.branchEditModal.openModal();
    },

    handleBranchUpdated(updatedBranch) {
      this.branch = { ...this.branch, ...updatedBranch };
      this.showToast(
        "success",
        this.$t("common.success") || "Success",
        this.$t("branches.branchUpdated") || "Branch updated"
      );
      this.fetchBranch();
    },

    checkMobile() {
      this.isMobile = window.innerWidth <= 768;
      if (this.isMobile) {
        this.sidebarCollapsed = true;
      }
    },

    setupLanguageListener() {
      this.languageUnwatch = this.$watch("$i18n.locale", (newLocale) => {
        this.currentLanguage = newLocale;
      });
    },

    showToast(severity, summary, detail) {
      if (this.$toast) {
        this.$toast.add({ severity, summary, detail, life: 3000 });
      }
    },
    openPosModal() {
      if (this.$refs.posModal) {
        this.$refs.posModal.openModal();
      }
    },
  },
};
</script>

<style scoped>
.branch-show-wrapper {
  min-height: 100vh;
  background: var(--surface-ground);
  position: relative;
}

.branch-layout-container {
  position: relative;
  min-height: 100vh;
  width: 100%;
  overflow: hidden;
}

.branch-main-content {
  min-height: calc(100vh - 70px);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  padding: 0;
  background: var(--surface-ground);
  position: relative;
  z-index: 1;
}

.branch-main-content.sidebar-collapsed {
  margin-left: 70px;
}

.branch-rtl .branch-main-content {
  margin-left: 0;
}

.branch-rtl .branch-main-content.sidebar-collapsed {
  margin-right: 70px;
}

.branch-show-page {
  width: 100%;
  margin: 0 auto;
  padding: 1rem;
  transition: all 0.3s ease;
}

.branch-sidebar-overlay {
  position: absolute;
  top: 70px;
  left: 0;
  width: 100%;
  height: calc(100vh - 70px);
  background: rgba(0, 0, 0, 0.5);
  z-index: 699;
  backdrop-filter: blur(2px);
}

.error-state {
  text-align: center;
  padding: 2rem;
}

.branch-content {
  animation: fadeIn 0.3s ease;
}

/* Company Hero styles */
.company-hero {
  position: relative;
  height: 180px;
  border-radius: 8px;
  overflow: hidden;
  margin-bottom: 1rem;
}

.company-hero-bg {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  filter: brightness(0.85);
}

.company-hero-overlay {
  position: absolute;
  inset: 0;
  background: linear-gradient(0deg, rgba(0, 0, 0, 0.35), rgba(0, 0, 0, 0.15));
}

.company-hero-content {
  position: relative;
  display: flex;
  align-items: center;
  gap: 1rem;
  padding: 1rem;
  z-index: 2;
}

.company-logo {
  width: 64px;
  height: 64px;
  object-fit: cover;
  border-radius: 50%;
  border: 2px solid rgba(255, 255, 255, 0.7);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.company-titles .company-name {
  color: #fff;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.company-info-grid {
  background: var(--surface-card);
  border-radius: 8px;
  padding: 1rem;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@media (max-width: 768px) {
  .branch-layout-container {
    overflow: visible;
  }

  .branch-main-content {
    margin-left: 0 !important;
    margin-right: 0 !important;
    width: 100%;
    margin-top: 70px;
  }

  .branch-sidebar-overlay {
    top: 70px;
    z-index: 899;
  }
}
</style>


__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________
__________________________________________________________________________________________________________



src\latest\model\branch\parts\pos\PosService.js

// src/latest/model/branch/parts/pos/PosService.js
import general_request from "../../../../views/layouts/constants/general_request";

class PosService {
     constructor(companyId, branchId) {
          this.companyId = companyId;
          this.branchId = branchId;
          this.baseUrl = general_request.BASE_URL;
          this.headers = general_request.headers;
     }

     // ========== PRODUCTS ==========
     async getProducts(params = {}) {
          try {
               const url = `${this.baseUrl}/admin/company/product/company-final-products/search/${this.companyId}`;
               const response = await this.$http.get(url, {
                    params: { ...params, paginate: true },
                    headers: this.headers
               });
               return response.data;
          } catch (error) {
               console.error('Error fetching products:', error);
               throw error;
          }
     }

     async getProductDetails(productId) {
          try {
               const url = `${this.baseUrl}/admin/company/product/final-product/${productId}`;
               const response = await this.$http.get(url, { headers: this.headers });
               return response.data;
          } catch (error) {
               console.error('Error fetching product details:', error);
               throw error;
          }
     }

     // ========== CATEGORIES ==========
     async getCategories() {
          try {
               const url = `${this.baseUrl}/admin/company/categories/search/${this.companyId}`;
               const response = await this.$http.get(url, {
                    params: { paginate: false },
                    headers: this.headers
               });
               return response.data.data || [];
          } catch (error) {
               console.error('Error fetching categories:', error);
               return [];
          }
     }

     // ========== PAYMENT METHODS ==========
     async getPaymentMethods() {
          try {
               const url = `${this.baseUrl}/system-lookups/15`;
               const response = await this.$http.get(url, { headers: this.headers });
               return response.data.data || [];
          } catch (error) {
               console.error('Error fetching payment methods:', error);
               return [];
          }
     }

     // ========== WAREHOUSES ==========
     async getWarehouses() {
          try {
               const url = `${this.baseUrl}/admin/company/branch/warehouses/search/${this.companyId}`;
               const response = await this.$http.get(url, {
                    params: { branch_id: this.branchId, paginate: false },
                    headers: this.headers
               });
               return response.data.data || [];
          } catch (error) {
               console.error('Error fetching warehouses:', error);
               return [];
          }
     }

     // ========== MEASUREMENT UNITS ==========
     async getMeasurementUnits() {
          try {
               const url = `${this.baseUrl}/admin/company/measurement-units/search/${this.companyId}`;
               const response = await this.$http.get(url, {
                    params: { paginate: false },
                    headers: this.headers
               });
               return response.data.data || [];
          } catch (error) {
               console.error('Error fetching measurement units:', error);
               return [];
          }
     }

     // ========== CONTACTS/CUSTOMERS ==========
     async getContacts(search = '') {
          try {
               const url = `${this.baseUrl}/admin/company/contacts/search/${this.companyId}`;
               const response = await this.$http.get(url, {
                    params: { query_string: search, paginate: false },
                    headers: this.headers
               });
               return response.data.data || [];
          } catch (error) {
               console.error('Error fetching contacts:', error);
               return [];
          }
     }

     async createContact(contactData) {
          try {
               const url = `${this.baseUrl}/admin/company/contact`;
               const payload = {
                    company_id: this.companyId,
                    ...contactData
               };
               const response = await this.$http.post(url, payload, { headers: this.headers });
               return response.data;
          } catch (error) {
               console.error('Error creating contact:', error);
               throw error;
          }
     }

     // ========== CREATE INVOICE ==========
     async createInvoice(invoiceData) {
          try {
               // TODO: Replace with actual invoice creation endpoint
               const url = `${this.baseUrl}/admin/company/sale`; // NEED ENDPOINT
               const payload = {
                    company_id: this.companyId,
                    branch_id: this.branchId,
                    ...invoiceData
               };
               const response = await this.$http.post(url, payload, { headers: this.headers });
               return response.data;
          } catch (error) {
               console.error('Error creating invoice:', error);
               throw error;
          }
     }

     // ========== CALCULATIONS ==========
     calculateItemTotal(item) {
          const price = item.has_discount ? item.price_after_discount : item.price;
          const quantity = item.quantity || 1;
          let total = price * quantity;

          // Add item-level additional costs
          if (item.additional_costs && Array.isArray(item.additional_costs)) {
               item.additional_costs.forEach(cost => {
                    total += parseFloat(cost.value) || 0;
               });
          }

          return parseFloat(total.toFixed(2));
     }

     calculateInvoiceTotals(cartItems, invoiceDiscounts = [], invoiceAdditionalCosts = [], taxRate = 0) {
          let subtotal = 0;

          // Calculate items subtotal
          cartItems.forEach(item => {
               subtotal += this.calculateItemTotal(item);
          });

          // Apply invoice-level discounts
          let discountTotal = 0;
          if (invoiceDiscounts && Array.isArray(invoiceDiscounts)) {
               invoiceDiscounts.forEach(discount => {
                    discountTotal += parseFloat(discount.value) || 0;
               });
          }

          // Apply invoice-level additional costs
          let additionalCostsTotal = 0;
          if (invoiceAdditionalCosts && Array.isArray(invoiceAdditionalCosts)) {
               invoiceAdditionalCosts.forEach(cost => {
                    additionalCostsTotal += parseFloat(cost.value) || 0;
               });
          }

          // Calculate tax
          const taxableAmount = subtotal - discountTotal + additionalCostsTotal;
          const taxAmount = (taxableAmount * taxRate) / 100;

          // Calculate grand total
          const grandTotal = taxableAmount + taxAmount;

          return {
               subtotal: parseFloat(subtotal.toFixed(2)),
               discountTotal: parseFloat(discountTotal.toFixed(2)),
               additionalCostsTotal: parseFloat(additionalCostsTotal.toFixed(2)),
               taxAmount: parseFloat(taxAmount.toFixed(2)),
               grandTotal: parseFloat(grandTotal.toFixed(2)),
               taxableAmount: parseFloat(taxableAmount.toFixed(2))
          };
     }

     // ========== HELD INVOICES ==========
     saveHeldInvoice(invoice) {
          const heldInvoices = this.getHeldInvoices();
          invoice.id = `held_${Date.now()}`;
          invoice.heldAt = new Date().toISOString();
          heldInvoices.push(invoice);
          localStorage.setItem(`pos_held_invoices_${this.companyId}_${this.branchId}`, JSON.stringify(heldInvoices));
          return invoice;
     }

     getHeldInvoices() {
          const stored = localStorage.getItem(`pos_held_invoices_${this.companyId}_${this.branchId}`);
          return stored ? JSON.parse(stored) : [];
     }

     deleteHeldInvoice(invoiceId) {
          const heldInvoices = this.getHeldInvoices();
          const updated = heldInvoices.filter(inv => inv.id !== invoiceId);
          localStorage.setItem(`pos_held_invoices_${this.companyId}_${this.branchId}`, JSON.stringify(updated));
     }

     // ========== DUMMY DATA ==========
     getDummyProducts() {
          return [
               {
                    id: "prod1",
                    name: "Laptop",
                    name_ar: "لابتوب",
                    price: 1500,
                    has_discount: true,
                    discount_value: "10.00",
                    price_after_discount: 1350,
                    category: { id: "cat1", name: "Electronics", name_ar: "إلكترونيات" },
                    main_image: { file: { file_path: "https://fastly.picsum.photos/id/8/5000/3333.jpg?hmac=OeG5ufhPYQBd6Rx1TAldAuF92lhCzAhKQKttGfawWuA" } },
                    stock: 15,
                    details: "High performance laptop",
                    details_ar: "لابتوب عالي الأداء"
               },
               {
                    id: "prod2",
                    name: "Mouse",
                    name_ar: "ماوس",
                    price: 50,
                    has_discount: false,
                    price_after_discount: 50,
                    category: { id: "cat1", name: "Electronics", name_ar: "إلكترونيات" },
                    main_image: { file: { file_path: "https://fastly.picsum.photos/id/7/4728/3168.jpg?hmac=c5B5tfYFM9blHHMhuu4UKmhnbZoJqrzNOP9xjkV4w3o" } },
                    stock: 100,
                    details: "Wireless mouse",
                    details_ar: "ماوس لاسلكي"
               },
               {
                    id: "prod3",
                    name: "Notebook",
                    name_ar: "دفتر",
                    price: 10,
                    has_discount: true,
                    discount_value: "20.00",
                    price_after_discount: 8,
                    category: { id: "cat2", name: "Stationery", name_ar: "قرطاسية" },
                    main_image: null,
                    stock: 200,
                    details: "A4 size notebook",
                    details_ar: "دفتر حجم A4"
               }
          ];
     }

     getDummyCategories() {
          return [
               { id: "cat1", name: "Electronics", name_ar: "إلكترونيات", file: null },
               { id: "cat2", name: "Stationery", name_ar: "قرطاسية", file: null },
               { id: "cat3", name: "Food", name_ar: "طعام", file: null }
          ];
     }

     getDummyPaymentMethods() {
          return [
               { id: "pm1", name: "Cash", name_ar: "نقداً", prefix: "CASH" },
               { id: "pm2", name: "Credit Card", name_ar: "بطاقة ائتمان", prefix: "CREDIT_CARD" },
               { id: "pm3", name: "Bank Transfer", name_ar: "تحويل بنكي", prefix: "BANK_TRANSFER" }
          ];
     }

     getDummyContacts() {
          return [
               { id: "cust1", name: "John Doe", email: "john@example.com", phone: "0123456789", address: "123 Main St" },
               { id: "cust2", name: "Jane Smith", email: "jane@example.com", phone: "0987654321", address: "456 Oak Ave" }
          ];
     }
}

export default PosService;

__________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________

src\latest\model\branch\parts\pos\PosReceipt.vue

<template>
  <div class="pos-receipt" ref="receiptContent">
    <!-- Receipt Header -->
    <div class="receipt-header text-center mb-3">
      <h2 class="m-0">{{ companyName }}</h2>
      <p class="m-0 text-sm" v-if="companyAddress">{{ companyAddress }}</p>
      <p class="m-0 text-sm" v-if="companyPhone">
        {{ $t("pos.phone") }}: {{ companyPhone }}
      </p>
      <Divider />
    </div>

    <!-- Receipt Info -->
    <div class="receipt-info mb-3">
      <div class="grid">
        <div class="col-6">
          <strong>{{ $t("pos.invoiceNumber") }}:</strong>
          <div>{{ invoice.invoice_number }}</div>
        </div>
        <div class="col-6">
          <strong>{{ $t("pos.date") }}:</strong>
          <div>{{ formatDate(invoice.created_at) }}</div>
        </div>
      </div>

      <div class="mt-2">
        <strong>{{ $t("pos.cashier") }}:</strong>
        <div>{{ userName }}</div>
      </div>
    </div>

    <!-- Customer Info -->
    <div
      v-if="invoice.customer"
      class="customer-info mb-3 p-2 surface-50 border-round"
    >
      <h4 class="m-0 mb-1">{{ $t("pos.customer") }}</h4>
      <p class="m-0">
        <strong>{{ invoice.customer.name }}</strong>
      </p>
      <p v-if="invoice.customer.phone" class="m-0 text-sm">
        {{ $t("pos.phone") }}: {{ invoice.customer.phone }}
      </p>
      <p v-if="invoice.customer.email" class="m-0 text-sm">
        {{ $t("pos.email") }}: {{ invoice.customer.email }}
      </p>
      <p v-if="invoice.customer.address" class="m-0 text-sm">
        {{ $t("pos.address") }}: {{ invoice.customer.address }}
      </p>
    </div>

    <!-- Items Table -->
    <div class="receipt-items mb-3">
      <h4 class="m-0 mb-2">{{ $t("pos.items") }}</h4>
      <DataTable
        :value="invoice.items"
        class="p-datatable-sm table-scroll-container"
        :showHeaders="false"
      >
        <Column field="name">
          <template #body="slotProps">
            <div>
              <div class="font-bold">{{ slotProps.data.name }}</div>
              <div class="text-sm text-color-secondary">
                {{ slotProps.data.quantity }} ×
                {{
                  formatCurrency(
                    slotProps.data.has_discount
                      ? slotProps.data.price_after_discount
                      : slotProps.data.price
                  )
                }}
              </div>
              <div
                v-if="
                  slotProps.data.additional_costs &&
                  slotProps.data.additional_costs.length > 0
                "
                class="text-xs text-color-secondary mt-1"
              >
                <div
                  v-for="cost in slotProps.data.additional_costs"
                  :key="cost.id"
                  class="ml-2"
                >
                  + {{ cost.name }}: {{ formatCurrency(cost.value) }}
                </div>
              </div>
            </div>
          </template>
        </Column>

        <Column style="width: 80px">
          <template #body="slotProps">
            {{ formatCurrency(calculateItemTotal(slotProps.data)) }}
          </template>
        </Column>
      </DataTable>
    </div>

    <!-- Invoice-Level Adjustments -->
    <div v-if="hasInvoiceAdjustments" class="invoice-adjustments mb-3">
      <h4 class="m-0 mb-2">{{ $t("pos.adjustments") }}</h4>

      <!-- Discounts -->
      <div
        v-if="invoice.discounts && invoice.discounts.length > 0"
        class="mb-2"
      >
        <div
          v-for="discount in invoice.discounts"
          :key="discount.name"
          class="flex justify-content-between text-red-500"
        >
          <span>{{ discount.name }}:</span>
          <span>-{{ formatCurrency(discount.value) }}</span>
        </div>
      </div>

      <!-- Additional Costs -->
      <div
        v-if="invoice.additional_costs && invoice.additional_costs.length > 0"
        class="mb-2"
      >
        <div
          v-for="cost in invoice.additional_costs"
          :key="cost.name"
          class="flex justify-content-between text-green-500"
        >
          <span>{{ cost.name }}:</span>
          <span>+{{ formatCurrency(cost.value) }}</span>
        </div>
      </div>
    </div>

    <!-- Totals -->
    <div class="receipt-totals">
      <div class="grid">
        <div class="col-6">
          <strong>{{ $t("pos.subtotal") }}:</strong>
        </div>
        <div class="col-6 text-right">
          {{ formatCurrency(invoice.totals.subtotal) }}
        </div>

        <div v-if="invoice.totals.discountTotal > 0" class="col-6 text-red-500">
          <strong>{{ $t("pos.discount") }}:</strong>
        </div>
        <div
          v-if="invoice.totals.discountTotal > 0"
          class="col-6 text-right text-red-500"
        >
          -{{ formatCurrency(invoice.totals.discountTotal) }}
        </div>

        <div
          v-if="invoice.totals.additionalCostsTotal > 0"
          class="col-6 text-green-500"
        >
          <strong>{{ $t("pos.additionalCosts") }}:</strong>
        </div>
        <div
          v-if="invoice.totals.additionalCostsTotal > 0"
          class="col-6 text-right text-green-500"
        >
          +{{ formatCurrency(invoice.totals.additionalCostsTotal) }}
        </div>

        <div class="col-6">
          <strong>{{ $t("pos.tax") }} ({{ taxRate }}%):</strong>
        </div>
        <div class="col-6 text-right">
          {{ formatCurrency(invoice.totals.taxAmount) }}
        </div>

        <Divider class="col-12 my-2" />

        <div class="col-6 font-bold text-xl">{{ $t("pos.total") }}:</div>
        <div class="col-6 text-right font-bold text-xl text-primary">
          {{ formatCurrency(invoice.totals.grandTotal) }}
        </div>
      </div>
    </div>

    <!-- Payment Info -->
    <div class="payment-info mt-3 p-2 surface-100 border-round">
      <h4 class="m-0 mb-1">{{ $t("pos.payment") }}</h4>
      <p class="m-0">
        <strong>{{ $t("pos.paymentMethod") }}:</strong>
        {{ invoice.payment_method?.name || $t("pos.cash") }}
      </p>
      <p v-if="invoice.details" class="m-0 mt-1 text-sm">
        <strong>{{ $t("pos.notes") }}:</strong> {{ invoice.details }}
      </p>
    </div>

    <!-- Receipt Footer -->
    <div class="receipt-footer text-center mt-4">
      <Divider />
      <p class="text-sm text-color-secondary m-0">
        {{ $t("pos.thankYouMessage") }}
      </p>
      <p class="text-xs text-color-secondary m-0 mt-1">
        {{ $t("pos.returnPolicy") }}
      </p>
      <p class="text-xs text-color-secondary m-0">
        {{ $t("pos.receiptFooter") }}
      </p>
    </div>
  </div>
</template>

<script>
import DataTable from "primevue/datatable";
import Column from "primevue/column";
import Divider from "primevue/divider";

export default {
  name: "PosReceipt",
  components: {
    DataTable,
    Column,
    Divider,
  },
  props: {
    invoice: {
      type: Object,
      required: true,
    },
    companyId: {
      type: String,
      required: true,
    },
    branchId: {
      type: String,
      required: true,
    },
  },
  data() {
    return {
      companyName: "Your Company Name",
      companyAddress: "123 Business Street, City",
      companyPhone: "0123456789",
      userName: "Cashier",
      taxRate: 14,
    };
  },
  computed: {
    hasInvoiceAdjustments() {
      return (
        (this.invoice.discounts && this.invoice.discounts.length > 0) ||
        (this.invoice.additional_costs &&
          this.invoice.additional_costs.length > 0)
      );
    },
  },
  created() {
    // TODO: Load company info from API
    this.loadCompanyInfo();
  },
  methods: {
    async loadCompanyInfo() {
      // TODO: Load company info from API
      // For now, use dummy data
    },

    formatCurrency(amount) {
      return `$${parseFloat(amount).toFixed(2)}`;
    },

    formatDate(dateString) {
      if (!dateString) return "";
      const date = new Date(dateString);
      return (
        date.toLocaleDateString() +
        " " +
        date.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" })
      );
    },

    calculateItemTotal(item) {
      const price = item.has_discount ? item.price_after_discount : item.price;
      let total = price * (item.quantity || 1);

      if (item.additional_costs && Array.isArray(item.additional_costs)) {
        item.additional_costs.forEach((cost) => {
          total += parseFloat(cost.value) || 0;
        });
      }

      return total;
    },
  },
};
</script>

<style scoped>
.pos-receipt {
  font-family: "Courier New", monospace;
  font-size: 12px;
  line-height: 1.4;
  background: white;
  padding: 20px;
  max-width: 400px;
  margin: 0 auto;
}

.receipt-header {
  border-bottom: 2px dashed #333;
  padding-bottom: 10px;
}

.receipt-header h2 {
  font-size: 18px;
  font-weight: bold;
}

.receipt-items :deep(.p-datatable) {
  font-size: 11px;
}

.receipt-items :deep(.p-datatable-tbody tr) {
  border-bottom: 1px dashed #ddd;
}

.receipt-items :deep(.p-datatable-tbody tr:last-child) {
  border-bottom: none;
}

.receipt-totals .grid > div {
  padding: 2px 0;
}

.payment-info {
  border-left: 3px solid #007bff;
}

.receipt-footer {
  border-top: 2px dashed #333;
  padding-top: 10px;
}

/* Print styles */
@media print {
  .pos-receipt {
    width: 80mm;
    padding: 5mm;
    font-size: 10px;
  }

  .receipt-header h2 {
    font-size: 14px;
  }

  .receipt-items :deep(.p-datatable) {
    font-size: 9px;
  }
}
</style>

___________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________

src\latest\model\branch\parts\pos\PosProductsPanel.vue

<template>
  <div class="pos-products-panel">
    <!-- Search and Filter Bar -->
    <div class="products-filter-bar mb-3 p-3 surface-50 border-round">
      <div class="grid">
        <div class="col-12 md:col-6">
          <div class="p-inputgroup">
            <span class="p-inputgroup-addon">
              <i class="pi pi-search"></i>
            </span>
            <InputText
              v-model="search"
              :placeholder="$t('pos.searchProducts')"
              @input="handleSearch"
              class="w-full"
            />
            <Button
              v-if="search"
              icon="pi pi-times"
              @click="clearSearch"
              class="p-button-text"
            />
          </div>
        </div>

        <div class="col-12 md:col-6">
          <div class="p-inputgroup">
            <span class="p-inputgroup-addon">
              <i class="pi pi-filter"></i>
            </span>
            <Dropdown
              v-model="selectedCategoryId"
              :options="categories"
              optionLabel="name"
              optionValue="id"
              :placeholder="$t('pos.allCategories')"
              @change="handleCategoryChange"
              class="w-full"
              showClear
            />
          </div>
        </div>
      </div>

      <!-- Barcode Input -->
      <div class="mt-2">
        <div class="p-inputgroup">
          <span class="p-inputgroup-addon">
            <i class="pi pi-barcode"></i>
          </span>
          <InputText
            v-model="barcode"
            :placeholder="$t('pos.scanBarcode')"
            @keyup.enter="searchByBarcode"
            class="w-full"
          />
          <Button
            :label="$t('pos.scan')"
            @click="searchByBarcode"
            class="p-button-primary"
          />
        </div>
      </div>
    </div>

    <!-- Categories Quick Filter -->
    <div class="categories-scroll mb-3">
      <div class="flex flex-wrap gap-2">
        <Button
          :label="$t('pos.all')"
          :severity="!selectedCategoryId ? 'primary' : 'secondary'"
          @click="selectCategory(null)"
          class="p-button-sm"
        />
        <Button
          v-for="category in categories"
          :key="category.id"
          :label="category.name"
          :severity="
            selectedCategoryId === category.id ? 'primary' : 'secondary'
          "
          @click="selectCategory(category.id)"
          class="p-button-sm"
        />
      </div>
    </div>

    <!-- Products Grid -->
    <div v-if="filteredProducts.length > 0" class="products-grid">
      <div class="grid">
        <div
          v-for="product in paginatedProducts"
          :key="product.id"
          class="col-6 md:col-4 lg:col-3 xl:col-2"
        >
          <PosProductCard
            :product="product"
            @add-to-cart="$emit('add-to-cart', product)"
            @view-details="showProductDetails(product)"
          />
        </div>
      </div>

      <!-- Pagination -->
      <div
        v-if="totalPages > 1"
        class="pagination mt-3 flex justify-content-center"
      >
        <Paginator
          v-model="currentPage"
          :rows="productsPerPage"
          :totalRecords="filteredProducts.length"
          :rowsPerPageOptions="[12, 24, 48, 96]"
          @page="onPageChange"
          template="FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink"
        />
      </div>
    </div>

    <!-- Empty State -->
    <div v-else class="empty-state text-center py-6">
      <i class="pi pi-box text-6xl text-color-secondary mb-3"></i>
      <h3 class="text-color-secondary">
        {{ $t("pos.noProductsFound") }}
      </h3>
      <p class="text-color-secondary">
        {{ $t("pos.tryDifferentSearch") }}
      </p>
    </div>

    <!-- Product Details Modal -->
    <Dialog
      v-model:visible="showDetailsModal"
      :header="selectedProduct?.name"
      :modal="true"
      :style="{ width: '500px' }"
    >
      <div v-if="selectedProduct" class="product-details">
        <div class="text-center mb-3">
          <img
            v-if="selectedProduct.main_image?.file?.file_path"
            :src="selectedProduct.main_image.file.file_path"
            :alt="selectedProduct.name"
            class="product-detail-image border-round"
          />
          <div v-else class="no-image-placeholder">
            <i class="pi pi-image text-6xl text-color-secondary"></i>
          </div>
        </div>

        <div class="grid">
          <div class="col-12">
            <h3>{{ selectedProduct.name }}</h3>
            <p class="text-color-secondary">{{ selectedProduct.name_ar }}</p>
          </div>

          <div class="col-6">
            <strong>{{ $t("pos.price") }}:</strong>
            <div class="flex align-items-center gap-2 mt-1">
              <span
                v-if="selectedProduct.has_discount"
                class="original-price text-line-through text-color-secondary"
              >
                {{ formatCurrency(selectedProduct.price) }}
              </span>
              <span
                :class="[
                  'current-price',
                  { 'text-green-500 font-bold': selectedProduct.has_discount },
                ]"
              >
                {{
                  formatCurrency(
                    selectedProduct.price_after_discount ||
                      selectedProduct.price
                  )
                }}
              </span>
              <Tag
                v-if="selectedProduct.has_discount"
                :value="`-${selectedProduct.discount_value}%`"
                severity="danger"
                class="ml-2"
              />
            </div>
          </div>

          <div class="col-6">
            <strong>{{ $t("pos.stock") }}:</strong>
            <div class="mt-1">
              <Tag
                :value="selectedProduct.stock || 'N/A'"
                :severity="getStockSeverity(selectedProduct.stock)"
              />
            </div>
          </div>

          <div class="col-12 mt-2">
            <strong>{{ $t("pos.category") }}:</strong>
            <p>{{ selectedProduct.category?.name }}</p>
          </div>

          <div v-if="selectedProduct.details" class="col-12 mt-2">
            <strong>{{ $t("pos.description") }}:</strong>
            <p>{{ selectedProduct.details }}</p>
          </div>

          <div
            v-if="selectedProduct.final_product_variant_values?.length > 0"
            class="col-12 mt-2"
          >
            <strong>{{ $t("pos.variants") }}:</strong>
            <div class="flex flex-wrap gap-2 mt-1">
              <Chip
                v-for="variant in selectedProduct.final_product_variant_values"
                :key="variant.id"
                :label="`${variant.variant?.name}: ${variant.variant_value?.value}`"
                class="mr-2 mb-2"
              />
            </div>
          </div>
        </div>
      </div>

      <template #footer>
        <Button
          :label="$t('pos.addToCart')"
          icon="pi pi-cart-plus"
          @click="addSelectedToCart"
          class="p-button-primary"
        />
        <Button
          :label="$t('common.close')"
          @click="showDetailsModal = false"
          class="p-button-text"
        />
      </template>
    </Dialog>

    <!-- Loading -->
    <div v-if="loading" class="loading-overlay">
      <ProgressSpinner />
      <p class="mt-2">{{ $t("pos.loadingProducts") }}</p>
    </div>
  </div>
</template>

<script>
import InputText from "primevue/inputtext";
import Button from "primevue/button";
import Dropdown from "primevue/dropdown";
import Dialog from "primevue/dialog";
import Tag from "primevue/tag";
import Chip from "primevue/chip";
import Paginator from "primevue/paginator";
import ProgressSpinner from "primevue/progressspinner";

import PosProductCard from "./PosProductCard.vue";
import PosService from "./PosService.js";

export default {
  name: "PosProductsPanel",
  components: {
    InputText,
    Button,
    Dropdown,
    Dialog,
    Tag,
    Chip,
    Paginator,
    ProgressSpinner,
    PosProductCard,
  },
  props: {
    companyId: {
      type: String,
      required: true,
    },
    branchId: {
      type: String,
      required: true,
    },
    selectedCategory: {
      type: String,
      default: null,
    },
    searchQuery: {
      type: String,
      default: "",
    },
  },
  data() {
    return {
      // Products
      products: [],
      filteredProducts: [],
      selectedProduct: null,

      // Categories
      categories: [],
      selectedCategoryId: null,

      // Search
      search: "",
      barcode: "",

      // Pagination
      currentPage: 1,
      productsPerPage: 12,

      // Modals
      showDetailsModal: false,

      // Loading
      loading: false,

      // Service
      posService: null,
    };
  },
  computed: {
    paginatedProducts() {
      const start = (this.currentPage - 1) * this.productsPerPage;
      const end = start + this.productsPerPage;
      return this.filteredProducts.slice(start, end);
    },
    totalPages() {
      return Math.ceil(this.filteredProducts.length / this.productsPerPage);
    },
  },
  watch: {
    selectedCategory: {
      immediate: true,
      handler(newVal) {
        this.selectedCategoryId = newVal;
      },
    },
    searchQuery: {
      immediate: true,
      handler(newVal) {
        this.search = newVal;
      },
    },
  },
  created() {
    this.posService = new PosService(this.companyId, this.branchId);
    this.loadData();
  },
  methods: {
    async loadData() {
      this.loading = true;
      try {
        // Load categories
        // TODO: Replace with real API
        this.categories = this.posService.getDummyCategories();

        // Load products
        // TODO: Replace with real API
        this.products = this.posService.getDummyProducts();
        this.filteredProducts = [...this.products];
      } catch (error) {
        console.error("Error loading products:", error);
        this.$toast.add({
          severity: "error",
          summary: this.$t("pos.loadError"),
          detail: this.$t("pos.failedToLoadProducts"),
          life: 3000,
        });
      } finally {
        this.loading = false;
      }
    },

    filterProducts() {
      let filtered = [...this.products];

      // Filter by category
      if (this.selectedCategoryId) {
        filtered = filtered.filter(
          (product) => product.category?.id === this.selectedCategoryId
        );
      }

      // Filter by search
      if (this.search) {
        const searchLower = this.search.toLowerCase();
        filtered = filtered.filter(
          (product) =>
            product.name.toLowerCase().includes(searchLower) ||
            product.name_ar?.toLowerCase().includes(searchLower) ||
            product.details?.toLowerCase().includes(searchLower)
        );
      }

      this.filteredProducts = filtered;
      this.currentPage = 1; // Reset to first page on filter change
    },

    handleSearch() {
      this.filterProducts();
      this.$emit("search", this.search);
    },

    clearSearch() {
      this.search = "";
      this.filterProducts();
      this.$emit("search", "");
    },

    handleCategoryChange() {
      this.filterProducts();
      this.$emit("category-change", this.selectedCategoryId);
    },

    selectCategory(categoryId) {
      this.selectedCategoryId = categoryId;
      this.handleCategoryChange();
    },

    searchByBarcode() {
      if (!this.barcode.trim()) return;

      // TODO: Implement barcode search with API

      // For now, simulate search
      const product = this.products.find(
        (p) =>
          p.id.toLowerCase().includes(this.barcode.toLowerCase()) ||
          p.name.toLowerCase().includes(this.barcode.toLowerCase())
      );

      if (product) {
        this.showProductDetails(product);
      } else {
        this.$toast.add({
          severity: "warn",
          summary: this.$t("pos.productNotFound"),
          detail: this.$t("pos.noProductWithBarcode"),
          life: 3000,
        });
      }

      this.barcode = "";
    },

    showProductDetails(product) {
      this.selectedProduct = product;
      this.showDetailsModal = true;
    },

    addSelectedToCart() {
      if (this.selectedProduct) {
        this.$emit("add-to-cart", this.selectedProduct);
        this.showDetailsModal = false;
      }
    },

    onPageChange(event) {
      this.currentPage = event.page + 1;
    },

    formatCurrency(amount) {
      // TODO: Use actual currency from company settings
      return `$${parseFloat(amount).toFixed(2)}`;
    },

    getStockSeverity(stock) {
      if (!stock || stock <= 0) return "danger";
      if (stock <= 10) return "warning";
      return "success";
    },
  },
};
</script>

<style scoped>
.pos-products-panel {
  height: 100%;
  display: flex;
  flex-direction: column;
}

.products-filter-bar {
  background: #f8f9fa;
  border: 1px solid #dee2e6;
}

.categories-scroll {
  overflow-x: auto;
  padding-bottom: 5px;
}

.categories-scroll::-webkit-scrollbar {
  height: 4px;
}

.categories-scroll::-webkit-scrollbar-track {
  background: #f1f1f1;
}

.categories-scroll::-webkit-scrollbar-thumb {
  background: #888;
  border-radius: 2px;
}

.products-grid {
  flex: 1;
  overflow-y: auto;
  padding-right: 5px;
}

.products-grid::-webkit-scrollbar {
  width: 6px;
}

.products-grid::-webkit-scrollbar-track {
  background: #f1f1f1;
}

.products-grid::-webkit-scrollbar-thumb {
  background: #888;
  border-radius: 3px;
}

.product-detail-image {
  max-width: 200px;
  max-height: 200px;
  object-fit: contain;
}

.no-image-placeholder {
  width: 200px;
  height: 200px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #f8f9fa;
  border: 2px dashed #dee2e6;
  border-radius: 8px;
  margin: 0 auto;
}

.original-price {
  font-size: 0.9rem;
  color: #6c757d;
}

.current-price {
  font-size: 1.2rem;
  font-weight: 600;
  color: #28a745;
}

.loading-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255, 255, 255, 0.9);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.empty-state {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

:deep(.p-button.p-button-sm) {
  padding: 0.25rem 0.75rem;
  font-size: 0.875rem;
}
</style>


________________________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________________

src\latest\model\branch\parts\pos\PosProductCard.vue

<template>
  <div class="pos-product-card" @click="$emit('view-details')">
    <div
      class="product-card-inner p-3 surface-card border-round cursor-pointer hover:surface-hover transition-all transition-duration-300"
    >
      <!-- Product Image -->
      <div class="product-image mb-2">
        <img
          v-if="product.main_image?.file?.file_path"
          :src="product.main_image.file.file_path"
          :alt="product.name"
          class="border-round w-full"
        />
        <div v-else class="no-image">
          <i class="pi pi-image"></i>
          <span class="block mt-2 text-sm">{{ $t("pos.noImage") }}</span>
        </div>
      </div>

      <!-- Product Info -->
      <div class="product-info">
        <h4
          class="product-name m-0 mb-1 text-sm font-bold truncate"
          :title="product.name"
        >
          {{ product.name }}
        </h4>
        <p
          class="product-name-ar m-0 mb-2 text-xs text-color-secondary truncate"
          :title="product.name_ar"
        >
          {{ product.name_ar }}
        </p>

        <!-- Price -->
        <div class="product-price mb-2">
          <div class="flex align-items-center gap-1">
            <span
              v-if="product.has_discount"
              class="original-price text-line-through text-xs text-color-secondary"
            >
              {{ formatCurrency(product.price) }}
            </span>
            <span class="current-price font-bold text-primary">
              {{
                formatCurrency(
                  product.has_discount
                    ? product.price_after_discount
                    : product.price
                )
              }}
            </span>
            <Tag
              v-if="product.has_discount"
              :value="`-${product.discount_value}%`"
              severity="danger"
              size="small"
              class="ml-1"
            />
          </div>
        </div>

        <!-- Stock -->
        <div class="product-stock mb-3">
          <Tag
            :value="product.stock || 0"
            :severity="getStockSeverity(product.stock)"
            size="small"
            class="w-full justify-content-center"
          />
        </div>

        <!-- Add to Cart Button -->
        <Button
          :label="$t('pos.addToCart')"
          icon="pi pi-cart-plus"
          @click.stop="addToCart"
          class="w-full p-button-sm"
          :disabled="!product.stock || product.stock <= 0"
          :loading="addingToCart"
        >
          <template #loading>
            <i class="pi pi-spin pi-spinner mr-2"></i>
            {{ $t("pos.adding") }}
          </template>
        </Button>
      </div>
    </div>
  </div>
</template>

<script>
import Button from "primevue/button";
import Tag from "primevue/tag";

export default {
  name: "PosProductCard",
  components: {
    Button,
    Tag,
  },
  props: {
    product: {
      type: Object,
      required: true,
    },
  },
  data() {
    return {
      addingToCart: false,
    };
  },
  methods: {
    addToCart() {
      this.addingToCart = true;

      // Simulate API call
      setTimeout(() => {
        this.$emit("add-to-cart", this.product);
        this.addingToCart = false;
      }, 300);
    },

    formatCurrency(amount) {
      return `$${parseFloat(amount).toFixed(2)}`;
    },

    getStockSeverity(stock) {
      if (!stock || stock <= 0) return "danger";
      if (stock <= 10) return "warning";
      return "success";
    },
  },
};
</script>

<style scoped>
.pos-product-card {
  height: 100%;
}

.product-card-inner {
  height: 100%;
  display: flex;
  flex-direction: column;
  border: 1px solid #dee2e6;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.product-card-inner:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
  border-color: #007bff;
}

.product-image {
  height: 150px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #f8f9fa;
  border-radius: 6px;
  overflow: hidden;
}

.product-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.no-image {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: #6c757d;
}

.no-image i {
  font-size: 3rem;
  margin-bottom: 0.5rem;
}

.product-info {
  flex: 1;
  display: flex;
  flex-direction: column;
}

.product-name {
  line-height: 1.2;
  max-height: 2.4em;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
}

.product-name-ar {
  line-height: 1.2;
  max-height: 1.8em;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 1;
  -webkit-box-orient: vertical;
}

.original-price {
  font-size: 0.75rem;
}

.current-price {
  font-size: 1rem;
}

.product-stock {
  margin-top: auto;
}

.truncate {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

:deep(.p-button) {
  font-weight: 600;
}

:deep(.p-button.p-button-sm) {
  padding: 0.375rem 0.75rem;
  font-size: 0.875rem;
}

:deep(.p-tag.p-tag-sm) {
  font-size: 0.75rem;
  padding: 0.125rem 0.5rem;
}
</style>

______________________________________________________________________________________________________________________________
______________________________________________________________________________________________________________________________


src\latest\model\branch\parts\pos\PosModal.vue


<template>
  <Dialog
    v-model:visible="visible"
    :modal="true"
    :style="dialogStyle"
    :maximizable="false"
    :draggable="false"
    :resizable="false"
    @hide="closeModal"
    class="pos-modal"
    :class="{ 'maximized-dialog': isMaximized }"
  >
    <!-- Simple header -->
    <template #header>
      <span class="text-xl font-bold text-white dark:text-gray-100">{{
        $t("pos.title")
      }}</span>
    </template>

    <!-- POS Toolbar -->
    <div
      class="pos-toolbar flex justify-content-between align-items-center mb-3 p-3 surface-ground border-round"
      :class="{ 'dark-surface': isDarkMode }"
    >
      <div class="flex align-items-center gap-2">
        <Button
          :label="$t('pos.holdInvoice')"
          icon="pi pi-pause"
          @click="holdCurrentInvoice"
          class="p-button-warning"
          :class="{ 'dark-button-warning': isDarkMode }"
          :disabled="cartItems.length === 0"
        />
        <Button
          :label="$t('pos.viewHeld')"
          icon="pi pi-list"
          @click="showHeldInvoices"
          class="p-button-secondary"
          :class="{ 'dark-button-secondary': isDarkMode }"
        />
        <Button
          :label="$t('pos.switchLayout')"
          :icon="layoutIcon"
          @click="toggleLayout"
          class="p-button-help"
          :class="{ 'dark-button-help': isDarkMode }"
        />
      </div>

      <div class="flex align-items-center gap-2">
        <span class="font-bold text-color dark:text-gray-300">
          {{ $t("pos.invoiceNumber") }}: {{ invoiceNumber }}
        </span>

        <!-- Maximize/Minimize Button -->
        <Button
          :icon="
            isMaximized ? 'pi pi-window-minimize' : 'pi pi-window-maximize'
          "
          @click="toggleMaximize"
          class="p-button-rounded custom-maximize-btn"
          :class="{ 'dark-button': isDarkMode }"
          v-tooltip.top="isMaximized ? $t('pos.minimize') : $t('pos.maximize')"
        />

        <!-- Close Button -->
        <Button
          icon="pi pi-times"
          @click="closeModal"
          class="p-button-rounded custom-close-btn"
          :class="{ 'dark-close-btn': isDarkMode }"
          v-tooltip.top="$t('common.close')"
        />
      </div>
    </div>

    <!-- Main Content -->
    <div :class="['pos-main-content', layoutClass]">
      <!-- Products Panel -->
      <PosProductsPanel
        ref="productsPanel"
        :company-id="companyId"
        :branch-id="branchId"
        :selected-category="selectedCategory"
        :search-query="searchQuery"
        @add-to-cart="addToCart"
        @category-change="selectedCategory = $event"
        @search="searchQuery = $event"
        :class="[
          layoutClass.includes('horizontal')
            ? 'products-panel-horizontal'
            : 'products-panel-vertical',
          { 'dark-panel': isDarkMode },
        ]"
      />

      <!-- Cart Panel -->
      <PosCartPanel
        ref="cartPanel"
        :cart-items="cartItems"
        :selected-customer="selectedCustomer"
        :selected-warehouse="selectedWarehouse?.id"
        :selected-payment-method="selectedPaymentMethod?.id"
        :invoice-discounts="invoiceDiscounts"
        :invoice-additional-costs="invoiceAdditionalCosts"
        :tax-rate="taxRate"
        @update-item="updateCartItem"
        @remove-item="removeCartItem"
        @customer-change="selectedCustomer = $event"
        @warehouse-change="onWarehouseChange"
        @payment-method-change="onPaymentMethodChange"
        @add-discount="addInvoiceDiscount"
        @update-discount="onDiscountUpdate"
        @remove-discount="removeInvoiceDiscount"
        @add-additional-cost="addInvoiceAdditionalCost"
        @update-additional-cost="onAdditionalCostUpdate"
        @remove-additional-cost="removeInvoiceAdditionalCost"
        @checkout="processCheckout"
        @clear-cart="clearCart"
        :class="[
          layoutClass.includes('horizontal')
            ? 'cart-panel-horizontal'
            : 'cart-panel-vertical',
          { 'dark-panel': isDarkMode },
        ]"
      />
    </div>

    <!-- Held Invoices Modal -->
    <PosHeldInvoices
      ref="heldInvoicesModal"
      :company-id="companyId"
      :branch-id="branchId"
      @load-invoice="loadHeldInvoice"
    />

    <!-- Receipt Modal -->
    <Dialog
      v-model:visible="showReceipt"
      :header="$t('pos.receipt')"
      :modal="true"
      :style="{ width: '400px' }"
      :class="{ 'dark-dialog': isDarkMode }"
    >
      <PosReceipt
        :invoice="currentInvoice"
        :company-id="companyId"
        :branch-id="branchId"
      />
      <template #footer>
        <Button
          :label="$t('pos.printReceipt')"
          icon="pi pi-print"
          @click="printReceipt"
          class="p-button-primary"
          :class="{ 'dark-button-primary': isDarkMode }"
        />
        <Button
          :label="$t('common.close')"
          @click="showReceipt = false"
          class="p-button-text"
          :class="{ 'dark-button-text': isDarkMode }"
        />
      </template>
    </Dialog>

    <!-- Loading Overlay -->
    <div
      v-if="loading"
      class="loading-overlay"
      :class="{ 'dark-overlay': isDarkMode }"
    >
      <ProgressSpinner />
      <p class="mt-2 text-color dark:text-gray-300">{{ loadingMessage }}</p>
    </div>
  </Dialog>
</template>

<script>
import Dialog from "primevue/dialog";
import Button from "primevue/button";
import ProgressSpinner from "primevue/progressspinner";
import Tooltip from "primevue/tooltip";

import PosProductsPanel from "./PosProductsPanel.vue";
import PosCartPanel from "./PosCartPanel.vue";
import PosHeldInvoices from "./PosHeldInvoices.vue";
import PosReceipt from "./PosReceipt.vue";
import PosService from "./PosService.js";

export default {
  name: "PosModal",
  components: {
    Dialog,
    Button,
    ProgressSpinner,
    PosProductsPanel,
    PosCartPanel,
    PosHeldInvoices,
    PosReceipt,
  },
  directives: {
    tooltip: Tooltip,
  },
  props: {
    companyId: {
      type: String,
      required: true,
    },
    branchId: {
      type: String,
      required: true,
    },
  },
  data() {
    return {
      visible: false,
      isMaximized: false,
      layout: "horizontal",
      isDarkMode: false,

      // Dialog dimensions
      dialogWidth: "95vw",
      dialogHeight: "90vh",
      originalWidth: "95vw",
      originalHeight: "90vh",

      // Cart data
      cartItems: [],
      selectedCustomer: null,
      selectedWarehouse: null,
      selectedPaymentMethod: null,
      invoiceDiscounts: [],
      invoiceAdditionalCosts: [],

      // Products filtering
      selectedCategory: null,
      searchQuery: "",

      // Tax
      taxRate: 14,

      // Invoice
      invoiceNumber: `INV-${Date.now().toString().slice(-6)}`,
      currentInvoice: null,
      showReceipt: false,

      // Loading states
      loading: false,
      loadingMessage: "",

      // Service
      posService: null,
    };
  },
  computed: {
    layoutClass() {
      return this.layout === "horizontal"
        ? "horizontal-layout"
        : "vertical-layout";
    },
    layoutIcon() {
      return this.layout === "horizontal"
        ? "pi pi-arrow-right-arrow-left"
        : "pi pi-arrow-down-arrow-up";
    },
    dialogStyle() {
      if (this.isMaximized) {
        return {
          width: "100vw",
          height: "100vh",
          maxWidth: "100vw",
          maxHeight: "100vh",
          top: "0",
          left: "0",
          margin: "0",
          position: "fixed",
        };
      } else {
        return {
          width: this.dialogWidth,
          height: this.dialogHeight,
          maxWidth: "95vw",
          maxHeight: "90vh",
        };
      }
    },
  },
  created() {
    this.posService = new PosService(this.companyId, this.branchId);
    this.initializeData();
    this.checkDarkMode();
  },
  mounted() {
    this.originalWidth = this.dialogWidth;
    this.originalHeight = this.dialogHeight;

    // Listen for dark mode changes
    window
      .matchMedia("(prefers-color-scheme: dark)")
      .addEventListener("change", this.checkDarkMode);
  },
  beforeDestroy() {
    window
      .matchMedia("(prefers-color-scheme: dark)")
      .removeEventListener("change", this.checkDarkMode);
  },
  methods: {
    checkDarkMode() {
      this.isDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;
    },

    openModal() {
      this.visible = true;
      this.resetCart();
      this.generateInvoiceNumber();
      this.isMaximized = false;
      this.checkDarkMode();
    },

    closeModal() {
      if (this.cartItems.length > 0) {
        if (confirm(this.$t("pos.confirmCloseWithItems"))) {
          this.visible = false;
          this.resetCart();
        }
      } else {
        this.visible = false;
        this.resetCart();
      }
    },

    toggleMaximize() {
      this.isMaximized = !this.isMaximized;

      this.$nextTick(() => {
        window.dispatchEvent(new Event("resize"));
        if (this.$refs.dialog) {
          this.$refs.dialog.$el.style.transform = "none";
        }
      });
    },

    toggleLayout() {
      this.layout = this.layout === "horizontal" ? "vertical" : "horizontal";
      localStorage.setItem("pos_layout_preference", this.layout);
    },

    async initializeData() {
      const savedLayout = localStorage.getItem("pos_layout_preference");
      if (savedLayout) {
        this.layout = savedLayout;
      }
      this.selectedWarehouse = { id: "warehouse1", name: "Main Warehouse" };
    },

    generateInvoiceNumber() {
      const timestamp = Date.now();
      const random = Math.floor(Math.random() * 1000);
      this.invoiceNumber = `INV-${timestamp.toString().slice(-6)}-${random}`;
    },

    // Cart Methods
    addToCart(product) {
      const existingItem = this.cartItems.find(
        (item) => item.id === product.id
      );

      if (existingItem) {
        existingItem.quantity = (existingItem.quantity || 1) + 1;
      } else {
        this.cartItems.push({
          ...product,
          quantity: 1,
          measurement_unit_id:
            product.product?.sales_measurement_unit?.id || null,
          additional_costs: [],
        });
      }

      this.$toast.add({
        severity: "success",
        summary: this.$t("pos.productAdded"),
        detail: `${product.name} ${this.$t("pos.addedToCart")}`,
        life: 2000,
      });
    },

    updateCartItem(itemId, updates) {
      const index = this.cartItems.findIndex((item) => item.id === itemId);
      if (index !== -1) {
        this.cartItems[index] = { ...this.cartItems[index], ...updates };
      }
    },

    removeCartItem(itemId) {
      this.cartItems = this.cartItems.filter((item) => item.id !== itemId);
    },

    clearCart() {
      this.cartItems = [];
      this.invoiceDiscounts = [];
      this.invoiceAdditionalCosts = [];
      this.selectedCustomer = null;
      this.selectedPaymentMethod = null;
    },

    // Invoice Discounts & Additional Costs
    addInvoiceDiscount() {
      this.invoiceDiscounts.push({
        id: `disc_${Date.now()}`,
        name: "",
        value: 0,
      });
    },

    removeInvoiceDiscount(discountId) {
      this.invoiceDiscounts = this.invoiceDiscounts.filter(
        (d) => d.id !== discountId
      );
    },

    addInvoiceAdditionalCost() {
      this.invoiceAdditionalCosts.push({
        id: `cost_${Date.now()}`,
        name: "",
        value: 0,
      });
    },

    removeInvoiceAdditionalCost(costId) {
      this.invoiceAdditionalCosts = this.invoiceAdditionalCosts.filter(
        (c) => c.id !== costId
      );
    },

    // Hold Invoice
    holdCurrentInvoice() {
      if (this.cartItems.length === 0) {
        this.$toast.add({
          severity: "warn",
          summary: this.$t("pos.emptyCart"),
          detail: this.$t("pos.addItemsBeforeHold"),
          life: 3000,
        });
        return;
      }

      const heldInvoice = {
        id: `held_${Date.now()}`,
        cartItems: [...this.cartItems],
        customer: this.selectedCustomer,
        warehouse: this.selectedWarehouse,
        discounts: [...this.invoiceDiscounts],
        additionalCosts: [...this.invoiceAdditionalCosts],
        heldAt: new Date().toISOString(),
        invoiceNumber: this.invoiceNumber,
      };

      this.posService.saveHeldInvoice(heldInvoice);

      this.$toast.add({
        severity: "success",
        summary: this.$t("pos.invoiceHeld"),
        detail: this.$t("pos.invoiceSavedForLater"),
        life: 3000,
      });

      this.clearCart();
      this.generateInvoiceNumber();
    },

    showHeldInvoices() {
      this.$refs.heldInvoicesModal.openModal();
    },

    loadHeldInvoice(invoice) {
      this.cartItems = invoice.cartItems || [];
      this.selectedCustomer = invoice.customer || null;
      this.selectedWarehouse = invoice.warehouse || null;
      this.invoiceDiscounts = invoice.discounts || [];
      this.invoiceAdditionalCosts = invoice.additionalCosts || [];
      this.invoiceNumber = invoice.invoiceNumber || this.invoiceNumber;

      this.$refs.heldInvoicesModal.closeModal();

      this.$toast.add({
        severity: "success",
        summary: this.$t("pos.invoiceLoaded"),
        detail: this.$t("pos.heldInvoiceLoaded"),
        life: 3000,
      });
    },

    // Checkout
    async processCheckout() {
      if (this.cartItems.length === 0) {
        this.$toast.add({
          severity: "error",
          summary: this.$t("pos.emptyCart"),
          detail: this.$t("pos.addItemsBeforeCheckout"),
          life: 3000,
        });
        return;
      }

      if (!this.selectedWarehouse) {
        this.$toast.add({
          severity: "error",
          summary: this.$t("pos.warehouseRequired"),
          detail: this.$t("pos.selectWarehouseFirst"),
          life: 3000,
        });
        return;
      }

      if (!this.selectedPaymentMethod) {
        this.$toast.add({
          severity: "error",
          summary: this.$t("pos.paymentMethodRequired"),
          detail: this.$t("pos.selectPaymentMethodFirst"),
          life: 3000,
        });
        return;
      }

      this.loading = true;
      this.loadingMessage = this.$t("pos.processingPayment");

      try {
        const finalProducts = this.cartItems.map((item) => ({
          final_product_id: item.id,
          measurement_unit_id:
            item.measurement_unit_id ||
            item.product?.sales_measurement_unit?.id,
          quantity: item.quantity || 1,
        }));

        const invoiceData = {
          warehouse_id: this.selectedWarehouse.id,
          contact_id: this.selectedCustomer?.id || null,
          payment_method_id: this.selectedPaymentMethod.id,
          details: this.$t("pos.posSale"),
          final_products: finalProducts,
          additional_costs: this.invoiceAdditionalCosts.map((cost) => ({
            name: cost.name,
            value: parseFloat(cost.value),
          })),
          discounts: this.invoiceDiscounts.map((discount) => ({
            name: discount.name,
            value: parseFloat(discount.value),
          })),
        };

        await new Promise((resolve) => setTimeout(resolve, 1500));

        const totals = this.posService.calculateInvoiceTotals(
          this.cartItems,
          this.invoiceDiscounts,
          this.invoiceAdditionalCosts,
          this.taxRate
        );

        this.currentInvoice = {
          ...invoiceData,
          id: `inv_${Date.now()}`,
          invoice_number: this.invoiceNumber,
          created_at: new Date().toISOString(),
          customer: this.selectedCustomer,
          warehouse: this.selectedWarehouse,
          payment_method: this.selectedPaymentMethod,
          items: this.cartItems,
          totals: totals,
        };

        this.showReceipt = true;
        this.clearCart();
        this.generateInvoiceNumber();

        this.$toast.add({
          severity: "success",
          summary: this.$t("pos.paymentSuccessful"),
          detail: this.$t("pos.invoiceCreatedSuccessfully"),
          life: 3000,
        });
      } catch (error) {
        console.error("Checkout error:", error);
        this.$toast.add({
          severity: "error",
          summary: this.$t("pos.paymentFailed"),
          detail: error.message || this.$t("pos.checkoutError"),
          life: 3000,
        });
      } finally {
        this.loading = false;
      }
    },

    printReceipt() {
      const printContent = document.querySelector(".pos-receipt").innerHTML;
      const printWindow = window.open("", "_blank");
      printWindow.document.write(`
        <html>
          <head>
            <title>${this.$t("pos.receipt")}</title>
            <style>
              body { font-family: Arial, sans-serif; font-size: 12px; background: ${
                this.isDarkMode ? "#1a1a1a" : "#ffffff"
              }; color: ${this.isDarkMode ? "#e0e0e0" : "#000000"}; }
              .receipt-header { text-align: center; margin-bottom: 20px; }
              .receipt-items { width: 100%; border-collapse: collapse; margin: 10px 0; }
              .receipt-items th, .receipt-items td { border: 1px solid ${
                this.isDarkMode ? "#444" : "#ddd"
              }; padding: 5px; }
              .receipt-totals { margin-top: 20px; text-align: right; }
              .receipt-footer { margin-top: 30px; text-align: center; font-size: 10px; }
              @media print {
                body { margin: 0; padding: 10px; }
                .no-print { display: none; }
              }
            </style>
          </head>
          <body>
            ${printContent}
            <div class="no-print" style="margin-top: 20px; text-align: center;">
              <button onclick="window.print()" style="padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer;">
                ${this.$t("pos.print")}
              </button>
              <button onclick="window.close()" style="padding: 10px 20px; background: #dc3545; color: white; border: none; cursor: pointer; margin-left: 10px;">
                ${this.$t("common.close")}
              </button>
            </div>
          </body>
        </html>
      `);
      printWindow.document.close();
      printWindow.focus();
    },

    resetCart() {
      this.cartItems = [];
      this.selectedCustomer = null;
      this.selectedPaymentMethod = null;
      this.invoiceDiscounts = [];
      this.invoiceAdditionalCosts = [];
      this.selectedCategory = null;
      this.searchQuery = "";
    },

    onWarehouseChange(warehouse) {
      this.selectedWarehouse = warehouse;
    },

    onPaymentMethodChange(paymentMethod) {
      this.selectedPaymentMethod = paymentMethod;
    },

    onDiscountUpdate(updatedDiscount) {
      const index = this.invoiceDiscounts.findIndex(
        (d) => d.id === updatedDiscount.id
      );
      if (index !== -1) {
        this.invoiceDiscounts = [
          ...this.invoiceDiscounts.slice(0, index),
          updatedDiscount,
          ...this.invoiceDiscounts.slice(index + 1),
        ];
      }
    },

    onAdditionalCostUpdate(updatedCost) {
      const index = this.invoiceAdditionalCosts.findIndex(
        (c) => c.id === updatedCost.id
      );
      if (index !== -1) {
        this.invoiceAdditionalCosts = [
          ...this.invoiceAdditionalCosts.slice(0, index),
          updatedCost,
          ...this.invoiceAdditionalCosts.slice(index + 1),
        ];
      }
    },
  },
};
</script>

<style scoped>
.pos-modal {
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  transition: all 0.3s ease;
}

.pos-modal.maximized-dialog {
  border-radius: 0 !important;
  box-shadow: none !important;
}

/* POS Toolbar - Light Mode */
.pos-toolbar {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border-radius: 8px;
  margin: 0 1rem;
  transition: all 0.3s ease;
}

.pos-toolbar.dark-surface {
  background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
  color: #e2e8f0;
  border: 1px solid #4a5568;
}

/* Horizontal Layout */
.horizontal-layout {
  display: flex;
  height: calc(100% - 80px);
  gap: 1rem;
  margin: 0 1rem;
}

/* Vertical Layout */
.vertical-layout {
  display: flex;
  flex-direction: column;
  height: calc(100% - 80px);
  gap: 1rem;
  margin: 0 1rem;
}

/* Products Panel */
.products-panel-horizontal {
  flex: 3;
  min-width: 0;
}

.products-panel-horizontal.dark-panel {
  background: #1a202c !important;
}

.cart-panel-horizontal {
  flex: 2;
  min-width: 400px;
  max-width: 500px;
}

.cart-panel-horizontal.dark-panel {
  background: #1a202c !important;
}

.products-panel-vertical {
  flex: 2;
  min-height: 300px;
}

.products-panel-vertical.dark-panel {
  background: #1a202c !important;
}

.cart-panel-vertical {
  flex: 3;
  min-height: 400px;
}

.cart-panel-vertical.dark-panel {
  background: #1a202c !important;
}

/* Loading Overlay */
.loading-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255, 255, 255, 0.9);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 1000;
}

.loading-overlay.dark-overlay {
  background: rgba(26, 32, 44, 0.95);
}

.loading-overlay.dark-overlay .p-progress-spinner-circle {
  stroke: #667eea !important;
}

/* Custom button styles for visibility */
.custom-maximize-btn,
.custom-close-btn {
  width: 40px !important;
  height: 40px !important;
  color: #ffffff !important;
  background: rgba(255, 255, 255, 0.2) !important;
  border: 1px solid rgba(255, 255, 255, 0.4) !important;
  border-radius: 50% !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  transition: all 0.2s ease !important;
}

.custom-maximize-btn:hover,
.custom-close-btn:hover {
  background: rgba(255, 255, 255, 0.3) !important;
  transform: scale(1.1) !important;
}

.custom-maximize-btn:active,
.custom-close-btn:active {
  transform: scale(0.95) !important;
}

/* Dark mode button styles */
.custom-maximize-btn.dark-button,
.custom-close-btn.dark-close-btn {
  background: rgba(255, 255, 255, 0.1) !important;
  border: 1px solid rgba(255, 255, 255, 0.2) !important;
  color: #e2e8f0 !important;
}

.custom-maximize-btn.dark-button:hover,
.custom-close-btn.dark-close-btn:hover {
  background: rgba(255, 255, 255, 0.2) !important;
}

.custom-close-btn.dark-close-btn {
  color: #fc8181 !important;
}

/* Dialog header styling */
:deep(.p-dialog-header) {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
  padding: 1rem !important;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  transition: all 0.3s ease;
}

/* Dark mode dialog header */
:deep(.dark-dialog .p-dialog-header) {
  background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%) !important;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

/* Hide default header icons */
:deep(.p-dialog .p-dialog-header-icons) {
  display: none !important;
}

/* Dialog content area */
:deep(.p-dialog-content) {
  padding: 0 !important;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  height: 100%;
  transition: background-color 0.3s ease;
}

/* Dark mode dialog content */
:deep(.dark-dialog .p-dialog-content) {
  background-color: #1a202c !important;
  color: #e2e8f0 !important;
}

/* Ensure proper spacing */
:deep(.p-dialog .p-dialog-content) {
  flex: 1;
  overflow: auto;
  padding-top: 0.5rem !important;
}

/* Maximized dialog styles */
:deep(.maximized-dialog .p-dialog) {
  width: 100vw !important;
  height: 100vh !important;
  max-width: 100vw !important;
  max-height: 100vh !important;
  top: 0 !important;
  left: 0 !important;
  transform: none !important;
  border-radius: 0 !important;
  margin: 0 !important;
}

:deep(.maximized-dialog .p-dialog-content) {
  height: calc(100vh - 60px) !important;
}

/* Fix for dialog positioning */
:deep(.p-dialog) {
  transition: all 0.3s ease !important;
}

/* Dark mode button overrides */
:deep(.dark-button-warning) {
  background-color: #d69e2e !important;
  border-color: #d69e2e !important;
  color: white !important;
}

:deep(.dark-button-warning:hover) {
  background-color: #b7791f !important;
  border-color: #b7791f !important;
}

:deep(.dark-button-secondary) {
  background-color: #718096 !important;
  border-color: #718096 !important;
  color: white !important;
}

:deep(.dark-button-secondary:hover) {
  background-color: #4a5568 !important;
  border-color: #4a5568 !important;
}

:deep(.dark-button-help) {
  background-color: #805ad5 !important;
  border-color: #805ad5 !important;
  color: white !important;
}

:deep(.dark-button-help:hover) {
  background-color: #6b46c1 !important;
  border-color: #6b46c1 !important;
}

:deep(.dark-button-primary) {
  background-color: #4299e1 !important;
  border-color: #4299e1 !important;
  color: white !important;
}

:deep(.dark-button-primary:hover) {
  background-color: #3182ce !important;
  border-color: #3182ce !important;
}

:deep(.dark-button-text) {
  color: #e2e8f0 !important;
}

:deep(.dark-button-text:hover) {
  background-color: rgba(255, 255, 255, 0.1) !important;
}
</style>


____________________________________________________________________________________________________________________________________________
____________________________________________________________________________________________________________________________________________


src\latest\model\branch\parts\pos\PosHeldInvoices.vue

<template>
  <Dialog
    :header="$t('pos.heldInvoices')"
    v-model:visible="visible"
    :modal="true"
    :style="{ width: '700px' }"
  >
    <!-- Held Invoices List -->
    <div v-if="heldInvoices.length > 0" class="held-invoices-list">
      <DataTable
        :value="heldInvoices"
        :paginator="true"
        :rows="10"
        class="p-datatable-sm table-scroll-container"
      >
        <Column field="invoiceNumber" :header="$t('pos.invoiceNumber')">
          <template #body="slotProps">
            <span class="font-mono">{{ slotProps.data.invoiceNumber }}</span>
          </template>
        </Column>

        <Column :header="$t('pos.customer')">
          <template #body="slotProps">
            <div>
              <div class="font-bold">
                {{ slotProps.data.customer?.name || $t("pos.walkInCustomer") }}
              </div>
              <div
                v-if="slotProps.data.customer?.phone"
                class="text-sm text-color-secondary"
              >
                {{ slotProps.data.customer.phone }}
              </div>
            </div>
          </template>
        </Column>

        <Column :header="$t('pos.items')">
          <template #body="slotProps">
            <div class="text-sm">
              {{ slotProps.data.cartItems?.length || 0 }} {{ $t("pos.items") }}
            </div>
          </template>
        </Column>

        <Column :header="$t('pos.total')">
          <template #body="slotProps">
            <div class="font-bold">
              {{ calculateInvoiceTotal(slotProps.data) }}
            </div>
          </template>
        </Column>

        <Column :header="$t('pos.heldAt')">
          <template #body="slotProps">
            <div class="text-sm">
              {{ formatDate(slotProps.data.heldAt) }}
            </div>
          </template>
        </Column>

        <Column :header="$t('pos.actions')" style="width: 150px">
          <template #body="slotProps">
            <div class="flex gap-1">
              <Button
                icon="pi pi-play"
                @click="loadInvoice(slotProps.data)"
                class="p-button-success p-button-sm"
                v-tooltip.top="$t('pos.loadInvoice')"
              />
              <Button
                icon="pi pi-trash"
                @click="deleteInvoice(slotProps.data.id)"
                class="p-button-danger p-button-sm"
                v-tooltip.top="$t('pos.deleteInvoice')"
              />
            </div>
          </template>
        </Column>
      </DataTable>
    </div>

    <!-- Empty State -->
    <div v-else class="empty-state text-center py-6">
      <i class="pi pi-inbox text-6xl text-color-secondary mb-3"></i>
      <h3 class="text-color-secondary">{{ $t("pos.noHeldInvoices") }}</h3>
      <p class="text-color-secondary">
        {{ $t("pos.holdInvoicesWillAppearHere") }}
      </p>
    </div>

    <template #footer>
      <Button
        :label="$t('common.close')"
        @click="closeModal"
        class="p-button-text"
      />
    </template>
  </Dialog>
</template>

<script>
import Dialog from "primevue/dialog";
import DataTable from "primevue/datatable";
import Column from "primevue/column";
import Button from "primevue/button";
import Tooltip from "primevue/tooltip";

import PosService from "./PosService.js";

export default {
  name: "PosHeldInvoices",
  components: {
    Dialog,
    DataTable,
    Column,
    Button,
  },
  directives: {
    tooltip: Tooltip,
  },
  props: {
    companyId: {
      type: String,
      required: true,
    },
    branchId: {
      type: String,
      required: true,
    },
  },
  data() {
    return {
      visible: false,
      heldInvoices: [],
      posService: null,
    };
  },
  created() {
    this.posService = new PosService(this.companyId, this.branchId);
  },
  methods: {
    openModal() {
      this.visible = true;
      this.loadHeldInvoices();
    },

    closeModal() {
      this.visible = false;
    },

    loadHeldInvoices() {
      this.heldInvoices = this.posService.getHeldInvoices();
    },

    loadInvoice(invoice) {
      this.$emit("load-invoice", invoice);
      this.closeModal();
    },

    deleteInvoice(invoiceId) {
      if (confirm(this.$t("pos.confirmDeleteInvoice"))) {
        this.posService.deleteHeldInvoice(invoiceId);
        this.loadHeldInvoices();

        this.$toast.add({
          severity: "success",
          summary: this.$t("pos.invoiceDeleted"),
          detail: this.$t("pos.heldInvoiceDeleted"),
          life: 3000,
        });
      }
    },

    calculateInvoiceTotal(invoice) {
      // Calculate total from cart items
      let total = 0;
      if (invoice.cartItems && Array.isArray(invoice.cartItems)) {
        invoice.cartItems.forEach((item) => {
          const price = item.has_discount
            ? item.price_after_discount
            : item.price;
          total += price * (item.quantity || 1);
        });
      }
      return `$${total.toFixed(2)}`;
    },

    formatDate(dateString) {
      if (!dateString) return "";
      const date = new Date(dateString);
      return (
        date.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" }) +
        " " +
        date.toLocaleDateString()
      );
    },
  },
};
</script>

<style scoped>
.held-invoices-list {
  max-height: 500px;
  overflow-y: auto;
}

.empty-state {
  min-height: 300px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

:deep(.p-datatable) {
  font-size: 0.875rem;
}

:deep(.p-datatable .p-button.p-button-sm) {
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
}
</style>


__________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________

src\latest\model\branch\parts\pos\PosCustomerSelector.vue

<template>
  <div class="pos-customer-selector">
    <!-- Customer Search & Select -->
    <div class="customer-search">
      <AutoComplete
        v-model="searchQuery"
        :suggestions="filteredCustomers"
        :placeholder="$t('pos.searchCustomer')"
        field="name"
        :dropdown="true"
        @complete="searchCustomers"
        @item-select="selectCustomer"
        class="w-full mb-2"
      >
        <template #item="slotProps">
          <div class="customer-option">
            <div class="flex align-items-center gap-2">
              <i class="pi pi-user"></i>
              <div>
                <div class="font-bold">{{ slotProps.item.name }}</div>
                <div class="text-sm text-color-secondary">
                  {{ slotProps.item.phone }} • {{ slotProps.item.email }}
                </div>
              </div>
            </div>
          </div>
        </template>
      </AutoComplete>

      <!-- Selected Customer Display -->
      <div
        v-if="selectedCustomer"
        class="selected-customer p-3 surface-100 border-round mb-3"
      >
        <div class="flex justify-content-between align-items-center">
          <div>
            <h5 class="m-0 mb-1">{{ selectedCustomer.name }}</h5>
            <p class="m-0 text-sm text-color-secondary">
              <i class="pi pi-phone mr-1"></i>{{ selectedCustomer.phone }}
              <span v-if="selectedCustomer.email"> • </span>
              <i v-if="selectedCustomer.email" class="pi pi-envelope mr-1"></i
              >{{ selectedCustomer.email }}
            </p>
            <p
              v-if="selectedCustomer.address"
              class="m-0 text-sm text-color-secondary mt-1"
            >
              <i class="pi pi-map-marker mr-1"></i
              >{{ selectedCustomer.address }}
            </p>
          </div>
          <Button
            icon="pi pi-times"
            @click="clearCustomer"
            class="p-button-text p-button-danger"
          />
        </div>
      </div>

      <!-- Quick Create Customer -->
      <div v-if="!selectedCustomer" class="quick-create mt-2">
        <Button
          :label="$t('pos.createNewCustomer')"
          icon="pi pi-user-plus"
          @click="showCreateModal = true"
          class="p-button-outlined p-button-sm w-full"
        />
      </div>
    </div>

    <!-- Create Customer Modal -->
    <Dialog
      v-model:visible="showCreateModal"
      :header="$t('pos.createNewCustomer')"
      :modal="true"
      :style="{ width: '500px' }"
    >
      <div class="create-customer-form">
        <div class="grid">
          <div class="col-12 field">
            <label class="block font-bold mb-2"
              >{{ $t("pos.customerName") }} *</label
            >
            <InputText
              v-model="newCustomer.name"
              :placeholder="$t('pos.enterCustomerName')"
              class="w-full"
              :class="{ 'p-invalid': errors.name }"
            />
            <small v-if="errors.name" class="p-error">{{ errors.name }}</small>
          </div>

          <div class="col-12 md:col-6 field">
            <label class="block font-bold mb-2">{{ $t("pos.phone") }} *</label>
            <InputText
              v-model="newCustomer.phone"
              :placeholder="$t('pos.enterPhone')"
              class="w-full"
              :class="{ 'p-invalid': errors.phone }"
            />
            <small v-if="errors.phone" class="p-error">{{
              errors.phone
            }}</small>
          </div>

          <div class="col-12 md:col-6 field">
            <label class="block font-bold mb-2">{{ $t("pos.email") }}</label>
            <InputText
              v-model="newCustomer.email"
              :placeholder="$t('pos.enterEmail')"
              type="email"
              class="w-full"
              :class="{ 'p-invalid': errors.email }"
            />
            <small v-if="errors.email" class="p-error">{{
              errors.email
            }}</small>
          </div>

          <div class="col-12 field">
            <label class="block font-bold mb-2">{{ $t("pos.address") }}</label>
            <Textarea
              v-model="newCustomer.address"
              :placeholder="$t('pos.enterAddress')"
              rows="2"
              class="w-full"
            />
          </div>
        </div>
      </div>

      <template #footer>
        <Button
          :label="$t('common.cancel')"
          @click="showCreateModal = false"
          class="p-button-text"
        />
        <Button
          :label="$t('common.create')"
          @click="createCustomer"
          class="p-button-primary"
          :loading="creatingCustomer"
        />
      </template>
    </Dialog>
  </div>
</template>

<script>
import AutoComplete from "primevue/autocomplete";
import InputText from "primevue/inputtext";
import Textarea from "primevue/textarea";
import Button from "primevue/button";
import Dialog from "primevue/dialog";

export default {
  name: "PosCustomerSelector",
  components: {
    AutoComplete,
    InputText,
    Textarea,
    Button,
    Dialog,
  },
  props: {
    companyId: {
      type: String,
      required: true,
    },
    selectedCustomer: {
      type: Object,
      default: null,
    },
  },
  data() {
    return {
      searchQuery: "",
      filteredCustomers: [],
      customers: [],

      // Create Customer
      showCreateModal: false,
      newCustomer: {
        name: "",
        phone: "",
        email: "",
        address: "",
      },
      errors: {},
      creatingCustomer: false,
    };
  },
  created() {
    this.loadCustomers();
  },
  methods: {
    async loadCustomers() {
      try {
        // TODO: Replace with real API
        this.customers = [
          {
            id: "cust1",
            name: "John Doe",
            phone: "0123456789",
            email: "john@example.com",
            address: "123 Main St",
          },
          {
            id: "cust2",
            name: "Jane Smith",
            phone: "0987654321",
            email: "jane@example.com",
            address: "456 Oak Ave",
          },
          {
            id: "cust3",
            name: "Bob Johnson",
            phone: "0555555555",
            email: "bob@example.com",
            address: "789 Pine Rd",
          },
        ];
      } catch (error) {
        console.error("Error loading customers:", error);
      }
    },

    searchCustomers(event) {
      const query = event.query.toLowerCase();
      this.filteredCustomers = this.customers.filter(
        (customer) =>
          customer.name.toLowerCase().includes(query) ||
          customer.phone.includes(query) ||
          customer.email?.toLowerCase().includes(query)
      );
    },

    selectCustomer(event) {
      this.$emit("select-customer", event.value);
      this.searchQuery = "";
    },

    clearCustomer() {
      this.$emit("select-customer", null);
    },

    validateCustomer() {
      this.errors = {};

      if (!this.newCustomer.name.trim()) {
        this.errors.name = this.$t("pos.customerNameRequired");
      }

      if (!this.newCustomer.phone.trim()) {
        this.errors.phone = this.$t("pos.phoneRequired");
      }

      if (
        this.newCustomer.email &&
        !this.isValidEmail(this.newCustomer.email)
      ) {
        this.errors.email = this.$t("pos.invalidEmail");
      }

      return Object.keys(this.errors).length === 0;
    },

    isValidEmail(email) {
      const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return re.test(email);
    },

    async createCustomer() {
      if (!this.validateCustomer()) {
        return;
      }

      this.creatingCustomer = true;

      try {
        // Emit the new customer data to parent
        this.$emit("create-customer", { ...this.newCustomer });

        // Close modal and reset form
        this.showCreateModal = false;
        this.resetNewCustomerForm();

        this.$toast.add({
          severity: "success",
          summary: this.$t("pos.customerCreated"),
          detail: this.$t("pos.newCustomerAddedSuccessfully"),
          life: 3000,
        });
      } catch (error) {
        console.error("Error creating customer:", error);
        this.$toast.add({
          severity: "error",
          summary: this.$t("pos.createError"),
          detail: error.message || this.$t("pos.failedToCreateCustomer"),
          life: 3000,
        });
      } finally {
        this.creatingCustomer = false;
      }
    },

    resetNewCustomerForm() {
      this.newCustomer = {
        name: "",
        phone: "",
        email: "",
        address: "",
      };
      this.errors = {};
    },
  },
};
</script>

<style scoped>
.pos-customer-selector {
  width: 100%;
}

.customer-option {
  padding: 0.5rem;
  border-bottom: 1px solid #dee2e6;
}

.customer-option:last-child {
  border-bottom: none;
}

.customer-option:hover {
  background: #f8f9fa;
}

.selected-customer {
  background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
  border: 1px solid #bbdefb;
}

.create-customer-form .field {
  margin-bottom: 1rem;
}

:deep(.p-autocomplete) {
  width: 100%;
}

:deep(.p-autocomplete-input) {
  width: 100%;
}
</style>

________________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________

src\latest\model\branch\parts\pos\PosCartPanel.vue

<template>
  <div class="pos-cart-panel">
    <!-- Cart Header -->
    <div class="cart-header mb-3 p-3 surface-100 border-round">
      <div class="flex justify-content-between align-items-center">
        <h3 class="m-0">
          <i class="pi pi-shopping-cart mr-2"></i>
          {{ $t("pos.cart") }}
          <Tag :value="cartItems.length" severity="info" class="ml-2" />
        </h3>
        <Button
          :label="$t('pos.clearAll')"
          icon="pi pi-trash"
          @click="clearCart"
          class="p-button-danger p-button-text"
          :disabled="cartItems.length === 0"
        />
      </div>
    </div>

    <!-- Cart Items -->
    <div
      class="cart-items-container"
      :class="{ 'empty-cart': cartItems.length === 0 }"
    >
      <div v-if="cartItems.length > 0" class="cart-items-list">
        <div
          v-for="item in cartItems"
          :key="item.id"
          class="cart-item-wrapper mb-2"
        >
          <PosCartItem
            :item="item"
            @update="(updates) => $emit('update-item', item.id, updates)"
            @remove="$emit('remove-item', item.id)"
          />
        </div>
      </div>

      <!-- Empty Cart -->
      <div v-else class="empty-cart-state text-center py-6">
        <i class="pi pi-shopping-cart text-6xl text-color-secondary mb-3"></i>
        <h4 class="text-color-secondary">{{ $t("pos.cartEmpty") }}</h4>
        <p class="text-color-secondary">{{ $t("pos.addProductsToCart") }}</p>
      </div>
    </div>

    <!-- Customer, Warehouse, Payment Selection -->
    <div class="selection-section mt-3 p-3 surface-50 border-round">
      <h4 class="mt-0 mb-3">{{ $t("pos.invoiceDetails") }}</h4>

      <div class="grid">
        <!-- Customer Selection -->
        <div class="col-12 md:col-6">
          <div class="field mb-3">
            <label class="block font-bold mb-2">
              <i class="pi pi-user mr-1"></i>
              {{ $t("pos.customer") }}
            </label>
            <PosCustomerSelector
              :company-id="companyId"
              :selected-customer="selectedCustomer"
              @select-customer="$emit('customer-change', $event)"
              @create-customer="createNewCustomer"
            />
          </div>
        </div>

        <!-- Warehouse Selection -->
        <div class="col-12 md:col-6">
          <div class="field mb-3">
            <label class="block font-bold mb-2">
              <i class="pi pi-building mr-1"></i>
              {{ $t("pos.warehouse") }} *
            </label>
            <Dropdown
              :model-value="selectedWarehouse"
              :options="warehouses"
              optionLabel="name"
              optionValue="id"
              :placeholder="$t('pos.selectWarehouse')"
              @update:modelValue="onWarehouseChange"
              class="w-full"
              :class="{
                'p-invalid': !selectedWarehouse && cartItems.length > 0,
              }"
              showClear
            />
            <small
              v-if="!selectedWarehouse && cartItems.length > 0"
              class="p-error"
            >
              {{ $t("pos.warehouseRequired") }}
            </small>
          </div>
        </div>

        <!-- Payment Method -->
        <div class="col-12 md:col-6">
          <div class="field mb-3">
            <label class="block font-bold mb-2">
              <i class="pi pi-credit-card mr-1"></i>
              {{ $t("pos.paymentMethod") }} *
            </label>
            <Dropdown
              :model-value="selectedPaymentMethod"
              :options="paymentMethods"
              optionLabel="name"
              optionValue="id"
              :placeholder="$t('pos.selectPaymentMethod')"
              @update:modelValue="onPaymentMethodChange"
              class="w-full"
              :class="{
                'p-invalid': !selectedPaymentMethod && cartItems.length > 0,
              }"
              showClear
            />
            <small
              v-if="!selectedPaymentMethod && cartItems.length > 0"
              class="p-error"
            >
              {{ $t("pos.paymentMethodRequired") }}
            </small>
          </div>
        </div>

        <!-- Invoice Notes -->
        <div class="col-12 md:col-6">
          <div class="field mb-3">
            <label class="block font-bold mb-2">
              <i class="pi pi-comment mr-1"></i>
              {{ $t("pos.notes") }}
            </label>
            <Textarea
              :model-value="invoiceNotes"
              @update:modelValue="onInvoiceNotesChange"
              :placeholder="$t('pos.addNotesHere')"
              rows="2"
              class="w-full"
            />
          </div>
        </div>
      </div>
    </div>

    <!-- Invoice-Level Discounts & Additional Costs -->
    <div class="invoice-adjustments mt-3">
      <!-- Discounts -->
      <div class="mb-3">
        <div class="flex justify-content-between align-items-center mb-2">
          <h4 class="m-0">
            <i class="pi pi-percentage mr-2"></i>
            {{ $t("pos.invoiceDiscounts") }}
          </h4>
          <Button
            :label="$t('pos.addDiscount')"
            icon="pi pi-plus"
            @click="$emit('add-discount')"
            class="p-button-success p-button-sm"
          />
        </div>

        <div v-if="invoiceDiscounts.length > 0" class="adjustments-list">
          <div
            v-for="discount in invoiceDiscounts"
            :key="discount.id"
            class="adjustment-item p-2 mb-2 surface-100 border-round"
          >
            <div class="grid">
              <div class="col-12 md:col-5">
                <InputText
                  :model-value="discount.name"
                  @update:modelValue="
                    (value) => onDiscountUpdate(discount, 'name', value)
                  "
                  :placeholder="$t('pos.discountName')"
                  class="w-full"
                />
              </div>
              <div class="col-12 md:col-5">
                <InputNumber
                  :model-value="discount.value"
                  @update:modelValue="
                    (value) => onDiscountUpdate(discount, 'value', value)
                  "
                  :placeholder="$t('pos.discountValue')"
                  mode="currency"
                  currency="USD"
                  locale="en-US"
                  class="w-full"
                />
              </div>
              <div class="col-12 md:col-2">
                <Button
                  icon="pi pi-times"
                  @click="$emit('remove-discount', discount.id)"
                  class="p-button-danger p-button-text w-full"
                />
              </div>
            </div>
          </div>
        </div>
        <div v-else class="text-color-secondary p-2">
          {{ $t("pos.noDiscountsAdded") }}
        </div>
      </div>

      <!-- Additional Costs -->
      <div>
        <div class="flex justify-content-between align-items-center mb-2">
          <h4 class="m-0">
            <i class="pi pi-money-bill mr-2"></i>
            {{ $t("pos.additionalCosts") }}
          </h4>
          <Button
            :label="$t('pos.addCost')"
            icon="pi pi-plus"
            @click="$emit('add-additional-cost')"
            class="p-button-warning p-button-sm"
          />
        </div>

        <div v-if="invoiceAdditionalCosts.length > 0" class="adjustments-list">
          <div
            v-for="cost in invoiceAdditionalCosts"
            :key="cost.id"
            class="adjustment-item p-2 mb-2 surface-100 border-round"
          >
            <div class="grid">
              <div class="col-12 md:col-5">
                <InputText
                  :model-value="cost.name"
                  @update:modelValue="
                    (value) => onAdditionalCostUpdate(cost, 'name', value)
                  "
                  :placeholder="$t('pos.costName')"
                  class="w-full"
                />
              </div>
              <div class="col-12 md:col-5">
                <InputNumber
                  :model-value="cost.value"
                  @update:modelValue="
                    (value) => onAdditionalCostUpdate(cost, 'value', value)
                  "
                  :placeholder="$t('pos.costValue')"
                  mode="currency"
                  currency="USD"
                  locale="en-US"
                  class="w-full"
                />
              </div>
              <div class="col-12 md:col-2">
                <Button
                  icon="pi pi-times"
                  @click="$emit('remove-additional-cost', cost.id)"
                  class="p-button-danger p-button-text w-full"
                />
              </div>
            </div>
          </div>
        </div>
        <div v-else class="text-color-secondary p-2">
          {{ $t("pos.noAdditionalCosts") }}
        </div>
      </div>
    </div>

    <!-- Invoice Summary -->
    <div class="invoice-summary mt-3 p-3 surface-100 border-round">
      <h4 class="mt-0 mb-3">{{ $t("pos.summary") }}</h4>

      <div class="summary-details">
        <div class="flex justify-content-between mb-2">
          <span>{{ $t("pos.subtotal") }}:</span>
          <span class="font-bold">{{ formatCurrency(totals.subtotal) }}</span>
        </div>

        <div
          v-if="totals.discountTotal > 0"
          class="flex justify-content-between mb-2 text-red-500"
        >
          <span>{{ $t("pos.discount") }}:</span>
          <span class="font-bold"
            >-{{ formatCurrency(totals.discountTotal) }}</span
          >
        </div>

        <div
          v-if="totals.additionalCostsTotal > 0"
          class="flex justify-content-between mb-2 text-green-500"
        >
          <span>{{ $t("pos.additionalCosts") }}:</span>
          <span class="font-bold"
            >+{{ formatCurrency(totals.additionalCostsTotal) }}</span
          >
        </div>

        <div class="flex justify-content-between mb-2">
          <span>{{ $t("pos.taxableAmount") }}:</span>
          <span class="font-bold">{{
            formatCurrency(totals.taxableAmount)
          }}</span>
        </div>

        <div class="flex justify-content-between mb-2">
          <span>{{ $t("pos.tax") }} ({{ taxRate }}%):</span>
          <span class="font-bold">{{ formatCurrency(totals.taxAmount) }}</span>
        </div>

        <Divider />

        <div class="flex justify-content-between mb-2 text-2xl font-bold">
          <span>{{ $t("pos.total") }}:</span>
          <span class="text-primary">{{
            formatCurrency(totals.grandTotal)
          }}</span>
        </div>
      </div>

      <!-- Checkout Button -->
      <Button
        :label="checkoutButtonLabel"
        icon="pi pi-check"
        @click="$emit('checkout')"
        class="p-button-success w-full mt-3"
        :disabled="!canCheckout"
        :loading="processingCheckout"
      >
        <template #loading>
          <ProgressSpinner style="width: 20px; height: 20px" />
          <span class="ml-2">{{ $t("pos.processing") }}</span>
        </template>
      </Button>

      <small class="block text-center text-color-secondary mt-2">
        {{ $t("pos.checkoutHint") }}
      </small>
    </div>
  </div>
</template>

<script>
import Dropdown from "primevue/dropdown";
import Button from "primevue/button";
import Tag from "primevue/tag";
import Textarea from "primevue/textarea";
import InputText from "primevue/inputtext";
import InputNumber from "primevue/inputnumber";
import Divider from "primevue/divider";
import ProgressSpinner from "primevue/progressspinner";

import PosCartItem from "./PosCartItem.vue";
import PosCustomerSelector from "./PosCustomerSelector.vue";
import PosService from "./PosService.js";

export default {
  name: "PosCartPanel",
  components: {
    Dropdown,
    Button,
    Tag,
    Textarea,
    InputText,
    InputNumber,
    Divider,
    ProgressSpinner,
    PosCartItem,
    PosCustomerSelector,
  },
  props: {
    cartItems: {
      type: Array,
      default: () => [],
    },
    selectedCustomer: {
      type: Object,
      default: null,
    },
    selectedWarehouse: {
      type: String,
      default: null,
    },
    selectedPaymentMethod: {
      type: String,
      default: null,
    },
    invoiceDiscounts: {
      type: Array,
      default: () => [],
    },
    invoiceAdditionalCosts: {
      type: Array,
      default: () => [],
    },
    taxRate: {
      type: Number,
      default: 14,
    },
    companyId: {
      type: String,
      required: true,
    },
    branchId: {
      type: String,
      required: true,
    },
  },
  data() {
    return {
      // Data
      warehouses: [],
      paymentMethods: [],

      // UI State
      invoiceNotes: "",
      processingCheckout: false,

      // Service
      posService: null,
    };
  },
  computed: {
    selectedWarehouseObj() {
      return (
        this.warehouses.find((w) => w.id === this.selectedWarehouse) || null
      );
    },

    selectedPaymentMethodObj() {
      return (
        this.paymentMethods.find((p) => p.id === this.selectedPaymentMethod) ||
        null
      );
    },

    totals() {
      return this.posService.calculateInvoiceTotals(
        this.cartItems,
        this.invoiceDiscounts,
        this.invoiceAdditionalCosts,
        this.taxRate
      );
    },

    canCheckout() {
      return (
        this.cartItems.length > 0 &&
        this.selectedWarehouse &&
        this.selectedPaymentMethod
      );
    },

    checkoutButtonLabel() {
      if (this.cartItems.length === 0) return this.$t("pos.emptyCart");
      if (!this.selectedWarehouse) return this.$t("pos.selectWarehouse");
      if (!this.selectedPaymentMethod)
        return this.$t("pos.selectPaymentMethod");
      return `${this.$t("pos.checkout")} - ${this.formatCurrency(
        this.totals.grandTotal
      )}`;
    },
  },
  created() {
    this.posService = new PosService(this.companyId, this.branchId);
    this.loadSelectionData();
  },
  methods: {
    async loadSelectionData() {
      try {
        // Load warehouses
        // TODO: Replace with real API
        this.warehouses = [
          {
            id: "warehouse1",
            name: "Main Warehouse",
            name_ar: "المخزن الرئيسي",
          },
          { id: "warehouse2", name: "Branch Warehouse", name_ar: "مخزن الفرع" },
        ];

        // Load payment methods
        // TODO: Replace with real API
        this.paymentMethods = this.posService.getDummyPaymentMethods();
      } catch (error) {
        console.error("Error loading selection data:", error);
        this.$toast.add({
          severity: "error",
          summary: this.$t("pos.loadError"),
          detail: this.$t("pos.failedToLoadData"),
          life: 3000,
        });
      }
    },

    // Event handlers for prop updates
    onWarehouseChange(value) {
      const warehouseId = value;
      const warehouse =
        this.warehouses.find((w) => w.id === warehouseId) || null;
      this.$emit("warehouse-change", warehouse);
    },

    onPaymentMethodChange(value) {
      const methodId = value;
      const method = this.paymentMethods.find((p) => p.id === methodId) || null;
      this.$emit("payment-method-change", method);
    },

    onInvoiceNotesChange(value) {
      this.invoiceNotes = value;
      // If you need to emit this to parent
      // this.$emit('invoice-notes-change', this.invoiceNotes);
    },

    onDiscountUpdate(discount, field, value) {
      const updatedDiscount = { ...discount, [field]: value };
      this.$emit("update-discount", updatedDiscount);
    },

    onAdditionalCostUpdate(cost, field, value) {
      const updatedCost = { ...cost, [field]: value };
      this.$emit("update-additional-cost", updatedCost);
    },

    clearCart() {
      this.$emit("clear-cart");
    },

    async createNewCustomer(customerData) {
      try {
        // TODO: Replace with real API
        // const newCustomer = await this.posService.createContact(customerData);

        // For now, create dummy customer
        const newCustomer = {
          id: `cust_${Date.now()}`,
          ...customerData,
        };

        this.$emit("customer-change", newCustomer);

        this.$toast.add({
          severity: "success",
          summary: this.$t("pos.customerCreated"),
          detail: this.$t("pos.newCustomerAdded"),
          life: 3000,
        });
      } catch (error) {
        console.error("Error creating customer:", error);
        this.$toast.add({
          severity: "error",
          summary: this.$t("pos.createError"),
          detail: error.message || this.$t("pos.failedToCreateCustomer"),
          life: 3000,
        });
      }
    },

    formatCurrency(amount) {
      return `$${parseFloat(amount).toFixed(2)}`;
    },
  },
};
</script>

<style scoped>
.pos-cart-panel {
  height: 100%;
  display: flex;
  flex-direction: column;
}

.cart-header {
  background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
  color: white;
}

.cart-items-container {
  flex: 1;
  overflow-y: auto;
  min-height: 1030px;
  border: 1px solid #dee2e6;
  border-radius: 6px;
  padding: 10px;
}

.cart-items-container.empty-cart {
  display: flex;
  align-items: center;
  justify-content: center;
}

.cart-items-list {
  max-height: 1000px;
  overflow-y: auto;
}

.empty-cart-state {
  width: 100%;
}

.selection-section {
  background: #f8f9fa;
}

.invoice-adjustments .adjustment-item {
  border-left: 4px solid #007bff;
  background: white;
}

.invoice-adjustments .adjustment-item:nth-child(odd) {
  border-left-color: #28a745;
}

.invoice-summary {
  background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
  border: 2px solid #007bff;
}

.summary-details {
  background: white;
  padding: 15px;
  border-radius: 6px;
  border: 1px solid #dee2e6;
}

:deep(.p-dropdown) {
  width: 100%;
}

:deep(.p-inputnumber) {
  width: 100%;
}

:deep(.p-button) {
  font-weight: 600;
}

:deep(.p-divider) {
  margin: 1rem 0;
}

/* Scrollbar styling */
.cart-items-container::-webkit-scrollbar,
.cart-items-list::-webkit-scrollbar {
  width: 15px;
}

.cart-items-container::-webkit-scrollbar-track,
.cart-items-list::-webkit-scrollbar-track {
  background: #f1f1f1;
}

.cart-items-container::-webkit-scrollbar-thumb,
.cart-items-list::-webkit-scrollbar-thumb {
  background: #888;
  border-radius: 3px;
}

.cart-items-container::-webkit-scrollbar-thumb:hover,
.cart-items-list::-webkit-scrollbar-thumb:hover {
  background: #555;
}
</style>

________________________________________________________________________________________________________________________________
________________________________________________________________________________________________________________________________

src\latest\model\branch\parts\pos\PosCartItem.vue


<template>
  <div
    class="pos-cart-item p-3"
    :class="{ 'light-item': !isDarkMode, 'dark-item': isDarkMode }"
  >
    <!-- Item Header -->
    <div class="flex justify-content-between align-items-start mb-2">
      <div class="flex align-items-start gap-2" style="flex: 1">
        <!-- Product Image -->
        <div class="item-image">
          <img
            v-if="item.main_image?.file?.file_path"
            :src="item.main_image.file.file_path"
            :alt="item.name"
            class="border-round"
          />
          <div v-else class="no-image" :class="{ 'dark-no-image': isDarkMode }">
            <i class="pi pi-image"></i>
          </div>
        </div>

        <!-- Product Info -->
        <div style="flex: 1">
          <h4 class="m-0 mb-1" :class="{ 'dark-text': isDarkMode }">
            {{ item.name }}
          </h4>
          <p
            class="text-sm m-0 mb-1"
            :class="{
              'text-color-secondary': !isDarkMode,
              'dark-text-secondary': isDarkMode,
            }"
          >
            {{ item.name_ar }}
          </p>

          <!-- Price Display -->
          <div class="flex align-items-center gap-2 mb-1">
            <span
              v-if="item.has_discount"
              class="original-price text-line-through"
              :class="{
                'text-color-secondary': !isDarkMode,
                'dark-text-secondary': isDarkMode,
              }"
            >
              {{ formatCurrency(item.price) }}
            </span>
            <span
              class="current-price font-bold"
              :class="{ 'dark-price': isDarkMode }"
            >
              {{
                formatCurrency(
                  item.has_discount ? item.price_after_discount : item.price
                )
              }}
            </span>
            <Tag
              v-if="item.has_discount"
              :value="`-${item.discount_value}%`"
              severity="danger"
              size="small"
            />
          </div>

          <!-- Measurement Unit -->
          <div v-if="measurementUnits.length > 0" class="mb-1">
            <Dropdown
              v-model="selectedMeasurementUnit"
              :options="measurementUnits"
              optionLabel="name"
              optionValue="id"
              placeholder="Select Unit"
              class="w-10rem"
              size="small"
              :class="{ 'dark-dropdown': isDarkMode }"
              @change="updateMeasurementUnit"
            />
          </div>
        </div>
      </div>

      <!-- Remove Button -->
      <Button
        icon="pi pi-times"
        @click="$emit('remove')"
        class="p-button-danger p-button-text p-button-sm"
        :class="{ 'dark-remove-btn': isDarkMode }"
        v-tooltip.top="$t('pos.removeItem')"
      />
    </div>

    <!-- Quantity Controls -->
    <div class="flex justify-content-between align-items-center mb-2">
      <div class="flex align-items-center gap-2">
        <span
          class="font-bold"
          :class="{ 'dark-text': isDarkMode, 'light-text': !isDarkMode }"
          >{{ $t("pos.quantity") }}:</span
        >
        <div
          class="quantity-controls flex align-items-center gap-1"
          :class="{ 'dark-quantity-controls': isDarkMode }"
        >
          <Button
            icon="pi pi-minus"
            @click="decreaseQuantity"
            class="p-button-rounded p-button-text p-button-sm"
            :class="{ 'dark-quantity-btn': isDarkMode }"
            :disabled="item.quantity <= 1"
          />
          <InputNumber
            v-model="item.quantity"
            :min="1"
            :max="item.stock || 999"
            showButtons
            buttonLayout="horizontal"
            incrementButtonIcon="pi pi-plus"
            decrementButtonIcon="pi pi-minus"
            @input="updateQuantity"
            class="quantity-input"
            :class="{ 'dark-input': isDarkMode }"
          />
          <Button
            icon="pi pi-plus"
            @click="increaseQuantity"
            class="p-button-rounded p-button-text p-button-sm"
            :class="{ 'dark-quantity-btn': isDarkMode }"
          />
        </div>
      </div>
      <!-- Item Total -->
      <div
        class="item-total font-bold text-lg"
        :class="{ 'dark-total': isDarkMode }"
      >
        {{ formatCurrency(itemTotal) }}
      </div>
    </div>

    <!-- Stock Info -->
    <div v-if="item.stock !== undefined" class="stock-info mb-2">
      <Tag
        :value="`${$t('pos.stock')}: ${item.stock}`"
        :severity="getStockSeverity(item.stock)"
        size="small"
      />
      <small
        v-if="item.quantity > item.stock"
        class="ml-2"
        :class="{ 'p-error': !isDarkMode, 'dark-error': isDarkMode }"
      >
        {{ $t("pos.insufficientStock") }}
      </small>
    </div>

    <!-- Item-Level Additional Costs -->
    <div class="item-additional-costs">
      <div class="flex justify-content-between align-items-center mb-2">
        <h5 class="m-0" :class="{ 'dark-text': isDarkMode }">
          <i class="pi pi-wrench mr-1" :class="{ 'dark-icon': isDarkMode }"></i>
          {{ $t("pos.itemOperations") }}
        </h5>
        <Button
          :label="$t('pos.addOperation')"
          icon="pi pi-plus"
          @click="addAdditionalCost"
          class="p-button-warning p-button-sm"
          :class="{ 'dark-warning-btn': isDarkMode }"
          size="small"
        />
      </div>

      <div
        v-if="item.additional_costs && item.additional_costs.length > 0"
        class="costs-list"
      >
        <div
          v-for="(cost, index) in item.additional_costs"
          :key="cost.id || index"
          class="cost-item p-2 mb-2 border-round"
          :class="{
            'light-cost-item': !isDarkMode,
            'dark-cost-item': isDarkMode,
          }"
        >
          <div class="grid">
            <div class="col-12 md:col-4">
              <InputText
                v-model="cost.name"
                :placeholder="$t('pos.operationName')"
                class="w-full"
                size="small"
                :class="{ 'dark-input': isDarkMode }"
                @input="updateAdditionalCost(cost)"
              />
            </div>
            <div class="col-12 md:col-4">
              <InputNumber
                v-model="cost.value"
                :placeholder="$t('pos.costValue')"
                mode="currency"
                currency="USD"
                locale="en-US"
                class="w-full"
                size="small"
                :class="{ 'dark-input': isDarkMode }"
                @input="updateAdditionalCost(cost)"
              />
            </div>
            <div class="col-12 md:col-2">
              <Button
                icon="pi pi-paperclip"
                @click="uploadOperationImage(cost)"
                class="p-button-text p-button-sm"
                size="small"
                :class="{ 'dark-icon-btn': isDarkMode }"
                v-tooltip.top="$t('pos.uploadImage')"
              />
            </div>
            <div class="col-12 md:col-2">
              <Button
                icon="pi pi-times"
                @click="removeAdditionalCost(index)"
                class="p-button-danger p-button-text p-button-sm"
                size="small"
                :class="{ 'dark-remove-btn': isDarkMode }"
              />
            </div>

            <!-- Description -->
            <div class="col-12 mt-2">
              <Textarea
                v-model="cost.description"
                :placeholder="$t('pos.operationDescription')"
                rows="2"
                class="w-full"
                size="small"
                :class="{ 'dark-textarea': isDarkMode }"
                @input="updateAdditionalCost(cost)"
              />
            </div>

            <!-- Image Preview -->
            <div v-if="cost.image" class="col-12 mt-2">
              <div class="image-preview">
                <img :src="cost.image" :alt="cost.name" class="border-round" />
                <Button
                  icon="pi pi-times"
                  @click="removeOperationImage(cost)"
                  class="p-button-danger p-button-text p-button-sm remove-image-btn"
                  size="small"
                  :class="{ 'dark-remove-btn': isDarkMode }"
                />
              </div>
            </div>
          </div>
        </div>
      </div>

      <div
        v-else
        class="text-sm p-2"
        :class="{
          'text-color-secondary': !isDarkMode,
          'dark-text-secondary': isDarkMode,
        }"
      >
        {{ $t("pos.noOperationsAdded") }}
      </div>
    </div>

    <!-- Item Notes -->
    <div class="item-notes mt-2">
      <Textarea
        v-model="item.notes"
        :placeholder="$t('pos.itemNotesPlaceholder')"
        rows="1"
        class="w-full"
        size="small"
        :class="{ 'dark-textarea': isDarkMode }"
        @input="updateItemNotes"
      />
    </div>
  </div>
</template>

<script>
import Button from "primevue/button";
import Tag from "primevue/tag";
import InputNumber from "primevue/inputnumber";
import InputText from "primevue/inputtext";
import Textarea from "primevue/textarea";
import Dropdown from "primevue/dropdown";
import Tooltip from "primevue/tooltip";

export default {
  name: "PosCartItem",
  directives: {
    tooltip: Tooltip,
  },
  props: {
    item: {
      type: Object,
      required: true,
    },
    isDarkMode: {
      type: Boolean,
      default: false,
    },
  },
  data() {
    return {
      measurementUnits: [],
      selectedMeasurementUnit: this.item.measurement_unit_id || null,
    };
  },
  computed: {
    itemTotal() {
      const price = this.item.has_discount
        ? this.item.price_after_discount
        : this.item.price;
      let total = price * (this.item.quantity || 1);

      // Add item-level additional costs
      if (
        this.item.additional_costs &&
        Array.isArray(this.item.additional_costs)
      ) {
        this.item.additional_costs.forEach((cost) => {
          total += parseFloat(cost.value) || 0;
        });
      }

      return parseFloat(total.toFixed(2));
    },
  },
  created() {
    this.loadMeasurementUnits();
    // Initialize additional_costs array if not exists
    if (!this.item.additional_costs) {
      this.$set(this.item, "additional_costs", []);
    }
  },
  methods: {
    formatCurrency(amount) {
      return `$${parseFloat(amount).toFixed(2)}`;
    },

    getStockSeverity(stock) {
      if (!stock || stock <= 0) return "danger";
      if (stock <= 10) return "warning";
      return "success";
    },

    async loadMeasurementUnits() {
      // TODO: Load measurement units from API
      this.measurementUnits = [
        { id: "unit1", name: "Piece" },
        { id: "unit2", name: "Kg" },
        { id: "unit3", name: "Liter" },
      ];
    },

    updateMeasurementUnit() {
      this.$emit("update", {
        measurement_unit_id: this.selectedMeasurementUnit,
      });
    },

    updateQuantity() {
      this.$emit("update", { quantity: this.item.quantity });
    },

    updateItemNotes() {
      this.$emit("update", { notes: this.item.notes });
    },

    increaseQuantity() {
      const newQuantity = (this.item.quantity || 1) + 1;
      this.$emit("update", { quantity: newQuantity });
    },

    decreaseQuantity() {
      if (this.item.quantity > 1) {
        const newQuantity = this.item.quantity - 1;
        this.$emit("update", { quantity: newQuantity });
      }
    },

    addAdditionalCost() {
      if (!this.item.additional_costs) {
        this.$set(this.item, "additional_costs", []);
      }

      this.item.additional_costs.push({
        id: `op_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
        name: "",
        value: 0,
        description: "",
        image: null,
      });

      this.$emit("update", { additional_costs: this.item.additional_costs });
    },

    updateAdditionalCost(cost) {
      this.$emit("update", { additional_costs: this.item.additional_costs });
    },

    removeAdditionalCost(index) {
      this.item.additional_costs.splice(index, 1);
      this.$emit("update", { additional_costs: this.item.additional_costs });
    },

    uploadOperationImage(cost) {
      // Create a file input element
      const input = document.createElement("input");
      input.type = "file";
      input.accept = "image/*";

      input.onchange = (e) => {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (event) => {
            cost.image = event.target.result;
            this.updateAdditionalCost(cost);
          };
          reader.readAsDataURL(file);
        }
      };

      input.click();
    },

    removeOperationImage(cost) {
      cost.image = null;
      this.updateAdditionalCost(cost);
    },
  },
};
</script>

<style scoped>
/* Base styles */
.pos-cart-item {
  border: 1px solid #dee2e6;
  border-radius: 8px;
  transition: all 0.3s ease;
}

.pos-cart-item:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

/* Light Mode */
.light-item {
  background: white;
  border-color: #dee2e6;
}

.light-item:hover {
  border-color: #007bff;
}

.light-cost-item {
  border-left: 3px solid #ffc107;
  background: #fff8e1;
}

.light-cost-item:nth-child(even) {
  border-left-color: #fd7e14;
  background: #fff3e0;
}

/* Dark Mode */
.dark-item {
  background: #2d3748;
  border-color: #4a5568;
}

.dark-item:hover {
  border-color: #667eea;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.dark-cost-item {
  border-left: 3px solid #d69e2e;
  background: #4a5568;
}

.dark-cost-item:nth-child(even) {
  border-left-color: #ed8936;
  background: #2d3748;
}

/* Image */
.item-image {
  width: 60px;
  height: 60px;
  flex-shrink: 0;
}

.item-image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.no-image {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px dashed #dee2e6;
  border-radius: 6px;
}

.light-item .no-image {
  background: #f8f9fa;
  color: #6c757d;
}

.dark-item .no-image {
  background: #4a5568;
  color: #a0aec0;
}

/* Text Colors */
.dark-text {
  color: #e2e8f0 !important;
}

.dark-text-secondary {
  color: #a0aec0 !important;
}

.dark-price {
  color: #68d391 !important;
}

.dark-total {
  color: #667eea !important;
}

/* Original Price */
.original-price {
  font-size: 0.85rem;
}

.light-item .original-price {
  color: #6c757d;
}

.dark-item .original-price {
  color: #a0aec0;
}

/* Current Price */
.current-price {
  font-size: 1rem;
}

.light-item .current-price {
  color: #28a745;
}

.dark-item .current-price {
  color: #68d391;
}

/* Quantity Controls */
.quantity-controls {
  padding: 4px;
  border-radius: 6px;
}

.light-item .quantity-controls {
  background: #f8f9fa;
}

.dark-item .quantity-controls {
  background: #4a5568;
}

.quantity-input {
  width: 70px !important;
}

:deep(.quantity-input .p-inputnumber-input) {
  text-align: center;
  font-weight: bold;
}

/* Input Fields */
:deep(.dark-input .p-inputtext) {
  background-color: #2d3748 !important;
  border-color: #4a5568 !important;
  color: #e2e8f0 !important;
}

:deep(.dark-input .p-inputtext:focus) {
  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2) !important;
}

:deep(.dark-input .p-inputnumber-button) {
  background-color: #4a5568 !important;
  border-color: #4a5568 !important;
  color: #e2e8f0 !important;
}

/* Dropdown */
:deep(.dark-dropdown .p-dropdown) {
  background-color: #2d3748 !important;
  border-color: #4a5568 !important;
  color: #e2e8f0 !important;
}

:deep(.dark-dropdown .p-dropdown-panel) {
  background-color: #2d3748 !important;
  border-color: #4a5568 !important;
}

:deep(.dark-dropdown .p-dropdown-item) {
  color: #e2e8f0 !important;
}

:deep(.dark-dropdown .p-dropdown-item:hover) {
  background-color: #4a5568 !important;
}

/* Textarea */
:deep(.dark-textarea .p-inputtextarea) {
  background-color: #2d3748 !important;
  border-color: #4a5568 !important;
  color: #e2e8f0 !important;
}

:deep(.dark-textarea .p-inputtextarea:focus) {
  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2) !important;
}

/* Buttons */
:deep(.dark-quantity-btn.p-button) {
  background-color: #4a5568 !important;
  border-color: #4a5568 !important;
  color: #e2e8f0 !important;
}

:deep(.dark-quantity-btn.p-button:hover) {
  background-color: #667eea !important;
  border-color: #667eea !important;
}

:deep(.dark-warning-btn.p-button) {
  background-color: #d69e2e !important;
  border-color: #d69e2e !important;
  color: white !important;
}

:deep(.dark-warning-btn.p-button:hover) {
  background-color: #b7791f !important;
  border-color: #b7791f !important;
}

:deep(.dark-remove-btn.p-button) {
  color: #fc8181 !important;
}

:deep(.dark-remove-btn.p-button:hover) {
  background-color: rgba(252, 129, 129, 0.1) !important;
}

:deep(.dark-icon-btn.p-button) {
  color: #a0aec0 !important;
}

:deep(.dark-icon-btn.p-button:hover) {
  background-color: rgba(160, 174, 192, 0.1) !important;
}

.dark-icon {
  color: #a0aec0 !important;
}

/* Item Total */
.item-total {
  min-width: 80px;
  text-align: right;
  margin-top: 65px;
}

.light-item .item-total {
  color: #007bff;
}

.dark-item .item-total {
  color: #667eea;
}

/* Stock Info */
.stock-info {
  display: flex;
  align-items: center;
  gap: 8px;
}

.dark-error {
  color: #fc8181 !important;
}

/* Image Preview */
.image-preview {
  position: relative;
  width: 100px;
  height: 100px;
}

.image-preview img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 4px;
}

.remove-image-btn {
  position: absolute;
  top: -8px;
  right: -8px;
  width: 24px;
  height: 24px;
}

.light-text {
  color: #2d3748 !important; /* Dark gray for light mode */
}

.dark-text {
  color: #e2e8f0 !important; /* Light gray for dark mode */
}

/* Utility Classes */
:deep(.p-button.p-button-sm) {
  padding: 0.25rem 0.5rem;
  font-size: 0.875rem;
}

:deep(.p-inputtext-sm) {
  padding: 0.25rem 0.5rem;
  font-size: 0.875rem;
}

:deep(.p-dropdown-sm .p-dropdown-label) {
  padding: 0.25rem 0.5rem;
  font-size: 0.875rem;
}
</style>










___________________________________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________________________________
___________________________________________________________________________________________________________________________________________________________________






src\i18n\locales\ar\pos.js

// pos.js - Arabic translations
export default {
     // POS Modal
     title: "نقطة البيع",
     openPos: "فتح نقطة البيع",
     holdInvoice: "تعليق الفاتورة",
     viewHeld: "عرض الفواتير المعلقة",
     switchLayout: "تبديل التخطيط",
     invoiceNumber: "رقم الفاتورة #",
     minimize: "تصغير",
     maximize: "تكبير",
     confirmCloseWithItems: "لديك عناصر في العربة. هل تريد إغلاق نقطة البيع؟",
     posSale: "بيع عبر نقطة البيع",

     // Products Panel
     cart: "عربة التسوق",
     searchProducts: "البحث عن المنتجات...",
     allCategories: "جميع الفئات",
     all: "الكل",
     noProductsFound: "لم يتم العثور على منتجات",
     tryDifferentSearch: "جرب بحثًا مختلفًا أو فئة أخرى",
     price: "السعر",
     stock: "المخزون",
     description: "الوصف",
     category: "الفئة",
     variants: "المتغيرات",
     addToCart: "أضف إلى العربة",
     adding: "جارٍ الإضافة...",
     noImage: "لا توجد صورة",
     productAdded: "تمت إضافة المنتج",
     addedToCart: "تمت الإضافة إلى العربة",
     scanBarcode: "مسح الباركود أو إدخال الكود",
     scan: "مسح",
     productNotFound: "المنتج غير موجود",
     noProductWithBarcode: "لم يتم العثور على منتج بهذا الباركود",
     loadingProducts: "جارٍ تحميل المنتجات...",

     // Product Card
     quantity: "الكمية",

     // Cart Panel
     clearAll: "مسح الكل",
     cartEmpty: "العربة فارغة",
     addProductsToCart: "أضف منتجات من اللوحة اليسرى",
     invoiceDetails: "تفاصيل الفاتورة",
     customer: "العميل",
     warehouse: "المخزن",
     warehouseRequired: "المخزن مطلوب",
     selectWarehouse: "اختر المخزن",
     paymentMethod: "طريقة الدفع",
     paymentMethodRequired: "طريقة الدفع مطلوبة",
     selectPaymentMethod: "اختر طريقة الدفع",
     notes: "ملاحظات",
     addNotesHere: "أضف ملاحظات هنا...",
     invoiceDiscounts: "خصومات الفاتورة",
     addDiscount: "إضافة خصم",
     discountName: "اسم الخصم",
     discountValue: "قيمة الخصم",
     noDiscountsAdded: "لم تتم إضافة خصومات",
     additionalCosts: "تكاليف إضافية",
     addCost: "إضافة تكلفة",
     costName: "اسم التكلفة",
     noAdditionalCosts: "لا توجد تكاليف إضافية",
     summary: "الملخص",
     subtotal: "المجموع الفرعي",
     discount: "الخصم",
     taxableAmount: "المبلغ الخاضع للضريبة",
     tax: "الضريبة",
     total: "الإجمالي",
     checkout: "إنهاء الشراء",
     processing: "جارٍ المعالجة...",
     checkoutHint: "المخزن وطريقة الدفع مطلوبان",
     emptyCart: "العربة فارغة",
     selectWarehouse: "اختر المخزن",
     selectPaymentMethod: "اختر طريقة الدفع",

     // Cart Item
     removeItem: "إزالة العنصر",
     itemOperations: "عمليات العنصر",
     addOperation: "إضافة عملية",
     operationName: "اسم العملية",
     operationDescription: "وصف العملية",
     costValue: "قيمة التكلفة",
     uploadImage: "رفع صورة",
     noOperationsAdded: "لم تتم إضافة عمليات",
     itemNotesPlaceholder: "أضف ملاحظات للعنصر...",
     insufficientStock: "المخزون غير كافي",

     // Customer Selector
     searchCustomer: "ابحث عن العميل بالاسم، الهاتف، أو البريد الإلكتروني",
     createNewCustomer: "إنشاء عميل جديد",
     customerName: "اسم العميل",
     enterCustomerName: "أدخل اسم العميل",
     enterPhone: "أدخل رقم الهاتف",
     enterEmail: "أدخل البريد الإلكتروني",
     enterAddress: "أدخل العنوان",
     customerNameRequired: "اسم العميل مطلوب",
     phoneRequired: "رقم الهاتف مطلوب",
     invalidEmail: "بريد إلكتروني غير صالح",
     customerCreated: "تم إنشاء العميل",
     newCustomerAdded: "تمت إضافة عميل جديد",
     newCustomerAddedSuccessfully: "تمت إضافة عميل جديد بنجاح",
     walkInCustomer: "عميل وافد",

     // Held Invoices
     heldInvoices: "الفواتير المعلقة",
     items: "عناصر",
     heldAt: "تم التعليق في",
     loadInvoice: "تحميل الفاتورة",
     deleteInvoice: "حذف الفاتورة",
     confirmDeleteInvoice: "هل أنت متأكد من حذف هذه الفاتورة المعلقة؟",
     invoiceDeleted: "تم حذف الفاتورة",
     heldInvoiceDeleted: "تم حذف الفاتورة المعلقة",
     noHeldInvoices: "لا توجد فواتير معلقة",
     holdInvoicesWillAppearHere: "ستظهر الفواتير المعلقة هنا",
     invoiceHeld: "تم تعليق الفاتورة",
     invoiceSavedForLater: "تم حفظ الفاتورة لوقت لاحق",
     invoiceLoaded: "تم تحميل الفاتورة",
     heldInvoiceLoaded: "تم تحميل الفاتورة المعلقة",

     // Receipt
     receipt: "إيصال",
     printReceipt: "طباعة الإيصال",
     print: "طباعة",
     date: "التاريخ",
     cashier: "أمين الصندوق",
     email: "البريد الإلكتروني",
     address: "العنوان",
     adjustments: "التعديلات",
     payment: "الدفع",
     cash: "نقداً",
     thankYouMessage: "شكراً لتعاملك معنا!",
     returnPolicy: "يتم قبول المرتجعات خلال 30 يوم مع الإيصال",
     receiptFooter: "هذا إيصال تم إنشاؤه بواسطة الكمبيوتر",

     // Errors and Messages
     loadError: "خطأ في التحميل",
     failedToLoadProducts: "فشل تحميل المنتجات",
     failedToLoadData: "فشل تحميل البيانات",
     createError: "خطأ في الإنشاء",
     failedToCreateCustomer: "فشل إنشاء العميل",
     addItemsBeforeHold: "أضف عناصر إلى العربة قبل التعليق",
     addItemsBeforeCheckout: "أضف عناصر إلى العربة قبل إنهاء الشراء",
     selectWarehouseFirst: "الرجاء اختيار المخزن أولاً",
     selectPaymentMethodFirst: "الرجاء اختيار طريقة الدفع أولاً",
     processingPayment: "جارٍ معالجة الدفع...",
     paymentSuccessful: "تم الدفع بنجاح",
     invoiceCreatedSuccessfully: "تم إنشاء الفاتورة بنجاح",
     paymentFailed: "فشل الدفع",
     checkoutError: "خطأ أثناء إنهاء الشراء",

     // Additional POS-specific terms
     quickSale: "بيع سريع",
     sale: "بيع",
     product: "منتج",
     products: "منتجات",
     barcode: "باركود",
     sku: "رمز المخزون",
     unitPrice: "سعر الوحدة",
     totalPrice: "السعر الإجمالي",
     itemTotal: "إجمالي العنصر",
     vat: "ضريبة القيمة المضافة",
     grandTotal: "الإجمالي النهائي",
     change: "الباقي",
     amountPaid: "المبلغ المدفوع",
     balanceDue: "الرصيد المستحق",
     void: "إلغاء",
     refund: "استرداد",
     exchange: "تبديل",
     suspendedSales: "المبيعات المعلقة",
     todaySales: "مبيعات اليوم",
     salesReport: "تقرير المبيعات",
     cashDrawer: "درج النقود",
     openDrawer: "فتح الدرج",
     closeDrawer: "إغلاق الدرج",
     shift: "وردية",
     startShift: "بدء الوردية",
     endShift: "إنهاء الوردية",
     cashInDrawer: "النقود في الدرج",
     expectedCash: "النقود المتوقعة",
     difference: "الفرق",
     zReport: "تقرير Z",
     xReport: "تقرير X",
     reprint: "إعادة طباعة",
     lastReceipt: "آخر إيصال",
     voidReason: "سبب الإلغاء",
     refundReason: "سبب الاسترداد",
     apply: "تطبيق",
     clear: "مسح",
     calculate: "حساب",
     confirm: "تأكيد",
     cancel: "إلغاء",
     save: "حفظ",
     edit: "تعديل",
     delete: "حذف",
     search: "بحث",
     filter: "تصفية",
     sort: "ترتيب",
     refresh: "تحديث",
     export: "تصدير",
     import: "استيراد",
     settings: "إعدادات",
     help: "مساعدة",
     about: "حول",
     logout: "تسجيل الخروج",
     login: "تسجيل الدخول",

     // Payment methods
     cashPayment: "دفع نقدي",
     creditCard: "بطاقة ائتمان",
     debitCard: "بطاقة مدى",
     bankTransfer: "تحويل بنكي",
     check: "شيك",
     mobilePayment: "دفع عبر الهاتف",
     wallet: "محفظة إلكترونية",
     credit: "دين",

     // Invoice status
     completed: "مكتمل",
     pending: "قيد الانتظار",
     cancelled: "ملغي",
     refunded: "تم الاسترداد",
     partiallyPaid: "مدفوع جزئياً",
     fullyPaid: "مدفوع بالكامل",
     overdue: "متأخر",

     // Customer types
     regularCustomer: "عميل دائم",
     newCustomer: "عميل جديد",
     corporateCustomer: "عميل مؤسسي",
     wholesaleCustomer: "عميل جملة",
     retailCustomer: "عميل تجزئة",

     // Discount types
     percentageDiscount: "خصم نسبة مئوية",
     fixedDiscount: "خصم مبلغ ثابت",
     buyXGetY: "اشتر X واحصل على Y",
     seasonalDiscount: "خصم موسمي",
     promotionalDiscount: "خصم ترويجي",
     loyaltyDiscount: "خصم ولاء",

     // Tax types
     vatIncluded: "شامل الضريبة",
     vatExcluded: "غير شامل الضريبة",
     vatZero: "صفر ضريبة",
     vatExempt: "معفى من الضريبة",

     // Measurements
     piece: "قطعة",
     kilogram: "كيلوجرام",
     gram: "جرام",
     liter: "لتر",
     milliliter: "ملليلتر",
     meter: "متر",
     centimeter: "سنتيمتر",
     dozen: "دزينة",
     pack: "علبة",
     box: "صندوق",
     bottle: "زجاجة",
     can: "علبة معدنية",

     // Product status
     inStock: "متوفر",
     outOfStock: "غير متوفر",
     lowStock: "مخزون منخفض",
     preOrder: "طلبية مسبقة",
     discontinued: "متوقف",
     comingSoon: "قريباً",

     // POS actions
     add: "إضافة",
     remove: "إزالة",
     update: "تحديث",
     view: "عرض",
     print: "طباعة",
     email: "بريد إلكتروني",
     sms: "رسالة نصية",
     hold: "تعليق",
     resume: "استئناف",
     split: "تقسيم",
     merge: "دمج",
     transfer: "تحويل",
     return: "إرجاع",
     exchange: "تبديل",
     giftReceipt: "إيصال هدية",
     noReceipt: "بدون إيصال",
     actions: "اجراءات",

     // Reports
     dailyReport: "تقرير يومي",
     weeklyReport: "تقرير أسبوعي",
     monthlyReport: "تقرير شهري",
     yearlyReport: "تقرير سنوي",
     salesSummary: "ملخص المبيعات",
     topProducts: "أفضل المنتجات",
     topCategories: "أفضل الفئات",
     topCustomers: "أفضل العملاء",
     salesByHour: "المبيعات حسب الساعة",
     salesByDay: "المبيعات حسب اليوم",
     salesByMonth: "المبيعات حسب الشهر",
     averageSale: "متوسط البيع",
     totalTransactions: "إجمالي المعاملات",
     totalRevenue: "إجمالي الإيرادات",
     totalProfit: "إجمالي الربح",
     totalDiscount: "إجمالي الخصم",
     totalTax: "إجمالي الضريبة",

     // Settings
     posSettings: "إعدادات نقطة البيع",
     receiptSettings: "إعدادات الإيصال",
     printerSettings: "إعدادات الطابعة",
     taxSettings: "إعدادات الضريبة",
     discountSettings: "إعدادات الخصم",
     paymentSettings: "إعدادات الدفع",
     securitySettings: "إعدادات الأمان",
     backupSettings: "إعدادات النسخ الاحتياطي",

     // Shortcuts
     f1: "F1",
     f2: "F2",
     f3: "F3",
     f4: "F4",
     f5: "F5",
     f6: "F6",
     f7: "F7",
     f8: "F8",
     f9: "F9",
     f10: "F10",
     f11: "F11",
     f12: "F12",
     esc: "خروج",
     enter: "إدخال",
     tab: "تبويب",
     shift: "Shift",
     ctrl: "Ctrl",
     alt: "Alt",
     space: "مسافة",

     // Messages
     success: "نجاح",
     error: "خطأ",
     warning: "تحذير",
     info: "معلومات",
     confirmation: "تأكيد",
     areYouSure: "هل أنت متأكد؟",
     yes: "نعم",
     no: "لا",
     ok: "موافق",
     close: "إغلاق",
     back: "رجوع",
     next: "التالي",
     previous: "السابق",
     finish: "إنهاء",
     submit: "إرسال",
     reset: "إعادة تعيين",
     loading: "جارٍ التحميل...",
     saving: "جارٍ الحفظ...",
     processing: "جارٍ المعالجة...",
     pleaseWait: "الرجاء الانتظار...",
     operationSuccessful: "تمت العملية بنجاح",
     operationFailed: "فشلت العملية",
     connectionError: "خطأ في الاتصال",
     serverError: "خطأ في الخادم",
     networkError: "خطأ في الشبكة",
     timeoutError: "خطأ في المهلة",
     validationError: "خطأ في التحقق",
     authenticationError: "خطأ في المصادقة",
     authorizationError: "خطأ في التصريح",
     notFound: "غير موجود",
     unauthorized: "غير مصرح",
     forbidden: "ممنوع",
     badRequest: "طلب غير صالح",
     internalServerError: "خطأ داخلي في الخادم"
};







___________________________________________________________________________________________________________
___________________________________________________________________________________________________________
___________________________________________________________________________________________________________
___________________________________________________________________________________________________________


src\latest\model\branch\parts\pos\PosCartItem.vue
src\latest\model\branch\parts\pos\PosCartPanel.vue
src\latest\model\branch\parts\pos\PosCustomerSelector.vue
src\latest\model\branch\parts\pos\PosHeldInvoices.vue
src\latest\model\branch\parts\pos\PosModal.vue
src\latest\model\branch\parts\pos\PosProductCard.vue
src\latest\model\branch\parts\pos\PosProductsPanel.vue
src\latest\model\branch\parts\pos\PosReceipt.vue


src\latest\model\branch\parts\pos\PosService.js



____________________________________________________________________________________________________________________
____________________________________________________________________________________________________________________
____________________________________________________________________________________________________________________
End Points
____________________________________________________________________________________________________________________
____________________________________________________________________________________________________________________
URL=>{{base_url}}/admin/company/product/final-product/{{final_product_id}}
METHOD=> GET
BODY=>
RESPONSE=>{
    "status_code": 200,
    "message": "company.company_product_retrieved_successfully",
    "data": {
        "id": "9f8c7be5-7219-4129-9136-03540d9ba228",
        "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
        "name": "Chips",
        "name_ar": "شيبسي",
        "has_discount": true,
        "related_discount": {
            "id": "a0762b08-70a2-4d53-8ffa-8c3a2be98029",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "لاسم *",
            "name_ar": "الاسم بالعربية *",
            "details": "التفاصيل",
            "details_ar": "التفاصيل (عربي)",
            "date_from": "2025-11-28",
            "date_to": "2025-12-20",
            "type": {
                "id": "4d803c85-4945-411c-bdb5-a1a05544250b",
                "type": "DiscountTypes",
                "code": 1,
                "key": "1",
                "prefix": "PERCENTAGE",
                "name": "Percentage",
                "name_ar": "نسبة مئوية"
            },
            "value": "30.00",
            "created_at": "2025-11-28T01:38:05.000000Z"
        },
        "discount_value": "30.00",
        "price_after_discount": "7.00",
        "price": 10,
        "details": "Chips",
        "details_ar": "شيبسي",
        "created_at": "2025-08-03T21:40:28.000000Z",
        "category": {
            "id": "9f4a2cbf-1319-4b91-99e5-f7c0fa758039",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "new category",
            "name_ar": "قسم جديد",
            "created_at": "2025-07-01T22:34:31.000000Z",
            "file": {
                "id": "9f4a2d73-2f19-4498-b653-0f0228ca436c",
                "file_path": "https://www.ngcis.com/ERP/public/uploads/VltKwT6Dj6__3aa3aa99693911.5efff38f3eb00.jpg",
                "original_name": "3aa3aa99693911.5efff38f3eb00.jpg",
                "new_name": "VltKwT6Dj6__3aa3aa99693911.5efff38f3eb00.jpg"
            }
        },
        "product": {
            "id": "9f8c5e71-388f-40cd-96b1-654edb5bec86",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "category_id": "9f4a2cbf-1319-4b91-99e5-f7c0fa758039",
            "category": {
                "id": "9f4a2cbf-1319-4b91-99e5-f7c0fa758039",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "name": "new category",
                "name_ar": "قسم جديد",
                "created_at": "2025-07-01T22:34:31.000000Z",
                "file": {
                    "id": "9f4a2d73-2f19-4498-b653-0f0228ca436c",
                    "file_path": "https://www.ngcis.com/ERP/public/uploads/VltKwT6Dj6__3aa3aa99693911.5efff38f3eb00.jpg",
                    "original_name": "3aa3aa99693911.5efff38f3eb00.jpg",
                    "new_name": "VltKwT6Dj6__3aa3aa99693911.5efff38f3eb00.jpg"
                }
            },
            "name": "Chips",
            "name_ar": "شيبسي",
            "details": "Chips",
            "details_ar": "شيبسي",
            "purchases_measurement_unit": {
                "id": "9f49efb5-c3be-48a6-ab22-3628d43ace2f",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "name": "meter",
                "created_at": "2025-07-01T19:43:51.000000Z"
            },
            "sales_measurement_unit": {
                "id": "9f49f394-0459-46a1-a82b-b9ffe85dc579",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "name": "centimeter",
                "created_at": "2025-07-01T19:54:39.000000Z"
            },
            "created_at": "2025-08-03T20:18:08.000000Z"
        },
        "final_product_variant_values": [],
        "main_image": {
            "id": "a0723280-8d49-4326-b003-511406958477",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "final_product_id": "9f8c7be5-7219-4129-9136-03540d9ba228",
            "is_main": true,
            "file": {
                "id": "a06ea20a-0575-452c-982d-67da63fdf03a",
                "file_path": "https://www.ngcis.com/ERP/public/uploads/c1IcYDZD8B__t-shirt.jpg",
                "original_name": "t-shirt.jpg",
                "new_name": "c1IcYDZD8B__t-shirt.jpg"
            }
        },
        "final_product_images": [
            {
                "id": "9f8c7cb3-ea24-4e5a-b41f-795da2fb13d5",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "final_product_id": "9f8c7be5-7219-4129-9136-03540d9ba228",
                "is_main": false,
                "file": {
                    "id": "9f8c7cb3-e496-43cd-9824-5373d9646bd3",
                    "file_path": "https://www.ngcis.com/ERP/public/uploads/q7h9KdWA0s__lays-potato.png",
                    "original_name": "lays-potato.png",
                    "new_name": "q7h9KdWA0s__lays-potato.png"
                }
            },
            {
                "id": "a0723280-8cd0-4798-b688-6ffa2ab432c8",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "final_product_id": "9f8c7be5-7219-4129-9136-03540d9ba228",
                "is_main": false,
                "file": {
                    "id": "a06ea20a-0575-452c-982d-67da63fdf03a",
                    "file_path": "https://www.ngcis.com/ERP/public/uploads/c1IcYDZD8B__t-shirt.jpg",
                    "original_name": "t-shirt.jpg",
                    "new_name": "c1IcYDZD8B__t-shirt.jpg"
                }
            },
            {
                "id": "a0723280-8d49-4326-b003-511406958477",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "final_product_id": "9f8c7be5-7219-4129-9136-03540d9ba228",
                "is_main": true,
                "file": {
                    "id": "a06ea20a-0575-452c-982d-67da63fdf03a",
                    "file_path": "https://www.ngcis.com/ERP/public/uploads/c1IcYDZD8B__t-shirt.jpg",
                    "original_name": "t-shirt.jpg",
                    "new_name": "c1IcYDZD8B__t-shirt.jpg"
                }
            }
        ]
    }
}


____________________________________________________________________________________________________________________
____________________________________________________________________________________________________________________
URL=>{{base_url}}/admin/company/product/company-final-products/search/{{company_id}}?category_id=a06ea488-2d30-4ba9-a987-4485ee0c0154
METHOD=> GET
BODY=>
RESPONSE=>
{
    "data": [
        {
            "id": "a070905a-ba9f-4018-987a-32f2d60d217b",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "category_id": "a06ea488-2d30-4ba9-a987-4485ee0c0154",
            "product_id": "a0701891-c642-414f-b19a-c67c9c949ba9",
            "name": "99",
            "name_ar": "99",
            "has_discount": true,
            "related_discount": {
                "id": "a0762b08-70a2-4d53-8ffa-8c3a2be98029",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "name": "لاسم *",
                "name_ar": "الاسم بالعربية *",
                "details": "التفاصيل",
                "details_ar": "التفاصيل (عربي)",
                "date_from": "2025-11-28",
                "date_to": "2025-12-20",
                "type": {
                    "id": "4d803c85-4945-411c-bdb5-a1a05544250b",
                    "type": "DiscountTypes",
                    "code": 1,
                    "key": "1",
                    "prefix": "PERCENTAGE",
                    "name": "Percentage",
                    "name_ar": "نسبة مئوية"
                },
                "value": "30.00",
                "created_at": "2025-11-28T01:38:05.000000Z"
            },
            "discount_value": "30.00",
            "price_after_discount": "6.30",
            "price": 9,
            "details": "9999",
            "details_ar": "9999",
            "created_at": "2025-11-25T06:46:26.000000Z",
            "final_product_variant_values": [
                {
                    "id": "a0721aee-9d86-48f2-9857-12509393e55a",
                    "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                    "category_id": "a06ea488-2d30-4ba9-a987-4485ee0c0154",
                    "product_id": "a0701891-c642-414f-b19a-c67c9c949ba9",
                    "final_product_id": "a070905a-ba9f-4018-987a-32f2d60d217b",
                    "created_at": "2025-11-26T01:09:45.000000Z",
                    "variant": {
                        "id": "a06ffcd8-b1a8-45f8-a362-33aead954bd5",
                        "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                        "name": "متغير جديد",
                        "name_ar": "متغير جديد",
                        "created_at": "2025-11-24T23:53:58.000000Z"
                    },
                    "variant_value": {
                        "id": "a06ffe3c-9809-4c0f-bc82-85d86cd2214e",
                        "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                        "variant_id": "a06ffcd8-b1a8-45f8-a362-33aead954bd5",
                        "value": "xsxs",
                        "value_ar": "xsxs",
                        "created_at": "2025-11-24T23:57:51.000000Z"
                    }
                },
                {
                    "id": "a07ff1e4-54e2-4b9d-8feb-add7c2626c4c",
                    "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                    "category_id": "a06ea488-2d30-4ba9-a987-4485ee0c0154",
                    "product_id": "a0701891-c642-414f-b19a-c67c9c949ba9",
                    "final_product_id": "a070905a-ba9f-4018-987a-32f2d60d217b",
                    "created_at": "2025-12-02T22:16:35.000000Z",
                    "variant": {
                        "id": "a06ffcd8-b2eb-407c-acea-cda48c0288ba",
                        "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                        "name": "متغير تاني111",
                        "name_ar": "متغير تاني1111",
                        "created_at": "2025-11-24T23:53:58.000000Z"
                    },
                    "variant_value": {
                        "id": "a06ffcd8-b31d-40ae-8e66-de43e0b00fbc",
                        "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                        "variant_id": "a06ffcd8-b2eb-407c-acea-cda48c0288ba",
                        "value": "قيمة المتغير التاني",
                        "value_ar": "قيمة المتغير التاني",
                        "created_at": "2025-11-24T23:53:58.000000Z"
                    }
                }
            ],
            "main_image": {
                "id": "a0723fed-9aa8-40a9-b93c-aa125fde92dc",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "final_product_id": "a070905a-ba9f-4018-987a-32f2d60d217b",
                "is_main": true,
                "file": {
                    "id": "a0723fe9-48e2-4f88-9611-fd15b3451c64",
                    "file_path": "https://www.ngcis.com/ERP/public/uploads/SCVQHV4JSq__Mail.JPG",
                    "original_name": "Mail.JPG",
                    "new_name": "SCVQHV4JSq__Mail.JPG"
                }
            }
        },
        {
            "id": "a0708fad-32b6-4bca-ae70-2e047ca6c048",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "category_id": "a06ea488-2d30-4ba9-a987-4485ee0c0154",
            "product_id": "a0701891-c642-414f-b19a-c67c9c949ba9",
            "name": "hosam zakiلبلبل",
            "name_ar": "سيبلسيبل",
            "has_discount": true,
            "related_discount": {
                "id": "a0762b08-70a2-4d53-8ffa-8c3a2be98029",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "name": "لاسم *",
                "name_ar": "الاسم بالعربية *",
                "details": "التفاصيل",
                "details_ar": "التفاصيل (عربي)",
                "date_from": "2025-11-28",
                "date_to": "2025-12-20",
                "type": {
                    "id": "4d803c85-4945-411c-bdb5-a1a05544250b",
                    "type": "DiscountTypes",
                    "code": 1,
                    "key": "1",
                    "prefix": "PERCENTAGE",
                    "name": "Percentage",
                    "name_ar": "نسبة مئوية"
                },
                "value": "30.00",
                "created_at": "2025-11-28T01:38:05.000000Z"
            },
            "discount_value": "30.00",
            "price_after_discount": "707.00",
            "price": 1010,
            "details": "سيبلسيبل",
            "details_ar": "سيبلسيبل",
            "created_at": "2025-11-25T06:44:32.000000Z",
            "final_product_variant_values": [],
            "main_image": {
                "id": "a072458d-0f9d-47d1-ada5-1282bda7b3fa",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "final_product_id": "a0708fad-32b6-4bca-ae70-2e047ca6c048",
                "is_main": true,
                "file": {
                    "id": "a072458c-6e1b-4cc2-8708-59a46c9e390b",
                    "file_path": "https://www.ngcis.com/ERP/public/uploads/dg0J96gq8w__t-shirt.jpg",
                    "original_name": "t-shirt.jpg",
                    "new_name": "dg0J96gq8w__t-shirt.jpg"
                }
            }
        },
        {
            "id": "a0708d91-74f7-48a3-9a9d-46ae9cf40240",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "category_id": "a06ea488-2d30-4ba9-a987-4485ee0c0154",
            "product_id": "a0701891-c642-414f-b19a-c67c9c949ba9",
            "name": "asd",
            "name_ar": "موقف_2",
            "has_discount": true,
            "related_discount": {
                "id": "a0762b08-70a2-4d53-8ffa-8c3a2be98029",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "name": "لاسم *",
                "name_ar": "الاسم بالعربية *",
                "details": "التفاصيل",
                "details_ar": "التفاصيل (عربي)",
                "date_from": "2025-11-28",
                "date_to": "2025-12-20",
                "type": {
                    "id": "4d803c85-4945-411c-bdb5-a1a05544250b",
                    "type": "DiscountTypes",
                    "code": 1,
                    "key": "1",
                    "prefix": "PERCENTAGE",
                    "name": "Percentage",
                    "name_ar": "نسبة مئوية"
                },
                "value": "30.00",
                "created_at": "2025-11-28T01:38:05.000000Z"
            },
            "discount_value": "30.00",
            "price_after_discount": "7.00",
            "price": 10,
            "details": "ضصث",
            "details_ar": "ضصث",
            "created_at": "2025-11-25T06:38:39.000000Z",
            "final_product_variant_values": [],
            "main_image": {
                "id": "a0725063-1a3c-4a75-9a51-d82c251fca9f",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "final_product_id": "a0708d91-74f7-48a3-9a9d-46ae9cf40240",
                "is_main": true,
                "file": {
                    "id": "a0725062-3bcb-4a12-8375-72e19f3c59a1",
                    "file_path": "https://www.ngcis.com/ERP/public/uploads/Cp9uGgr89q__mail2.JPG",
                    "original_name": "mail2.JPG",
                    "new_name": "Cp9uGgr89q__mail2.JPG"
                }
            }
        },
        {
            "id": "a0708991-c3c4-434e-96a6-b9f11f9f9113",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "category_id": "a06ea488-2d30-4ba9-a987-4485ee0c0154",
            "product_id": "a0701891-c642-414f-b19a-c67c9c949ba9",
            "name": "141414",
            "name_ar": "141414",
            "has_discount": true,
            "related_discount": {
                "id": "a0762b08-70a2-4d53-8ffa-8c3a2be98029",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "name": "لاسم *",
                "name_ar": "الاسم بالعربية *",
                "details": "التفاصيل",
                "details_ar": "التفاصيل (عربي)",
                "date_from": "2025-11-28",
                "date_to": "2025-12-20",
                "type": {
                    "id": "4d803c85-4945-411c-bdb5-a1a05544250b",
                    "type": "DiscountTypes",
                    "code": 1,
                    "key": "1",
                    "prefix": "PERCENTAGE",
                    "name": "Percentage",
                    "name_ar": "نسبة مئوية"
                },
                "value": "30.00",
                "created_at": "2025-11-28T01:38:05.000000Z"
            },
            "discount_value": "30.00",
            "price_after_discount": "707.00",
            "price": 1010,
            "details": null,
            "details_ar": null,
            "created_at": "2025-11-25T06:27:28.000000Z",
            "final_product_variant_values": [],
            "main_image": {
                "id": "a0772798-600c-4b5d-ae17-867ab3b02638",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "final_product_id": "a0708991-c3c4-434e-96a6-b9f11f9f9113",
                "is_main": true,
                "file": {
                    "id": "a0772797-a45e-47db-a614-30c29e703ac9",
                    "file_path": "https://www.ngcis.com/ERP/public/uploads/L9Gt2NtT6G__Rabbit.JPG",
                    "original_name": "Rabbit.JPG",
                    "new_name": "L9Gt2NtT6G__Rabbit.JPG"
                }
            }
        },
        {
            "id": "a0708907-b0d6-4ff6-a7bd-69544c01473a",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "category_id": "a06ea488-2d30-4ba9-a987-4485ee0c0154",
            "product_id": "a0701891-c642-414f-b19a-c67c9c949ba9",
            "name": "product name",
            "name_ar": "product name",
            "has_discount": true,
            "related_discount": {
                "id": "a0762b08-70a2-4d53-8ffa-8c3a2be98029",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "name": "لاسم *",
                "name_ar": "الاسم بالعربية *",
                "details": "التفاصيل",
                "details_ar": "التفاصيل (عربي)",
                "date_from": "2025-11-28",
                "date_to": "2025-12-20",
                "type": {
                    "id": "4d803c85-4945-411c-bdb5-a1a05544250b",
                    "type": "DiscountTypes",
                    "code": 1,
                    "key": "1",
                    "prefix": "PERCENTAGE",
                    "name": "Percentage",
                    "name_ar": "نسبة مئوية"
                },
                "value": "30.00",
                "created_at": "2025-11-28T01:38:05.000000Z"
            },
            "discount_value": "30.00",
            "price_after_discount": "7.00",
            "price": 10,
            "details": null,
            "details_ar": null,
            "created_at": "2025-11-25T06:25:57.000000Z",
            "final_product_variant_values": [],
            "main_image": null
        },
        {
            "id": "a07051c4-f6c0-4072-ba0d-459f5eb66fa9",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "category_id": "a06ea488-2d30-4ba9-a987-4485ee0c0154",
            "product_id": "a0701891-c642-414f-b19a-c67c9c949ba9",
            "name": "nameررر",
            "name_ar": "name arرررر",
            "has_discount": true,
            "related_discount": {
                "id": "a0762b08-70a2-4d53-8ffa-8c3a2be98029",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "name": "لاسم *",
                "name_ar": "الاسم بالعربية *",
                "details": "التفاصيل",
                "details_ar": "التفاصيل (عربي)",
                "date_from": "2025-11-28",
                "date_to": "2025-12-20",
                "type": {
                    "id": "4d803c85-4945-411c-bdb5-a1a05544250b",
                    "type": "DiscountTypes",
                    "code": 1,
                    "key": "1",
                    "prefix": "PERCENTAGE",
                    "name": "Percentage",
                    "name_ar": "نسبة مئوية"
                },
                "value": "30.00",
                "created_at": "2025-11-28T01:38:05.000000Z"
            },
            "discount_value": "30.00",
            "price_after_discount": "7,077.00",
            "price": 10110,
            "details": "details for product222111111111",
            "details_ar": "details for product2211111111112",
            "created_at": "2025-11-25T03:51:26.000000Z",
            "final_product_variant_values": [],
            "main_image": null
        },
        {
            "id": "a0704350-95ca-46ca-911b-66c33bdd6abc",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "category_id": "a06ea488-2d30-4ba9-a987-4485ee0c0154",
            "product_id": "a0701891-c642-414f-b19a-c67c9c949ba9",
            "name": "name",
            "name_ar": "name ar",
            "has_discount": true,
            "related_discount": {
                "id": "a0762b08-70a2-4d53-8ffa-8c3a2be98029",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "name": "لاسم *",
                "name_ar": "الاسم بالعربية *",
                "details": "التفاصيل",
                "details_ar": "التفاصيل (عربي)",
                "date_from": "2025-11-28",
                "date_to": "2025-12-20",
                "type": {
                    "id": "4d803c85-4945-411c-bdb5-a1a05544250b",
                    "type": "DiscountTypes",
                    "code": 1,
                    "key": "1",
                    "prefix": "PERCENTAGE",
                    "name": "Percentage",
                    "name_ar": "نسبة مئوية"
                },
                "value": "30.00",
                "created_at": "2025-11-28T01:38:05.000000Z"
            },
            "discount_value": "30.00",
            "price_after_discount": "70.00",
            "price": 100,
            "details": "details for product222",
            "details_ar": "details for product222",
            "created_at": "2025-11-25T03:11:01.000000Z",
            "final_product_variant_values": [],
            "main_image": null
        },
        {
            "id": "a0703ec6-0910-406f-8722-48ccff6b0e2e",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "category_id": "a06ea488-2d30-4ba9-a987-4485ee0c0154",
            "product_id": "a0701891-c642-414f-b19a-c67c9c949ba9",
            "name": "product name",
            "name_ar": "product name",
            "has_discount": true,
            "related_discount": {
                "id": "a0762b08-70a2-4d53-8ffa-8c3a2be98029",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "name": "لاسم *",
                "name_ar": "الاسم بالعربية *",
                "details": "التفاصيل",
                "details_ar": "التفاصيل (عربي)",
                "date_from": "2025-11-28",
                "date_to": "2025-12-20",
                "type": {
                    "id": "4d803c85-4945-411c-bdb5-a1a05544250b",
                    "type": "DiscountTypes",
                    "code": 1,
                    "key": "1",
                    "prefix": "PERCENTAGE",
                    "name": "Percentage",
                    "name_ar": "نسبة مئوية"
                },
                "value": "30.00",
                "created_at": "2025-11-28T01:38:05.000000Z"
            },
            "discount_value": "30.00",
            "price_after_discount": "10.50",
            "price": 15,
            "details": "details for product222",
            "details_ar": "details for product222",
            "created_at": "2025-11-25T02:58:19.000000Z",
            "final_product_variant_values": [],
            "main_image": null
        },
        {
            "id": "a0703e2b-eb9d-47fa-bc5b-5b60b5d23c6f",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "category_id": "a06ea488-2d30-4ba9-a987-4485ee0c0154",
            "product_id": "a0701891-c642-414f-b19a-c67c9c949ba9",
            "name": "product name",
            "name_ar": "product name",
            "has_discount": true,
            "related_discount": {
                "id": "a0762b08-70a2-4d53-8ffa-8c3a2be98029",
                "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
                "name": "لاسم *",
                "name_ar": "الاسم بالعربية *",
                "details": "التفاصيل",
                "details_ar": "التفاصيل (عربي)",
                "date_from": "2025-11-28",
                "date_to": "2025-12-20",
                "type": {
                    "id": "4d803c85-4945-411c-bdb5-a1a05544250b",
                    "type": "DiscountTypes",
                    "code": 1,
                    "key": "1",
                    "prefix": "PERCENTAGE",
                    "name": "Percentage",
                    "name_ar": "نسبة مئوية"
                },
                "value": "30.00",
                "created_at": "2025-11-28T01:38:05.000000Z"
            },
            "discount_value": "30.00",
            "price_after_discount": "7.00",
            "price": 10,
            "details": "details for product222",
            "details_ar": "details for product222",
            "created_at": "2025-11-25T02:56:38.000000Z",
            "final_product_variant_values": [],
            "main_image": null
        }
    ]
}


____________________________________________________________________________________________________________________
____________________________________________________________________________________________________________________
URL=> {{base_url}}/admin/company/categories/search/{{company_id}}?paginate=true
METHOD=> GET
BODY=>
RESPONSE=>{
    "data": [
        {
            "id": "a0702f85-7427-4fc1-b5a8-cab2fc7f38e4",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "asd",
            "name_ar": "trtrtrtrtrt",
            "created_at": "2025-11-25T02:15:40.000000Z",
            "file": {
                "id": "a0702f83-07ca-42a7-8d78-dda777931ecf",
                "file_path": "https://www.ngcis.com/ERP/public/uploads/vXa8dgWJtA__t-shirt.jpg",
                "original_name": "t-shirt.jpg",
                "new_name": "vXa8dgWJtA__t-shirt.jpg"
            }
        },
        {
            "id": "a06ea488-2d30-4ba9-a987-4485ee0c0154",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "rererere",
            "name_ar": "ssssss",
            "created_at": "2025-11-24T07:51:12.000000Z",
            "file": {
                "id": "a06ea533-8a76-4b06-9a2e-4de5b8089641",
                "file_path": "https://www.ngcis.com/ERP/public/uploads/c0agqp3MoG__Mail.JPG",
                "original_name": "Mail.JPG",
                "new_name": "c0agqp3MoG__Mail.JPG"
            }
        },
        {
            "id": "a06ea2e9-1480-40e0-8256-4b0cf8a38e95",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "ffffffffffff",
            "name_ar": null,
            "created_at": "2025-11-24T07:46:40.000000Z",
            "file": null
        },
        {
            "id": "a06ea23b-9689-458e-88f1-e275ab5ca923",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "sub sub sub category name",
            "name_ar": null,
            "created_at": "2025-11-24T07:44:46.000000Z",
            "file": {
                "id": "a06ea20a-0575-452c-982d-67da63fdf03a",
                "file_path": "https://www.ngcis.com/ERP/public/uploads/c1IcYDZD8B__t-shirt.jpg",
                "original_name": "t-shirt.jpg",
                "new_name": "c1IcYDZD8B__t-shirt.jpg"
            }
        }
    ],
    "links": {
        "first": "https://www.ngcis.com/ERP/public/api/admin/company/categories/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=1",
        "last": "https://www.ngcis.com/ERP/public/api/admin/company/categories/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=2",
        "prev": null,
        "next": "https://www.ngcis.com/ERP/public/api/admin/company/categories/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=2"
    },
    "meta": {
        "current_page": 1,
        "from": 1,
        "last_page": 2,
        "links": [
            {
                "url": null,
                "label": "&laquo; Previous",
                "active": false
            },
            {
                "url": "https://www.ngcis.com/ERP/public/api/admin/company/categories/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=1",
                "label": "1",
                "active": true
            },
            {
                "url": "https://www.ngcis.com/ERP/public/api/admin/company/categories/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=2",
                "label": "2",
                "active": false
            },
            {
                "url": "https://www.ngcis.com/ERP/public/api/admin/company/categories/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=2",
                "label": "Next &raquo;",
                "active": false
            }
        ],
        "path": "https://www.ngcis.com/ERP/public/api/admin/company/categories/search/9f440efe-2b3a-46bb-9319-090027c5a773",
        "per_page": 4,
        "to": 4,
        "total": 8
    }
}

____________________________________________________________________________________________________________________
____________________________________________________________________________________________________________________
URL=> {{base_url}}/admin/company/measurement-units/search/{{company_id}}?paginate=true
METHOD=> GET
BODY=>
RESPONSE=>{
    "data": [
        {
            "id": "a083b19c-fd40-4a23-b52d-e41a12e781d3",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "sfdsfsdfsd",
            "created_at": "2025-12-04T19:00:10.000000Z"
        },
        {
            "id": "a06e7c29-36b4-4046-8f90-4b0b57821ecf",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "measurement unit name",
            "created_at": "2025-11-24T05:58:19.000000Z"
        },
        {
            "id": "9f49f394-0459-46a1-a82b-b9ffe85dc579",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "centimeter",
            "created_at": "2025-07-01T19:54:39.000000Z"
        },
        {
            "id": "9f49efb5-c3be-48a6-ab22-3628d43ace2f",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "meter",
            "created_at": "2025-07-01T19:43:51.000000Z"
        }
    ],
    "links": {
        "first": "https://www.ngcis.com/ERP/public/api/admin/company/measurement-units/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=1",
        "last": "https://www.ngcis.com/ERP/public/api/admin/company/measurement-units/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=1",
        "prev": null,
        "next": null
    },
    "meta": {
        "current_page": 1,
        "from": 1,
        "last_page": 1,
        "links": [
            {
                "url": null,
                "label": "&laquo; Previous",
                "active": false
            },
            {
                "url": "https://www.ngcis.com/ERP/public/api/admin/company/measurement-units/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=1",
                "label": "1",
                "active": true
            },
            {
                "url": null,
                "label": "Next &raquo;",
                "active": false
            }
        ],
        "path": "https://www.ngcis.com/ERP/public/api/admin/company/measurement-units/search/9f440efe-2b3a-46bb-9319-090027c5a773",
        "per_page": 10,
        "to": 4,
        "total": 4
    }
}


____________________________________________________________________________________________________________________
____________________________________________________________________________________________________________________
URL=> {{base_url}}/admin/company/branches/search/{{company_id}}?per_page=&paginate=true
METHOD=> GET
BODY=>
RESPONSE=>{
    "data": [
        {
            "id": "a0725e17-a654-4365-ad95-f79452ab37c9",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "branch name",
            "name_ar": "branch name",
            "phone": "010169887615",
            "address": "address",
            "address_ar": "address",
            "created_at": "2025-11-26T04:17:33.000000Z"
        },
        {
            "id": "9f69c998-8648-4f34-b732-5391fc3c31c4",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "updated branch name",
            "name_ar": "updated branch name",
            "phone": "01016988765",
            "address": "branch address",
            "address_ar": "branch address",
            "created_at": "2025-07-17T15:43:46.000000Z"
        },
        {
            "id": "9f53eed4-d9a9-4235-851b-45f347f64573",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "hosam zaki1",
            "name_ar": "hosam zaki1",
            "phone": "01067188489",
            "address": "almadarees st, almadarees st",
            "address_ar": "العنوان عربي",
            "created_at": "2025-07-06T18:59:40.000000Z"
        },
        {
            "id": "9f4a6536-4745-4774-a0e3-f83f37f869dc",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "new branch",
            "name_ar": "فرع  جديد_",
            "phone": "01010101010",
            "address": "address en",
            "address_ar": "العنوان عربي",
            "created_at": "2025-07-02T01:12:24.000000Z"
        }
    ],
    "links": {
        "first": "https://www.ngcis.com/ERP/public/api/admin/company/branches/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=1",
        "last": "https://www.ngcis.com/ERP/public/api/admin/company/branches/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=1",
        "prev": null,
        "next": null
    },
    "meta": {
        "current_page": 1,
        "from": 1,
        "last_page": 1,
        "links": [
            {
                "url": null,
                "label": "&laquo; Previous",
                "active": false
            },
            {
                "url": "https://www.ngcis.com/ERP/public/api/admin/company/branches/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=1",
                "label": "1",
                "active": true
            },
            {
                "url": null,
                "label": "Next &raquo;",
                "active": false
            }
        ],
        "path": "https://www.ngcis.com/ERP/public/api/admin/company/branches/search/9f440efe-2b3a-46bb-9319-090027c5a773",
        "per_page": 10,
        "to": 4,
        "total": 4
    }
}


____________________________________________________________________________________________________________________
____________________________________________________________________________________________________________________
URL=> {{base_url}}/system-lookups/15   /// payment method
METHOD=> GET
BODY=>
RESPONSE=>{
    "data": [
        {
            "id": "0881c89d-343a-462c-8c09-6abac8d498c0",
            "type": "PaymentMethod",
            "code": 1,
            "key": "1",
            "prefix": "CASH_ON_DELIVERY",
            "name": "Cash On Delivery",
            "name_ar": "الدفع عند الاستلام"
        },
        {
            "id": "41b2f713-ea45-4177-ae57-7070a33d3613",
            "type": "PaymentMethod",
            "code": 2,
            "key": "2",
            "prefix": "BANK_ACCOUNT",
            "name": "Bank Account",
            "name_ar": "حساب البنك"
        }
    ]
}

____________________________________________________________________________________________________________________
____________________________________________________________________________________________________________________
URL=> {{base_url}}/admin/company/contacts/search/{{company_id}}?paginate=true
METHOD=> GET
BODY=>
RESPONSE=>{
    "data": [
        {
            "id": "a07e1c8b-13d3-4921-b62e-d6c7a8c34c98",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "contact name",
            "email": "contdac12t@contact.contact",
            "phone": "0106271812189",
            "address": "addresses123 1",
            "created_at": "2025-12-02T00:24:12.000000Z"
        },
        {
            "id": "a0775305-1e61-44fa-8454-49c4450df72a",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "contact name",
            "email": "asdfsd",
            "phone": "123123123",
            "address": "sdfsdgfdg",
            "created_at": "2025-11-28T15:25:43.000000Z"
        },
        {
            "id": "a07745a2-136a-42c5-93da-fbd63415aaa1",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "ali",
            "email": "hossam_3@gmail.com",
            "phone": "010671884819121",
            "address": "address 1212",
            "created_at": "2025-11-28T14:48:18.000000Z"
        },
        {
            "id": "9f6c38ce-a960-4269-8dc1-0f2c557a1b70",
            "company_id": "9f440efe-2b3a-46bb-9319-090027c5a773",
            "name": "Talaat",
            "email": "hossam_2@gmail.com",
            "phone": "01167188489",
            "address": "address 2",
            "created_at": "2025-07-18T20:46:23.000000Z"
        }
    ],
    "links": {
        "first": "https://www.ngcis.com/ERP/public/api/admin/company/contacts/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=1",
        "last": "https://www.ngcis.com/ERP/public/api/admin/company/contacts/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=1",
        "prev": null,
        "next": null
    },
    "meta": {
        "current_page": 1,
        "from": 1,
        "last_page": 1,
        "links": [
            {
                "url": null,
                "label": "&laquo; Previous",
                "active": false
            },
            {
                "url": "https://www.ngcis.com/ERP/public/api/admin/company/contacts/search/9f440efe-2b3a-46bb-9319-090027c5a773?page=1",
                "label": "1",
                "active": true
            },
            {
                "url": null,
                "label": "Next &raquo;",
                "active": false
            }
        ],
        "path": "https://www.ngcis.com/ERP/public/api/admin/company/contacts/search/9f440efe-2b3a-46bb-9319-090027c5a773",
        "per_page": 10,
        "to": 4,
        "total": 4
    }
}




















____________________________________________________________________________________________________________________
____________________________________________________________________________________________________________________
URL=>
METHOD=> GET
BODY=>
RESPONSE=>

